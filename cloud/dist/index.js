/**
 * JSS cloud
 * https://jspreadsheet.com/cloud
 * @License: this plugin requires a license
 */

if (!jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var _$_7988="https://jspreadsheet.com;_self;comments;POST;DELETE;meta;style;value;config;merge;columns;columns/move;columns/delete;rows;rows/move;rows/delete;create;worksheets;worksheets/rename;worksheets/move;width;height;header;properties;properties/update;footers;footers/value;orderby;nested;nested/update;names;validations;createWorksheet;deleteWorksheet;moveWorksheet;;,;/api/;/;resetStyle;jspreadsheet-token;Authorization;Bearer ;Jspreadsheet;undefined;function;JSS;JSS: socket not loaded;disconnected;Jspreadsheet: jspreadsheet.socket not found;/api/socket.io/;TODO;connect;There is a connection issue that seems to be fixed. Reconnecting to your table...;disconnect;reload;A recovery is ongoing requested by the author. We are going to reload your spreadsheet.;setBorder;resetBorders;/api/socket.io/socket.io.js;script;text/javascript;get;GET;json;Jspreadsheet: This spreadsheet is not public and a valid token was not provided.;object".split(";");
(function(l,e){typeof exports===_$_7988[66]&&typeof module!==_$_7988[44]?module.exports=e():typeof define===_$_7988[45]&&define.amd?define(e):l.cloud=e()})(this,function(){var l=_$_7988[0],e=function(c,h){h={};c.ignoreCloud=!1;var n={setComments:{url:_$_7988[2],method:_$_7988[3]},resetComments:{url:_$_7988[2],method:_$_7988[4]},setMeta:{url:_$_7988[5],method:_$_7988[3]},resetMeta:{url:_$_7988[5],method:_$_7988[4]},setStyle:{url:_$_7988[6],method:_$_7988[3]},resetStyle:{url:_$_7988[6],method:_$_7988[4]},
setValue:{url:_$_7988[7],method:_$_7988[3]},setFormula:{url:_$_7988[7],method:_$_7988[3]},setConfig:{url:_$_7988[8],method:_$_7988[3]},setMerge:{url:_$_7988[9],method:_$_7988[3]},removeMerge:{url:_$_7988[9],method:_$_7988[4]},insertColumn:{url:_$_7988[10],method:_$_7988[3]},moveColumn:{url:_$_7988[11],method:_$_7988[3]},deleteColumn:{url:_$_7988[12],method:_$_7988[3]},insertRow:{url:_$_7988[13],method:_$_7988[3]},moveRow:{url:_$_7988[14],method:_$_7988[3]},deleteRow:{url:_$_7988[15],method:_$_7988[3]},
createWorksheet:{url:_$_7988[16],method:_$_7988[3]},deleteWorksheet:{url:_$_7988[17],method:_$_7988[4]},renameWorksheet:{url:_$_7988[18],method:_$_7988[3]},moveWorksheet:{url:_$_7988[19],method:_$_7988[3]},setWidth:{url:_$_7988[20],method:_$_7988[3]},setHeight:{url:_$_7988[21],method:_$_7988[3]},setHeader:{url:_$_7988[22],method:_$_7988[3]},setProperty:{url:_$_7988[23],method:_$_7988[3]},updateProperty:{url:_$_7988[24],method:_$_7988[3]},setFooter:{url:_$_7988[25],method:_$_7988[3]},resetFooter:{url:_$_7988[25],
method:_$_7988[4]},setFooterValue:{url:_$_7988[26],method:_$_7988[3]},orderBy:{url:_$_7988[27],method:_$_7988[3]},setNestedHeaders:{url:_$_7988[28],method:_$_7988[3]},setNestedCell:{url:_$_7988[29],method:_$_7988[3]},resetNestedHeaders:{url:_$_7988[28],method:_$_7988[4]},setDefinedNames:{url:_$_7988[30],method:_$_7988[3]},setValidations:{url:_$_7988[31],method:_$_7988[3]}},f=[_$_7988[32],_$_7988[33],_$_7988[34]],k=function(a,b,m){if(n[a]){b=b?_$_7988[36]+b:_$_7988[35];var d=JSON.parse(JSON.stringify(n[a]));
d.queue=!0;0<=f.indexOf(a)?d.url=l+_$_7988[37]+c.config.cloud+_$_7988[38]+d.url:d.url=l+_$_7988[37]+c.config.cloud+b+_$_7988[38]+d.url;if(a==_$_7988[39]||a==_$_7988[33])d.url+=_$_7988[38]+m.join(_$_7988[36]);var g=localStorage.getItem(_$_7988[40])||null;d.beforeSend=function(p){g&&p.setRequestHeader(_$_7988[41],_$_7988[42]+g);p.setRequestHeader(_$_7988[43],1)};var q=this;d.success=function(p){p.error&&jSuites.notification(p);p.data&&q.updateCells(p.data)};return d}},r=function(a,b){var m=this.parent.worksheets.indexOf(this);
if(a=k.call(this,a,m,b))c.progress(!0),setTimeout(function(){c.progress(!1)},1E3),Array.isArray(b)&&1==b.length?a.data=b[0]:a.data=b;return a};h.persistence=function(a,b,m,d){if(typeof io==_$_7988[44])return!1;if(!c.ignorePersistence){var g=r.call(a,b,m);g&&(typeof d===_$_7988[45]&&(g.success=d),jSuites.ajax(g))}if(!c.ignoreCloud)if(a.socket){b=[b];if(m)for(d=Object.keys(m),g=0;g<d.length;g++)b.push(m[d[g]]);a.socket.emit(_$_7988[46],b)}else console.error(_$_7988[47])};h.init=function(a){if(!a.parent.config.cloud)return!1;
typeof io==_$_7988[44]?(a.parent.element.classList.add(_$_7988[48]),console.error(_$_7988[49])):(a.socket=io(l,{path:_$_7988[50],query:{guid:a.options.worksheetId?a.parent.config.cloud+_$_7988[36]+a.options.worksheetId:a.parent.config.cloud,token:_$_7988[51]}}),a.socket.on(_$_7988[52],function(){a.parent.element.classList.contains(_$_7988[48])&&(alert(_$_7988[53]),window.open(window.location.href,_$_7988[1]))}),a.socket.on(_$_7988[54],function(){a.parent.element.classList.add(_$_7988[48])}),a.socket.on(_$_7988[55],
function(){alert(_$_7988[56]);window.open(window.location.href,_$_7988[1])}),a.socket.on(_$_7988[46],function(b){c.ignoreCloud=!0;c.ignoreHistory=!0;c.ignorePersistence=!0;if(b.a[0]==_$_7988[57])a.setBorder(b.a[1],b.a[2],b.a[3],b.a[4],b.u);else if(b.a[0]==_$_7988[58])a.resetBorders(b.u,!0);else if(typeof a[b.a[0]]==_$_7988[45])a[b.a[0]](b.a[1],b.a[2],b.a[3],b.a[4],b.a[5],b.a[6]);c.ignoreCloud=!1;c.ignoreHistory=!1;c.ignorePersistence=!1}))};return h};e.load=function(c,h){if(e.requiredLoaded)e.requiredLoaded=
!0,e[_$_7988[62]](c,h);else{jSuites.loading.show();var n=l+_$_7988[59],f=document.head,k=document.createElement(_$_7988[60]);k.type=_$_7988[61];k.src=n;k.onload=function(){cloud[_$_7988[62]](c,h);jSuites.loading.hide()};f.appendChild(k)}};e[_$_7988[62]]=function(c,h){var n=localStorage.getItem(_$_7988[40]);jSuites.ajax({url:l+_$_7988[37]+c.cloud,method:_$_7988[63],dataType:_$_7988[64],beforeSend:function(f){n&&f.setRequestHeader(_$_7988[41],_$_7988[42]+n)},success:function(f){if(1==f.privacy)jSuites.notification({message:_$_7988[65]});
else if(1==f.error)jSuites.notification(f);else{for(var k in f)c[k]=f[k];typeof c.tabs!==_$_7988[44]&&(c.tabs=!0);typeof c.toolbar!==_$_7988[44]&&(c.toolbar=!0);h(c)}},error:function(){console.log(arguments)}})};e.server=function(c){l=c};return e});
