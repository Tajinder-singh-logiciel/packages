/**
 * JSS Formula Pro 2.0.0
 * https://jspreadsheet.com/products/formula
 * @License: this plugin requires a license
 */

(()=>{var e={765:(e,t)=>{var n;n=function(e){e.version="1.0.2";var t=Math;function n(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function r(e,t,n,r,o){if(0===t)return n;if(1===t)return r;for(var i=2/e,a=r,s=1;s<t;++s)a=r*s*i+o*n,n=r,r=a;return a}function o(e,t,n,o,i){return function(n,a){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}return 0===a?e(n):1===a?t(n):a<0?NaN:r(n,a|=0,e(n),t(n),i)}}var i,a,s,l,u,c,f,d,p,h,g,m,v,y=function(){var e=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(r){var l=0,u=0,c=0,f=r*r;if(r<8)l=(u=n(o,f))/(c=n(i,f));else{var d=r-.785398164;u=n(a,f=64/f),c=n(s,f),l=t.sqrt(e/r)*(t.cos(d)*u-t.sin(d)*c*8/r)}return l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(r){var o=0,i=0,a=0,s=r*r,l=t.abs(r)-2.356194491;return Math.abs(r)<8?o=(i=r*n(u,s))/(a=n(c,s)):(i=n(f,s=64/s),a=n(d,s),o=t.sqrt(e/t.abs(r))*(t.cos(l)*i-t.sin(l)*a*8/t.abs(r)),r<0&&(o=-o)),o}return function e(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*e(n,-o);if(n<0)return(o%2?-1:1)*e(-n,o);if(0===o)return l(n);if(1===o)return p(n);if(0===n)return 0;var i=0;if(n>o)i=r(n,o,l(n),p(n),-1);else{for(var a=!1,s=0,u=0,c=1,f=0,d=2/n,h=2*t.floor((o+t.floor(t.sqrt(40*o)))/2);h>0;h--)f=h*d*c-s,s=c,c=f,t.abs(c)>1e10&&(c*=1e-10,s*=1e-10,i*=1e-10,u*=1e-10),a&&(u+=c),a=!a,h==o&&(i=s);i/=u=2*u-c}return i}}(),w=(i=.636619772,a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(e){var r=0,o=0,c=0,f=e*e,d=e-.785398164;return e<8?r=(o=n(a,f))/(c=n(s,f))+i*y(e,0)*t.log(e):(o=n(l,f=64/f),c=n(u,f),r=t.sqrt(i/e)*(t.sin(d)*o+t.cos(d)*c*8/e)),r}),(function(e){var r=0,o=0,a=0,s=e*e,l=e-2.356194491;return e<8?r=(o=e*n(c,s))/(a=n(f,s))+i*(y(e,1)*t.log(e)-1/e):(o=n(d,s=64/s),a=n(p,s),r=t.sqrt(i/e)*(t.sin(l)*o+t.cos(l)*a*8/e)),r}),0,1,-1)),E=(h=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),g=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),m=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(r,o){if(0===(o=Math.round(o)))return function(e){return e<=3.75?n(h,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(g,3.75/t.abs(e))}(r);if(1===o)return function(e){return e<3.75?e*n(m,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(v,3.75/t.abs(e))}(r);if(o<0)return NaN;if(0===t.abs(r))return 0;if(r==1/0)return 1/0;var i,a=0,s=2/t.abs(r),l=0,u=1,c=0;for(i=2*t.round((o+t.round(t.sqrt(40*o)))/2);i>0;i--)c=i*s*u+l,l=u,u=c,t.abs(u)>1e10&&(u*=1e-10,l*=1e-10,a*=1e-10),i==o&&(a=l);return a*=e(r,0)/u,r<0&&o%2?-a:a}),b=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-t.log(o/2)*E(o,0)+n(e,o*o/4):t.exp(-o)/t.sqrt(o)*n(r,2/o)}),(function(e){return e<=2?t.log(e/2)*E(e,1)+1/e*n(i,e*e/4):t.exp(-e)/t.sqrt(e)*n(a,2/e)}),0,2,1)}();e.besselj=y,e.bessely=w,e.besseli=E,e.besselk=b},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var t;e.exports=(t=function(e,t){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function i(t,n){var r=t>n?t:n;return e.pow(10,17-~~(e.log(r>0?r:-r)*e.LOG10E))}var a=Array.isArray||function(e){return"[object Array]"===o.call(e)};function s(e){return"[object Function]"===o.call(e)}function l(e){return"number"==typeof e&&e-e==0}function u(){return new u._init(arguments)}function c(){return 0}function f(){return 1}function d(e,t){return e===t?1:0}u.fn=u.prototype,u._init=function(e){if(a(e[0]))if(a(e[0][0])){s(e[1])&&(e[0]=u.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=s(e[1])?u.map(e[0],e[1]):e[0],this.length=1;else if(l(e[0]))this[0]=u.seq.apply(null,e),this.length=1;else{if(e[0]instanceof u)return u(e[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:i,isArray:a,isFunction:s,isNumber:l,toVector:function(e){return n.apply([],e)}},u._random_fn=e.random,u.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");u._random_fn=e},u.extend=function(e){var t,n;if(1===arguments.length){for(n in e)u[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},u.rows=function(e){return e.length||1},u.cols=function(e){return e[0].length||1},u.dimensions=function(e){return{rows:u.rows(e),cols:u.cols(e)}},u.row=function(e,t){return a(t)?t.map((function(t){return u.row(e,t)})):e[t]},u.rowa=function(e,t){return u.row(e,t)},u.col=function(e,t){if(a(t)){var n=u.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,r){u.arange(e.length).forEach((function(o){n[o][r]=e[o][t]}))})),n}for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=[e[o][t]];return r},u.cola=function(e,t){return u.col(e,t).map((function(e){return e[0]}))},u.diag=function(e){for(var t=u.rows(e),n=new Array(t),r=0;r<t;r++)n[r]=[e[r][r]];return n},u.antidiag=function(e){for(var t=u.rows(e)-1,n=new Array(t),r=0;t>=0;t--,r++)n[r]=[e[r][t]];return n},u.transpose=function(e){var t,n,r,o,i,s=[];for(a(e[0])||(e=[e]),n=e.length,r=e[0].length,i=0;i<r;i++){for(t=new Array(n),o=0;o<n;o++)t[o]=e[o][i];s.push(t)}return 1===s.length?s[0]:s},u.map=function(e,t,n){var r,o,i,s,l;for(a(e[0])||(e=[e]),o=e.length,i=e[0].length,s=n?e:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),l=0;l<i;l++)s[r][l]=t(e[r][l],r,l);return 1===s.length?s[0]:s},u.cumreduce=function(e,t,n){var r,o,i,s,l;for(a(e[0])||(e=[e]),o=e.length,i=e[0].length,s=n?e:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),i>0&&(s[r][0]=e[r][0]),l=1;l<i;l++)s[r][l]=t(s[r][l-1],e[r][l]);return 1===s.length?s[0]:s},u.alter=function(e,t){return u.map(e,t,!0)},u.create=function(e,t,n){var r,o,i=new Array(e);for(s(t)&&(n=t,t=e),r=0;r<e;r++)for(i[r]=new Array(t),o=0;o<t;o++)i[r][o]=n(r,o);return i},u.zeros=function(e,t){return l(t)||(t=e),u.create(e,t,c)},u.ones=function(e,t){return l(t)||(t=e),u.create(e,t,f)},u.rand=function(e,t){return l(t)||(t=e),u.create(e,t,u._random_fn)},u.identity=function(e,t){return l(t)||(t=e),u.create(e,t,d)},u.symmetric=function(e){var t,n,r=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<r;t++)for(n=0;n<r;n++)if(e[n][t]!==e[t][n])return!1;return!0},u.clear=function(e){return u.alter(e,c)},u.seq=function(e,t,n,r){s(r)||(r=!1);var o,a=[],l=i(e,t),u=(t*l-e*l)/((n-1)*l),c=e;for(o=0;c<=t&&o<n;c=(e*l+u*l*++o)/l)a.push(r?r(c,o):c);return a},u.arange=function(e,n,r){var o,i=[];if(r=r||1,n===t&&(n=e,e=0),e===n||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(o=e;o<n;o+=r)i.push(o);else for(o=e;o>n;o+=r)i.push(o);return i},u.slice=function(){function e(e,n,r,o){var i,a=[],s=e.length;if(n===t&&r===t&&o===t)return u.copy(e);if(o=o||1,(n=(n=n||0)>=0?n:s+n)===(r=(r=r||e.length)>=0?r:s+r)||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)a.push(e[i]);else for(i=n;i>r;i+=o)a.push(e[i]);return a}return function(t,n){var r,o;return l((n=n||{}).row)?l(n.col)?t[n.row][n.col]:e(u.rowa(t,n.row),(r=n.col||{}).start,r.end,r.step):l(n.col)?e(u.cola(t,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},r=n.col||{},e(t,o.start,o.end,o.step).map((function(t){return e(t,r.start,r.end,r.step)})))}}(),u.sliceAssign=function(n,r,o){var i,a;if(l(r.row)){if(l(r.col))return n[r.row][r.col]=o;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,i=u.arange(r.col.start,e.min(n.length,r.col.end),r.col.step);var s=r.row;return i.forEach((function(e,t){n[s][e]=o[t]})),n}if(l(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,a=u.arange(r.row.start,e.min(n[0].length,r.row.end),r.row.step);var c=r.col;return a.forEach((function(e,t){n[e][c]=o[t]})),n}return o[0].length===t&&(o=[o]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,a=u.arange(r.row.start,e.min(n.length,r.row.end),r.row.step),i=u.arange(r.col.start,e.min(n[0].length,r.col.end),r.col.step),a.forEach((function(e,t){i.forEach((function(r,i){n[e][r]=o[t][i]}))})),n},u.diagonal=function(e){var t=u.zeros(e.length,e.length);return e.forEach((function(e,n){t[n][n]=e})),t},u.copy=function(e){return e.map((function(e){return l(e)?e:e.map((function(e){return e}))}))};var p=u.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},p.map=function(e,t){return u(u.map(this,e,t))},p.cumreduce=function(e,t){return u(u.cumreduce(this,e,t))},p.alter=function(e){return u.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var n,r=this;return t?(setTimeout((function(){t.call(r,p[e].call(r))})),this):(n=u[e](this),a(n)?u(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,n){var r=this;return n?(setTimeout((function(){n.call(r,p[e].call(r,t))})),this):u(u[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return u(u[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),u}(Math),function(e,t){var n=e.utils.isFunction;function r(e,t){return e-t}function o(e,n,r){return t.max(n,t.min(e,r))}e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,r=e.mean(t),o=0,i=t.length;--i>=0;)o+=(n=t[i]-r)*n;return o},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){return t.pow(e.product(n),1/n.length)},e.median=function(e){var t=e.length,n=e.slice().sort(r);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,n=[],r=e.length;for(t=1;t<r;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){var t,n=[],o={};for(t=0;t<e.length;t++)o[l=e[t]]?o[l]++:(o[l]=1,n.push(l));var i=n.sort(r),a={},s=1;for(t=0;t<i.length;t++){var l,u=o[l=i[t]],c=(s+(s+u-1))/2;a[l]=c,s+=u}return e.map((function(e){return a[e]}))},e.mode=function(e){var t,n=e.length,o=e.slice().sort(r),i=1,a=0,s=0,l=[];for(t=0;t<n;t++)o[t]===o[t+1]?i++:(i>a?(l=[o[t]],a=i,s=0):i===a&&(l.push(o[t]),s++),i=1);return 0===s?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,n){return t+e.sumsqerr(n)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),r=t.length,o=new Array(r),i=0;i<r;i++)o[i]=t[i]-n;return o},e.stdev=function(n,r){return t.sqrt(e.variance(n,r))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var r=e.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.mean(o)},e.meddev=function(n){for(var r=e.median(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var n=e.length,o=e.slice().sort(r);return[o[t.round(n/4)-1],o[t.round(n/2)-1],o[t.round(3*n/4)-1]]},e.quantiles=function(e,n,i,a){var s,l,u,c,f,d=e.slice().sort(r),p=[n.length],h=e.length;for(void 0===i&&(i=3/8),void 0===a&&(a=3/8),s=0;s<n.length;s++)u=h*(l=n[s])+(i+l*(1-i-a)),c=t.floor(o(u,1,h-1)),f=o(u-c,0,1),p[s]=(1-f)*d[c-1]+f*d[c];return p},e.percentile=function(e,t,n){var o=e.slice().sort(r),i=t*(o.length+(n?1:-1))+(n?0:1),a=parseInt(i),s=i-a;return a+1<o.length?o[a-1]+s*(o[a]-o[a-1]):o[a-1]},e.percentileOfScore=function(e,t,n){var r,o,i=0,a=e.length,s=!1;for("strict"===n&&(s=!0),o=0;o<a;o++)r=e[o],(s&&r<t||!s&&r<=t)&&i++;return i/a},e.histogram=function(n,r){r=r||4;var o,i=e.min(n),a=(e.max(n)-i)/r,s=n.length,l=[];for(o=0;o<r;o++)l[o]=0;for(o=0;o<s;o++)l[t.min(t.floor((n[o]-i)/a),r-1)]+=1;return l},e.covariance=function(t,n){var r,o=e.mean(t),i=e.mean(n),a=t.length,s=new Array(a);for(r=0;r<a;r++)s[r]=(t[r]-o)*(n[r]-i);return e.sum(s)/(a-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,r){for(var o=e.mean(n),i=e.stdev(n),a=n.length,s=0,l=0;l<a;l++)s+=t.pow((n[l]-o)/i,r);return s/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(l,i[t].call(l,r))})),this;if(this.length>1){for(l=!0===r?this:this.transpose();s<l.length;s++)a[s]=e[t](l[s]);return a}return e[t](this[0],r)}}(t[r])}("cumsum cumprod".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(l,i[t].call(l,r))})),this;if(this.length>1){for("sumrow"!==t&&(l=!0===r?this:this.transpose());s<l.length;s++)a[s]=e[t](l[s]);return!0===r?e[t](e.utils.toVector(a)):a}return e[t](this[0],r)}}(t[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(){var r,o=[],a=0,s=this,l=Array.prototype.slice.call(arguments);if(n(l[l.length-1])){r=l[l.length-1];var u=l.slice(0,l.length-1);return setTimeout((function(){r.call(s,i[t].apply(s,u))})),this}r=void 0;var c=function(n){return e[t].apply(s,[n].concat(l))};if(this.length>1){for(s=s.transpose();a<s.length;a++)o[a]=c(s[a]);return o}return c(this[0])}}(t[r])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(o=(r=n=e)+5.5,o-=(n+.5)*t.log(o);i<6;i++)s+=a[i]/++r;return t.log(2.5066282746310007*s/n)-o},e.loggam=function(e){var n,r,o,i,a,s,l,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=e,l=0,1==e||2==e)return 0;for(e<=7&&(n=e+(l=t.floor(7-e))),r=1/(n*n),o=2*t.PI,a=u[9],s=8;s>=0;s--)a*=r,a+=u[s];if(i=a/n+.5*t.log(o)+(n-.5)*t.log(n)-n,e<=7)for(s=1;s<=l;s++)i-=t.log(n-1),n-=1;return i},e.gammafn=function(e){var n,r,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,f=0,d=e;if(e>171.6243769536076)return 1/0;if(d<=0){if(!(i=d%1+36e-17))return 1/0;l=(1&d?-1:1)*t.PI/t.sin(t.PI*i),d=1-d}for(o=d,r=d<1?d++:(d-=u=(0|d)-1)-1,n=0;n<8;++n)f=(f+a[n])*r,c=c*r+s[n];if(i=f/c+1,o<d)i/=o;else if(o>d)for(n=0;n<u;++n)i*=d,d++;return l&&(i=l/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,r){var o,i=e.gammaln(n),a=n,s=1/n,l=s,u=r+1-n,c=1/1e-30,f=1/u,d=f,p=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;p<=h;p++)s+=l*=r/++a;return s*t.exp(-r+n*t.log(r)-i)}for(;p<=h;p++)d*=(f=1/(f=(o=-p*(p-n))*f+(u+=2)))*(c=u+o/c);return 1-d*t.exp(-r+n*t.log(r)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,r){return n>170||r>170?t.exp(e.combinationln(n,r)):e.factorial(n)/e.factorial(r)/e.factorial(n-r)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?t.exp(e.betaln(n,r)):e.gammafn(n)*e.gammafn(r)/e.gammafn(n+r)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,r){var o,i,a,s,l=1e-30,u=1,c=n+r,f=n+1,d=n-1,p=1,h=1-c*e/f;for(t.abs(h)<l&&(h=l),s=h=1/h;u<=100&&(h=1+(i=u*(r-u)*e/((d+(o=2*u))*(n+o)))*h,t.abs(h)<l&&(h=l),p=1+i/p,t.abs(p)<l&&(p=l),s*=(h=1/h)*p,h=1+(i=-(n+u)*(c+u)*e/((n+o)*(f+o)))*h,t.abs(h)<l&&(h=l),p=1+i/p,t.abs(p)<l&&(p=l),s*=a=(h=1/h)*p,!(t.abs(a-1)<3e-7));u++);return s},e.gammapinv=function(n,r){var o,i,a,s,l,u,c=0,f=r-1,d=e.gammaln(r);if(n>=1)return t.max(100,r+100*t.sqrt(r));if(n<=0)return 0;for(r>1?(l=t.log(f),u=t.exp(f*(l-1)-d),s=n<.5?n:1-n,o=(2.30753+.27061*(i=t.sqrt(-2*t.log(s))))/(1+i*(.99229+.04481*i))-i,n<.5&&(o=-o),o=t.max(.001,r*t.pow(1-1/(9*r)-o/(3*t.sqrt(r)),3))):o=n<(i=1-r*(.253+.12*r))?t.pow(n/i,1/r):1-t.log(1-(n-i)/(1-i));c<12;c++){if(o<=0)return 0;if((o-=i=(a=(e.lowRegGamma(r,o)-n)/(i=r>1?u*t.exp(-(o-f)+f*(t.log(o)-l)):t.exp(-o+f*t.log(o)-d)))/(1-.5*t.min(1,a*((r-1)/o-1))))<=0&&(o=.5*(o+i)),t.abs(i)<1e-8*o)break}return o},e.erf=function(e){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=a.length-1,l=!1,u=0,c=0;for(e<0&&(e=-e,l=!0),r=4*(n=2/(2+e))-2;s>0;s--)o=u,u=r*u-c+a[s],c=o;return i=n*t.exp(-e*e+.5*(a[0]+r*u)-c),l?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var r,o,i,a,s=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,r=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(a/2))))/(1+i*(.99229+.04481*i))-i);s<2;s++)r+=(o=e.erfc(r)-a)/(1.1283791670955126*t.exp(-r*r)-r*o);return n<1?r:-r},e.ibetainv=function(n,r,o){var i,a,s,l,u,c,f,d,p,h,g=r-1,m=o-1,v=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(s=n<.5?n:1-n,c=(2.30753+.27061*(l=t.sqrt(-2*t.log(s))))/(1+l*(.99229+.04481*l))-l,n<.5&&(c=-c),f=(c*c-3)/6,d=2/(1/(2*r-1)+1/(2*o-1)),p=c*t.sqrt(f+d)/d-(1/(2*o-1)-1/(2*r-1))*(f+5/6-2/(3*d)),c=r/(r+o*t.exp(2*p))):(i=t.log(r/(r+o)),a=t.log(o/(r+o)),c=n<(l=t.exp(r*i)/r)/(p=l+(u=t.exp(o*a)/o))?t.pow(r*p*n,1/r):1-t.pow(o*p*(1-n),1/o)),h=-e.gammaln(r)-e.gammaln(o)+e.gammaln(r+o);v<10;v++){if(0===c||1===c)return c;if((c-=l=(u=(e.ibeta(c,r,o)-n)/(l=t.exp(g*t.log(c)+m*t.log(1-c)+h)))/(1-.5*t.min(1,u*(g/c-m/(1-c)))))<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),t.abs(l)<1e-8*c&&v>0)break}return c},e.ibeta=function(n,r,o){var i=0===n||1===n?0:t.exp(e.gammaln(r+o)-e.gammaln(r)-e.gammaln(o)+r*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*e.betacf(n,r,o)/r:1-i*e.betacf(1-n,o,r)/o)},e.randn=function(n,r){var o,i,a,s,l;if(r||(r=n),n)return e.create(n,r,(function(){return e.randn()}));do{o=e._random_fn(),i=1.7156*(e._random_fn()-.5),l=(a=o-.449871)*a+(s=t.abs(i)+.386595)*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o},e.randg=function(n,r,o){var i,a,s,l,u,c,f=n;if(o||(o=r),n||(n=1),r)return(c=e.zeros(r,o)).alter((function(){return e.randg(n)})),c;n<1&&(n+=1),i=n-1/3,a=1/t.sqrt(9*i);do{do{l=1+a*(u=e.randn())}while(l<=0);l*=l*l,s=e._random_fn()}while(s>1-.331*t.pow(u,4)&&t.log(s)>.5*u*u+i*(1-l+t.log(l)));if(n==f)return i*l;do{s=e._random_fn()}while(0===s);return t.pow(s,1/f)*i*l},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(n){return e[t](n)})))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(t,Math),function(e,t){function n(e,n,r,o){for(var i,a=0,s=1,l=1,u=1,c=0,f=0;t.abs((l-f)/l)>o;)f=l,s=u+(i=-(n+c)*(n+r+c)*e/(n+2*c)/(n+2*c+1))*s,l=(a=l+i*a)+(i=(c+=1)*(r-c)*e/(n+2*c-1)/(n+2*c))*l,a/=u=s+i*u,s/=u,l/=u,u=1;return l/n}function r(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var l,u=2*e.normal.cdf(s,0,1,1,0)-1;u=u>=t.exp(-50/o)?t.pow(u,o):0;for(var c=s,f=(8-s)/(l=n>3?2:3),d=c+f,p=0,h=o-1,g=1;g<=l;g++){for(var m=0,v=.5*(d+c),y=.5*(d-c),w=1;w<=12;w++){var E,b=v+y*(6<w?i[(E=12-w+1)-1]:-i[(E=w)-1]),x=b*b;if(x>60)break;var M=2*e.normal.cdf(b,0,1,1,0)*.5-2*e.normal.cdf(b,n,1,1,0)*.5;M>=t.exp(-30/h)&&(m+=M=a[E-1]*t.exp(-.5*x)*t.pow(M,h))}p+=m*=2*y*o/t.sqrt(2*t.PI),c=d,d+=f}return(u+=p)<=t.exp(-30/r)?0:(u=t.pow(u,r))>=1?1:u}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function e(t,n,r){return this instanceof e?(this._a=t,this._b=n,this._c=r,this):new e(t,n,r)},e.fn[t]=function(n,r,o){var i=e[t](n,r,o);return i.data=this,i},e[t].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?e.alter(n,(function(){return e[t].sample(r,o,i)})):e[t].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!=typeof r?e.fn.map.call(r,(function(r){return e[t][n](r,o,i,a)})):e[t][n](r,o,i,a)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?t.pow(n,r-1)*t.pow(1-n,o-1)/e.betafn(r,o):t.exp((r-1)*t.log(n)+(o-1)*t.log(1-n)-e.betaln(r,o))},cdf:function(t,n,r){return t>1||t<0?1*(t>1):e.ibeta(t,n,r)},inv:function(t,n,r){return e.ibetainv(t,n,r)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var r=e.randg(t);return r/(r+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,r,o){var i;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/e.betafn(r/2,o/2)*t.pow(r/o,r/2)*t.pow(n,r/2-1)*t.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),r*(o/(o+n*r))/2*e.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(t,n,r){return t<0?0:e.ibeta(n*t/(n*t+r),n/2,r/2)},inv:function(t,n,r){return r/(n*(1/e.ibetainv(t,n/2,r/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,r){return r<0?0:r/(t.pow(e-n,2)+t.pow(r,2))/t.PI},cdf:function(e,n,r){return t.atan((e-n)/r)/t.PI+.5},inv:function(e,n,r){return n+r*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(n,r){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*r+n}}),e.extend(e.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:t.exp((r/2-1)*t.log(n)-n/2-r/2*t.log(2)-e.gammaln(r/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:t.exp((r-1)*t.log(n)-n/o-e.gammaln(r)-r*t.log(o))},cdf:function(t,n,r){return t<0?0:e.lowRegGamma(n,t/r)},inv:function(t,n,r){return e.gammapinv(t,n)*r},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,r,o){return n<=0?0:t.exp(-(r+1)*t.log(n)-o/n-e.gammaln(r)+r*t.log(o))},cdf:function(t,n,r){return t<=0?0:1-e.lowRegGamma(n,r/t)},inv:function(t,n,r){return r/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,r){return 0===e&&1===n?r:1===e&&1===r?n:t.exp(t.log(n)+t.log(r)+(n-1)*t.log(e)+(r-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,r){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),r)},inv:function(e,n,r){return t.pow(1-t.pow(1-e,1/r),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,r){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(e)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*e.erf((t.log(n)-r)/t.sqrt(2*o*o))},inv:function(n,r,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*n)+r)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,r){return t.exp(e.randn()*r+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,r,o){return t.abs(o)<1e-14?e.studentt.pdf(n,r):t.abs(n)<1e-14?t.exp(e.gammaln((r+1)/2)-o*o/2-.5*t.log(t.PI*r)-e.gammaln(r/2)):r/n*(e.noncentralt.cdf(n*t.sqrt(1+2/r),r+2,o)-e.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){var i=1e-14;if(t.abs(o)<i)return e.studentt.cdf(n,r);var a=!1;n<0&&(a=!0,o=-o);for(var s=e.normal.cdf(-o,0,1),l=i+1,u=l,c=n*n/(n*n+r),f=0,d=t.exp(-o*o/2),p=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;f<200||u>i||l>i;)u=l,f>0&&(d*=o*o/(2*f),p*=o*o/(2*(f+.5))),s+=.5*(l=d*e.beta.cdf(c,f+.5,r/2)+p*e.beta.cdf(c,f+1,r/2)),f++;return a?1-s:s}}),e.extend(e.normal,{pdf:function(e,n,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(e-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+e.erf((n-r)/t.sqrt(2*o*o)))},inv:function(t,n,r){return-1.4142135623730951*r*e.erfcinv(2*t)+n},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,r){return e<n?0:r*t.pow(n,r)/t.pow(e,r+1)},cdf:function(e,n,r){return e<n?0:1-t.pow(n/e,r)},inv:function(e,n,r){return n/t.pow(1-e,1/r)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*e.betafn(.5,r/2))*t.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return e.ibeta((n+t.sqrt(n*n+r))/(2*t.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=e.ibetainv(2*t.min(n,1-n),.5*r,.5);return o=t.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,r){return e<0||n<0||r<0?0:r/n*t.pow(e/n,r-1)*t.exp(-t.pow(e/n,r))},cdf:function(e,n,r){return e<0?0:1-t.exp(-t.pow(e/n,r))},inv:function(e,n,r){return n*t.pow(-t.log(1-e),1/r)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(n,r){return n*t.pow(-t.log(e._random_fn()),1/r)},variance:function(n,r){return n*n*e.gammafn(1+2/r)-t.pow(e.weibull.mean(n,r),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e._random_fn()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:e.combination(r,n)*t.pow(o,n)*t.pow(1-o,r-n)},cdf:function(r,o,i){var a,s=1e-10;if(r<0)return 0;if(r>=o)return 1;if(i<0||i>1||o<=0)return NaN;var l=i,u=(r=t.floor(r))+1,c=o-r,f=u+c,d=t.exp(e.gammaln(f)-e.gammaln(c)-e.gammaln(u)+u*t.log(l)+c*t.log(1-l));return a=l<(u+1)/(f+2)?d*n(l,u,c,s):1-d*n(1-l,c,u,s),t.round(1/s*(1-a))/(1/s)}}),e.extend(e.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:e.combination(n+r-1,r-1)*t.pow(1-o,n)*t.pow(o,r))},cdf:function(t,n,r){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=e.negbin.pdf(i,n,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,r,o,i){if(n!=n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?e.hypgeom.pdf(r-o-i+n,r,r-o,r-i):e.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return e.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return e.hypgeom.pdf(n,r,i,o);for(var a=1,s=0,l=0;l<n;l++){for(;a>1&&s<i;)a*=1-o/(r-s),s++;a*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;s<i;s++)a*=1-o/(r-s);return t.min(1,t.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?e.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-e.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-e.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return e.hypgeom.cdf(n,r,i,o);for(var a=1,s=1,l=0,u=0;u<n;u++){for(;a>1&&l<i;){var c=1-o/(r-l);s*=c,a*=c,l++}a+=s*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1))}for(;l<i;l++)a*=1-o/(r-l);return t.min(1,t.max(0,a))}}),e.extend(e.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:t.pow(r,n)*t.exp(-r)/e.factorial(n)},cdf:function(t,n){var r=[],o=0;if(t<0)return 0;for(;o<=t;o++)r.push(e.poisson.pdf(o,n));return e.sum(r)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(n){var r=1,o=0,i=t.exp(-n);do{o++,r*=e._random_fn()}while(r>i);return o-1},sampleLarge:function(n){var r,o,i,a,s,l,u,c,f,d,p=n;for(a=t.sqrt(p),s=t.log(p),l=.02483*(u=.931+2.53*a)-.059,c=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(o=t.random()-.5,i=t.random(),d=.5-t.abs(o),r=t.floor((2*l/d+u)*o+p+.43),d>=.07&&i<=f)return r;if(!(r<0||d<.013&&i>d)&&t.log(i)+t.log(c)-t.log(l/(d*d)+u)<=r*s-p-e.loggam(r+1))return r}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,n,r){return n<=t||r<t||r>n?NaN:e<t||e>n?0:e<r?2*(e-t)/((n-t)*(r-t)):e===r?2/(n-t):2*(n-e)/((n-t)*(n-r))},cdf:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=n?0:e>=r?1:e<=o?t.pow(e-n,2)/((r-n)*(o-n)):1-t.pow(r-e,2)/((r-n)*(r-o))},inv:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=(o-n)/(r-n)?n+(r-n)*t.sqrt(e*((o-n)/(r-n))):n+(r-n)*(1-t.sqrt((1-e)*(1-(o-n)/(r-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,r){return r<=(e+n)/2?n-t.sqrt((n-e)*(n-r))/t.sqrt(2):r>(e+n)/2?e+t.sqrt((n-e)*(r-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(n,r,o){var i=e._random_fn();return i<(o-n)/(r-n)?n+t.sqrt(i*(r-n)*(o-n)):r-t.sqrt((1-i)*(r-n)*(r-o))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,r){return r<=n?NaN:e<=n||e>=r?0:2/t.PI*t.pow(t.pow(r-n,2)-t.pow(2*e-n-r,2),-.5)},cdf:function(e,n,r){return e<n?0:e<r?2/t.PI*t.asin(t.sqrt((e-n)/(r-n))):1},inv:function(e,n,r){return n+(.5-.5*t.cos(t.PI*e))*(r-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,r){return r<=0?0:t.exp(-t.abs(e-n)/r)/(2*r)},cdf:function(e,n,r){return r<=0?0:e<n?.5*t.exp((e-n)/r):1-.5*t.exp(-(e-n)/r)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(n,r){var o,i=e._random_fn()-.5;return n-r*((o=i)/t.abs(o))*t.log(1-2*t.abs(i))}}),e.extend(e.tukey,{cdf:function(n,o,i){var a=o,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return r(n,1,a);var u,c=.5*i,f=c*t.log(i)-i*t.log(2)-e.gammaln(c),d=c-1,p=.25*i;u=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=t.log(u);for(var h=0,g=1;g<=50;g++){for(var m=0,v=(2*g-1)*u,y=1;y<=16;y++){var w,E;8<y?(w=y-8-1,E=f+d*t.log(v+s[w]*u)-(s[w]*u+v)*p):(w=y-1,E=f+d*t.log(v-s[w]*u)+(s[w]*u-v)*p),E>=-30&&(m+=r(8<y?n*t.sqrt(.5*(s[w]*u+v)):n*t.sqrt(.5*(-s[w]*u+v)),1,a)*l[w]*t.exp(E))}if(g*u>=1&&m<=1e-14)break;h+=m}if(m>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,a=function(e,n,r){var o=.5-.5*e,i=t.sqrt(t.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(a+=(a*a*a+a)/r/4);var s=.8832-.2368*a;return r<120&&(s+=-1.214/r+1.208*a/r),a*(s*t.log(n-1)+1.4142)}(n,r,o),s=e.tukey.cdf(a,r,o)-n;i=s>0?t.max(0,a-1):a+1;for(var l,u=e.tukey.cdf(i,r,o)-n,c=1;c<50;c++)if(l=i-u*(i-a)/(u-s),s=u,a=i,l<0&&(l=0,u=-n),u=e.tukey.cdf(l,r,o)-n,i=l,t.abs(i-a)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var n,r,o=Array.prototype.push,i=e.utils.isArray;function a(t){return i(t)||t instanceof e}e.extend({add:function(t,n){return a(n)?(a(n[0])||(n=[n]),e.map(t,(function(e,t,r){return e+n[t][r]}))):e.map(t,(function(e){return e+n}))},subtract:function(t,n){return a(n)?(a(n[0])||(n=[n]),e.map(t,(function(e,t,r){return e-n[t][r]||0}))):e.map(t,(function(e){return e-n}))},divide:function(t,n){return a(n)?(a(n[0])||(n=[n]),e.multiply(t,e.inv(n))):e.map(t,(function(e){return e/n}))},multiply:function(t,n){var r,o,i,s,l,u,c,f;if(void 0===t.length&&void 0===n.length)return t*n;if(l=t.length,u=t[0].length,c=e.zeros(l,i=a(n)?n[0].length:u),f=0,a(n)){for(;f<i;f++)for(r=0;r<l;r++){for(s=0,o=0;o<u;o++)s+=t[r][o]*n[o][f];c[r][f]=s}return 1===l&&1===f?c[0][0]:c}return e.map(t,(function(e){return e*n}))},outer:function(t,n){return e.multiply(t.map((function(e){return[e]})),[n])},dot:function(t,n){a(t[0])||(t=[t]),a(n[0])||(n=[n]);for(var r,o,i=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===n[0].length&&1!==n.length?e.transpose(n):n,l=[],u=0,c=i.length,f=i[0].length;u<c;u++){for(l[u]=[],r=0,o=0;o<f;o++)r+=i[u][o]*s[u][o];l[u]=r}return 1===l.length?l[0]:l},pow:function(n,r){return e.map(n,(function(e){return t.pow(e,r)}))},exp:function(n){return e.map(n,(function(e){return t.exp(e)}))},log:function(n){return e.map(n,(function(e){return t.log(e)}))},abs:function(n){return e.map(n,(function(e){return t.abs(e)}))},norm:function(e,n){var r=0,o=0;for(isNaN(n)&&(n=2),a(e[0])&&(e=e[0]);o<e.length;o++)r+=t.pow(t.abs(e[o]),n);return t.pow(r,1/n)},angle:function(n,r){return t.acos(e.dot(n,r)/(e.norm(n)*e.norm(r)))},aug:function(e,t){var n,r=[];for(n=0;n<e.length;n++)r.push(e[n].slice());for(n=0;n<r.length;n++)o.apply(r[n],t[n]);return r},inv:function(t){for(var n,r=t.length,o=t[0].length,i=e.identity(r,o),a=e.gauss_jordan(t,i),s=[],l=0;l<r;l++)for(s[l]=[],n=o;n<a[0].length;n++)s[l][n-o]=a[l][n];return s},det:function(e){var t,n=e.length,r=2*n,o=new Array(r),i=n-1,a=r-1,s=i-n+1,l=a,u=0,c=0;if(2===n)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;u<r;u++)o[u]=1;for(u=0;u<n;u++){for(t=0;t<n;t++)o[s<0?s+n:s]*=e[u][t],o[l<n?l+n:l]*=e[u][t],s++,l--;s=--i-n+1,l=--a}for(u=0;u<n;u++)c+=o[u];for(;u<r;u++)c-=o[u];return c},gauss_elimination:function(n,r){var o,i,a,s,l=0,u=0,c=n.length,f=n[0].length,d=1,p=0,h=[];for(o=(n=e.aug(n,r))[0].length,l=0;l<c;l++){for(i=n[l][l],u=l,s=l+1;s<f;s++)i<t.abs(n[s][l])&&(i=n[s][l],u=s);if(u!=l)for(s=0;s<o;s++)a=n[l][s],n[l][s]=n[u][s],n[u][s]=a;for(u=l+1;u<c;u++)for(d=n[u][l]/n[l][l],s=l;s<o;s++)n[u][s]=n[u][s]-d*n[l][s]}for(l=c-1;l>=0;l--){for(p=0,u=l+1;u<=c-1;u++)p+=h[u]*n[l][u];h[l]=(n[l][o-1]-p)/n[l][l]}return h},gauss_jordan:function(n,r){var o,i,a,s=e.aug(n,r),l=s.length,u=s[0].length,c=0;for(i=0;i<l;i++){var f=i;for(a=i+1;a<l;a++)t.abs(s[a][i])>t.abs(s[f][i])&&(f=a);var d=s[i];for(s[i]=s[f],s[f]=d,a=i+1;a<l;a++)for(c=s[a][i]/s[i][i],o=i;o<u;o++)s[a][o]-=s[i][o]*c}for(i=l-1;i>=0;i--){for(c=s[i][i],a=0;a<i;a++)for(o=u-1;o>i-1;o--)s[a][o]-=s[i][o]*s[a][i]/c;for(s[i][i]/=c,o=l;o<u;o++)s[i][o]/=c}return s},triaUpSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),a=!0),e.arange(o-1,-1,-1).forEach((function(a){r=e.arange(a+1,o).map((function(e){return i[e]*t[a][e]})),i[a]=(n[a]-e.sum(r))/t[a][a]})),a?i.map((function(e){return[e]})):i},triaLowSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),a=!0),e.arange(o).forEach((function(o){r=e.arange(o).map((function(e){return t[o][e]*i[e]})),i[o]=(n[o]-e.sum(r))/t[o][o]})),a?i.map((function(e){return[e]})):i},lu:function(t){var n,r=t.length,o=e.identity(r),i=e.zeros(t.length,t[0].length);return e.arange(r).forEach((function(e){i[0][e]=t[0][e]})),e.arange(1,r).forEach((function(a){e.arange(a).forEach((function(r){n=e.arange(r).map((function(e){return o[a][e]*i[e][r]})),o[a][r]=(t[a][r]-e.sum(n))/i[r][r]})),e.arange(a,r).forEach((function(r){n=e.arange(a).map((function(e){return o[a][e]*i[e][r]})),i[a][r]=t[n.length][r]-e.sum(n)}))})),[o,i]},cholesky:function(n){var r,o=n.length,i=e.zeros(n.length,n[0].length);return e.arange(o).forEach((function(a){r=e.arange(a).map((function(e){return t.pow(i[a][e],2)})),i[a][a]=t.sqrt(n[a][a]-e.sum(r)),e.arange(a+1,o).forEach((function(t){r=e.arange(a).map((function(e){return i[a][e]*i[t][e]})),i[t][a]=(n[a][t]-e.sum(r))/i[a][a]}))})),i},gauss_jacobi:function(n,r,o,i){for(var a,s,l,u,c=0,f=0,d=n.length,p=[],h=[],g=[];c<d;c++)for(p[c]=[],h[c]=[],g[c]=[],f=0;f<d;f++)c>f?(p[c][f]=n[c][f],h[c][f]=g[c][f]=0):c<f?(h[c][f]=n[c][f],p[c][f]=g[c][f]=0):(g[c][f]=n[c][f],p[c][f]=h[c][f]=0);for(l=e.multiply(e.multiply(e.inv(g),e.add(p,h)),-1),s=e.multiply(e.inv(g),r),a=o,u=e.add(e.multiply(l,o),s),c=2;t.abs(e.norm(e.subtract(u,a)))>i;)a=u,u=e.add(e.multiply(l,a),s),c++;return u},gauss_seidel:function(n,r,o,i){for(var a,s,l,u,c,f=0,d=n.length,p=[],h=[],g=[];f<d;f++)for(p[f]=[],h[f]=[],g[f]=[],a=0;a<d;a++)f>a?(p[f][a]=n[f][a],h[f][a]=g[f][a]=0):f<a?(h[f][a]=n[f][a],p[f][a]=g[f][a]=0):(g[f][a]=n[f][a],p[f][a]=h[f][a]=0);for(u=e.multiply(e.multiply(e.inv(e.add(g,p)),h),-1),l=e.multiply(e.inv(e.add(g,p)),r),s=o,c=e.add(e.multiply(u,o),l),f=2;t.abs(e.norm(e.subtract(c,s)))>i;)s=c,c=e.add(e.multiply(u,s),l),f+=1;return c},SOR:function(n,r,o,i,a){for(var s,l,u,c,f,d=0,p=n.length,h=[],g=[],m=[];d<p;d++)for(h[d]=[],g[d]=[],m[d]=[],s=0;s<p;s++)d>s?(h[d][s]=n[d][s],g[d][s]=m[d][s]=0):d<s?(g[d][s]=n[d][s],h[d][s]=m[d][s]=0):(m[d][s]=n[d][s],h[d][s]=g[d][s]=0);for(c=e.multiply(e.inv(e.add(m,e.multiply(h,a))),e.subtract(e.multiply(m,1-a),e.multiply(g,a))),u=e.multiply(e.multiply(e.inv(e.add(m,e.multiply(h,a))),r),a),l=o,f=e.add(e.multiply(c,o),u),d=2;t.abs(e.norm(e.subtract(f,l)))>i;)l=f,f=e.add(e.multiply(c,l),u),d++;return f},householder:function(n){for(var r,o,i,a,s=n.length,l=n[0].length,u=0,c=[],f=[];u<s-1;u++){for(r=0,a=u+1;a<l;a++)r+=n[a][u]*n[a][u];for(r=(n[u+1][u]>0?-1:1)*t.sqrt(r),o=t.sqrt((r*r-n[u+1][u]*r)/2),(c=e.zeros(s,1))[u+1][0]=(n[u+1][u]-r)/(2*o),i=u+2;i<s;i++)c[i][0]=n[i][u]/(2*o);f=e.subtract(e.identity(s,l),e.multiply(e.multiply(c,e.transpose(c)),2)),n=e.multiply(f,e.multiply(n,f))}return n},QR:(n=e.sum,r=e.arange,function(o){var i,a,s,l=o.length,u=o[0].length,c=e.zeros(u,u);for(o=e.copy(o),a=0;a<u;a++){for(c[a][a]=t.sqrt(n(r(l).map((function(e){return o[e][a]*o[e][a]})))),i=0;i<l;i++)o[i][a]=o[i][a]/c[a][a];for(s=a+1;s<u;s++)for(c[a][s]=n(r(l).map((function(e){return o[e][a]*o[e][s]}))),i=0;i<l;i++)o[i][s]=o[i][s]-o[i][a]*c[a][s]}return[o,c]}),lstsq:function(t,n){var r=!1;void 0===n[0].length&&(n=n.map((function(e){return[e]})),r=!0);var o=e.QR(t),i=o[0],a=o[1],s=t[0].length,l=e.slice(i,{col:{end:s}}),u=function(t){var n=(t=e.copy(t)).length,r=e.identity(n);return e.arange(n-1,-1,-1).forEach((function(n){e.sliceAssign(r,{row:n},e.divide(e.slice(r,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach((function(o){var i=e.multiply(t[o][n],-1),a=e.slice(t,{row:o}),s=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:o},e.add(a,s));var l=e.slice(r,{row:o}),u=e.multiply(e.slice(r,{row:n}),i);e.sliceAssign(r,{row:o},e.add(l,u))}))})),r}(e.slice(a,{row:{end:s}})),c=e.transpose(l);void 0===c[0].length&&(c=[c]);var f=e.multiply(e.multiply(u,c),n);return void 0===f.length&&(f=[[f]]),r?f.map((function(e){return e[0]})):f},jacobi:function(n){for(var r,o,i,a,s,l,u,c=1,f=n.length,d=e.identity(f,f),p=[];1===c;){for(s=n[0][1],i=0,a=1,r=0;r<f;r++)for(o=0;o<f;o++)r!=o&&s<t.abs(n[r][o])&&(s=t.abs(n[r][o]),i=r,a=o);for(l=n[i][i]===n[a][a]?n[i][a]>0?t.PI/4:-t.PI/4:t.atan(2*n[i][a]/(n[i][i]-n[a][a]))/2,(u=e.identity(f,f))[i][i]=t.cos(l),u[i][a]=-t.sin(l),u[a][i]=t.sin(l),u[a][a]=t.cos(l),d=e.multiply(d,u),n=e.multiply(e.multiply(e.inv(u),n),u),c=0,r=1;r<f;r++)for(o=1;o<f;o++)r!=o&&t.abs(n[r][o])>.001&&(c=1)}for(r=0;r<f;r++)p.push(n[r][r]);return[d,p]},rungekutta:function(e,t,n,r,o,i){var a,s,l;if(2===i)for(;r<=n;)o+=((a=t*e(r,o))+(s=t*e(r+t,o+a)))/2,r+=t;if(4===i)for(;r<=n;)o+=((a=t*e(r,o))+2*(s=t*e(r+t/2,o+a/2))+2*(l=t*e(r+t/2,o+s/2))+t*e(r+t,o+l))/6,r+=t;return o},romberg:function(e,n,r,o){for(var i,a,s,l,u,c=0,f=(r-n)/2,d=[],p=[],h=[];c<o/2;){for(u=e(n),s=n,l=0;s<=r;s+=f,l++)d[l]=s;for(i=d.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*e(d[s]);u=f/3*(u+e(r)),h[c]=u,f/=2,c++}for(a=h.length,i=1;1!==a;){for(s=0;s<a-1;s++)p[s]=(t.pow(4,i)*h[s+1]-h[s])/(t.pow(4,i)-1);a=p.length,h=p,p=[],i++}return h},richardson:function(e,n,r,o){function i(e,t){for(var n,r=0,o=e.length;r<o;r++)e[r]===t&&(n=r);return n}for(var a,s,l,u,c,f=t.abs(r-e[i(e,r)+1]),d=0,p=[],h=[];o>=f;)a=i(e,r+o),s=i(e,r),p[d]=(n[a]-2*n[s]+n[2*s-a])/(o*o),o/=2,d++;for(u=p.length,l=1;1!=u;){for(c=0;c<u-1;c++)h[c]=(t.pow(4,l)*p[c+1]-p[c])/(t.pow(4,l)-1);u=h.length,p=h,h=[],l++}return p},simpson:function(e,t,n,r){for(var o,i=(n-t)/r,a=e(t),s=[],l=t,u=0,c=1;l<=n;l+=i,u++)s[u]=l;for(o=s.length;c<o-1;c++)a+=(c%2!=0?4:2)*e(s[c]);return i/3*(a+e(n))},hermite:function(e,t,n,r){for(var o,i=e.length,a=0,s=0,l=[],u=[],c=[],f=[];s<i;s++){for(l[s]=1,o=0;o<i;o++)s!=o&&(l[s]*=(r-e[o])/(e[s]-e[o]));for(u[s]=0,o=0;o<i;o++)s!=o&&(u[s]+=1/(e[s]-e[o]));c[s]=(1-2*(r-e[s])*u[s])*(l[s]*l[s]),f[s]=(r-e[s])*(l[s]*l[s]),a+=c[s]*t[s]+f[s]*n[s]}return a},lagrange:function(e,t,n){for(var r,o,i=0,a=0,s=e.length;a<s;a++){for(o=t[a],r=0;r<s;r++)a!=r&&(o*=(n-e[r])/(e[a]-e[r]));i+=o}return i},cubic_spline:function(t,n,r){for(var o,i,a=t.length,s=0,l=[],u=[],c=[],f=[],d=[],p=[];s<a-1;s++)f[s]=t[s+1]-t[s];for(c[0]=0,s=1;s<a-1;s++)c[s]=3/f[s]*(n[s+1]-n[s])-3/f[s-1]*(n[s]-n[s-1]);for(s=1;s<a-1;s++)l[s]=[],u[s]=[],l[s][s-1]=f[s-1],l[s][s]=2*(f[s-1]+f[s]),l[s][s+1]=f[s],u[s][0]=c[s];for(i=e.multiply(e.inv(l),u),o=0;o<a-1;o++)d[o]=(n[o+1]-n[o])/f[o]-f[o]*(i[o+1][0]+2*i[o][0])/3,p[o]=(i[o+1][0]-i[o][0])/(3*f[o]);for(o=0;o<a&&!(t[o]>r);o++);return n[o-=1]+(r-t[o])*d[o]+e.sq(r-t[o])*i[o]+(r-t[o])*e.sq(r-t[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,r,o,i,a,s=t.length,l=t[0].length,u=0,c=[],f=[],d=[],p=[],h=[],g=[],m=[];for(u=0;u<s;u++)c[u]=e.sum(t[u])/l;for(u=0;u<l;u++)for(h[u]=[],n=0;n<s;n++)h[u][n]=t[n][u]-c[n];for(h=e.transpose(h),u=0;u<s;u++)for(g[u]=[],n=0;n<s;n++)g[u][n]=e.dot([h[u]],[h[n]])/(l-1);for(a=(o=e.jacobi(g))[0],f=o[1],m=e.transpose(a),u=0;u<f.length;u++)for(n=u;n<f.length;n++)f[u]<f[n]&&(r=f[u],f[u]=f[n],f[n]=r,d=m[u],m[u]=m[n],m[n]=d);for(i=e.transpose(h),u=0;u<s;u++)for(p[u]=[],n=0;n<i.length;n++)p[u][n]=e.dot([m[u]],[i[n]]);return[t,f,m,p]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,r){var o=this;return r?(setTimeout((function(){r.call(o,e.fn[t].call(o,n))}),15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var n=[].slice,r=e.utils.isNumber,o=e.utils.isArray;function i(e,n,r,o){if(e>1||r>1||e<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+r*o)/(n+o);return(e-r)/t.sqrt(i*(1-i)*(1/n+1/o))}e.extend({zscore:function(){var t=n.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=e.zscore(i[0],i[1],i[3]),1===i[2]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):i.length>2?(r=e.zscore(i[0],i[1],i[2]),1===i[3]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):(r=i[0],1===i[1]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,r,o){var i=t.abs(this.zscore(n,o));return 1===r?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-e.mean(r[1]))/(e.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-o,i[3]-1):2*e.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=t.abs(i[0]),1==i[2]?e.studentt.cdf(-o,i[1]-1):2*e.studentt.cdf(-o,i[1]-1)):(o=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-o,i[1].length-1):2*e.studentt.cdf(-o,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var r,o,i,a,s,l,u,c,f=n.call(arguments);if(1===f.length){for(s=new Array(f[0].length),u=0;u<f[0].length;u++)s[u]=f[0][u];f=s}for(o=new Array,u=0;u<f.length;u++)o=o.concat(f[u]);for(i=e.mean(o),r=0,u=0;u<f.length;u++)r+=f[u].length*t.pow(e.mean(f[u])-i,2);for(r/=f.length-1,l=0,u=0;u<f.length;u++)for(a=e.mean(f[u]),c=0;c<f[u].length;c++)l+=t.pow(f[u][c]-a,2);return r/(l/(o.length-f.length))},anovaftest:function(){var t,o,i,a,s=n.call(arguments);if(r(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);var l=e.anovafscore(s);for(t=s.length-1,i=0,a=0;a<s.length;a++)i+=s[a].length;return o=i-t-1,1-e.centralF.cdf(l,t,o)},ftest:function(t,n,r){return 1-e.centralF.cdf(t,n,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var o,i,a,s,l,u=n.call(arguments);return r(u[0])?(o=u[0],i=u[1],a=u[2],s=u[3],l=u[4]):(o=e.mean(u[0]),i=e.mean(u[1]),a=u[0].length,s=u[1].length,l=u[2]),t.abs(o-i)/(l*t.sqrt((1/a+1/s)/2))},qtest:function(){var t,r=n.call(arguments);3===r.length?(t=r[0],r=r.slice(1)):7===r.length?(t=e.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(t=e.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-e.tukey.cdf(t,i,o-i)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),r=t.map((function(t){return e.mean(t)})),o=t.reduce((function(e,t){return e+t.length}),0),i=[],a=0;a<t.length;++a)for(var s=a+1;s<t.length;++s){var l=e.qtest(r[a],r[s],t[a].length,t[s].length,n,o,t.length);i.push([[a,s],l])}return i}}),e.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,n,r,o){var a=i(t,n,r,o);return e.ztest(a,1)},twoSidedDifferenceOfProportions:function(t,n,r,o){var a=i(t,n,r,o);return e.ztest(a,2)}})}(t,Math),t.models=function(){function e(e,n){var r=e.length,o=n[0].length-1,i=r-o-1,a=t.lstsq(n,e),s=t.multiply(n,a.map((function(e){return[e]}))).map((function(e){return e[0]})),l=t.subtract(e,s),u=t.mean(e),c=t.sum(s.map((function(e){return Math.pow(e-u,2)}))),f=t.sum(e.map((function(e,t){return Math.pow(e-s[t],2)}))),d=c+f;return{exog:n,endog:e,nobs:r,df_model:o,df_resid:i,coef:a,predict:s,resid:l,ybar:u,SST:d,SSE:c,SSR:f,R2:c/d}}function n(n){var r,o,i=(r=n.exog,o=r[0].length,t.arange(o).map((function(n){var i=t.arange(o).filter((function(e){return e!==n}));return e(t.col(r,n).map((function(e){return e[0]})),t.col(r,i))}))),a=Math.sqrt(n.SSR/n.df_resid),s=i.map((function(e){var t=e.SST,n=e.R2;return a/Math.sqrt(t*(1-n))})),l=n.coef.map((function(e,t){return(e-0)/s[t]})),u=l.map((function(e){var r=t.studentt.cdf(e,n.df_resid);return 2*(r>.5?1-r:r)})),c=t.studentt.inv(.975,n.df_resid),f=n.coef.map((function(e,t){var n=c*s[t];return[e-n,e+n]}));return{se:s,t:l,p:u,sigmaHat:a,interval95:f}}return{ols:function(r,o){var i=e(r,o),a=n(i),s=function(e){var n,r,o,i=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:i,pvalue:1-(n=i,r=e.df_model,o=e.df_resid,t.beta.cdf(n/(o/r+n),r/2,o/2))}}(i),l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=s,i.adjust_R2=l,i}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++){var r=[1];e[n]=r.concat(arguments[n])}return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var r=[1];e[n]=r.concat(arguments[0][n])}return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,n){var r,o,i,a,s;if(e.cols()==n.rows()){if(n.rows()>1){for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<n.cols();o++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[r][i]*n.toArray()[i][o];a[r][o]=s}return t(a)}for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<n.cols();o++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[r][i]*n.toArray()[o];a[r][o]=s}return t(a)}},regress:function(e,n){var r=t.xtranspxinv(e),o=e.transpose(),i=t.matrixmult(t(r),o);return t.matrixmult(i,n)},regresst:function(e,n,r){var o=t.regress(e,n),i={anova:{}},a=t.jMatYBar(e,o);i.yBar=a;var s=n.mean();i.anova.residuals=t.residuals(n,a),i.anova.ssr=t.ssr(a,s),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=t.sse(n,a),i.anova.mse=i.anova.sse/(n.length-(e[0].length-1)-1),i.anova.sst=t.sst(n,s),i.anova.mst=i.anova.sst/(n.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var l,u,c,f=t.xtranspxinv(e),d=0;d<o.length;d++)l=Math.sqrt(i.anova.mse*Math.abs(f[d][d])),u=Math.abs(o[d]/l),c=t.ttest(u,n.length-e[0].length-1,r),i.stats[d]=[o[d],l,u,c];return i.regress=o,i},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e);return t.inv(n)},jMatYBar:function(e,n){var r=t.matrixmult(e,n);return new t(r)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},sse:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},sst:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},matrixsubtract:function(e,n){for(var r=new Array(e.length),o=0;o<e.length;o++){r[o]=new Array(e[o].length);for(var i=0;i<e[o].length;i++)r[o][i]=e[o][i]-n[o][i]}return t(r)}}),t.jStat=t,t)},551:function(e){e.exports=function(){"use strict";var e=function(t){var n={},r=function(e,t){return!(!e[t.type]||e[t.type]!=t)||!!e.parentNode&&r(e.parentNode,t)};return n.init=function(){var t=15,o=null,i=!1,a={x:null,y:null};document.addEventListener("mouseup",(function(e){i&&i.e&&("function"==typeof i.e.refresh&&a.actioned&&i.e.refresh(),i.e.style.cursor=""),a={x:null,y:null},i=!1})),document.addEventListener("mousedown",(function(t){var n=e.findElement(t.target,"jpanel");if(n&&!n.classList.contains("readonly")){n.focus();var a=t.target.getBoundingClientRect();i={e:n,x:t.clientX,y:t.clientY,w:a.width,h:a.height,d:n.style.cursor,resizing:!!n.style.cursor,actioned:!1},n.style.width||(n.style.width=a.width+"px"),n.style.height||(n.style.height=a.height+"px");var s=window.getSelection();if(s.rangeCount)for(var l=0;l<s.rangeCount;l++)s.removeRange(s.getRangeAt(l));t.preventDefault(),t.stopPropagation()}else i=!1;if(t.changedTouches&&t.changedTouches[0])var u=t.changedTouches[0].clientX,c=t.changedTouches[0].clientY;else u=t.clientX,c=t.clientY;var f=event.path||event.composedPath&&event.composedPath();if(f)o=f[0];else{if(t.target&&t.target.shadowRoot)var d=t.target.shadowRoot;else d=document;o=d.elementFromPoint(u,c)}!function(t){if(e.current.length>0)for(var n=0;n<e.current.length;n++)e.current[n]&&!r(t,e.current[n])&&e.current[n].close()}(o)})),document.addEventListener("mousemove",(function(n){if(i){var r=n.clientX||n.pageX,o=n.clientY||n.pageY;if(i.resizing){var s=null,l=null;if("e-resize"==i.d||"ne-resize"==i.d||"se-resize"==i.d)if(s=i.w+(r-i.x),i.e.style.width=s+"px",n.shiftKey){var u=(r-i.x)*(i.h/i.w);l=i.h+u,i.e.style.height=l+"px"}else u=!1;u||"s-resize"!=i.d&&"se-resize"!=i.d&&"sw-resize"!=i.d||(l=i.h+(o-i.y),i.e.style.height=l+"px"),"function"==typeof i.e.refresh&&(a.actioned=!0,i.e.refresh("dimensions",s,l))}else{null==a.x&&null==a.y&&(a.x=r,a.y=o);var c=r-a.x,f=o-a.y,d=i.e.offsetTop+f,p=i.e.offsetLeft+c;i.e.style.top=d+"px",i.e.style.left=p+"px",i.e.style.cursor="move",a.x=r,a.y=o,"function"==typeof i.e.refresh&&(a.actioned=!0,i.e.refresh("position",d,p))}}else{var h=e.findElement(n.target,"jpanel");if(h&&h.getAttribute("tabindex")){var g=h.getBoundingClientRect();n.clientY-g.top<t?g.width-(n.clientX-g.left)<t?h.style.cursor="ne-resize":n.clientX-g.left<t?h.style.cursor="nw-resize":h.style.cursor="n-resize":g.height-(n.clientY-g.top)<t?g.width-(n.clientX-g.left)<t?h.style.cursor="se-resize":n.clientX-g.left<t?h.style.cursor="sw-resize":h.style.cursor="s-resize":g.width-(n.clientX-g.left)<t?h.style.cursor="e-resize":n.clientX-g.left<t?h.style.cursor="w-resize":h.style.cursor=""}}})),document.addEventListener("dblclick",(function(t){var n=e.findElement(t.target,"jpanel");n&&"function"==typeof n.dblclick&&n.dblclick(t)})),document.addEventListener("keydown",(function(t){var n=document.activeElement;n&&"Delete"==t.key&&"function"==typeof n.delete&&(n.delete(),t.preventDefault(),t.stopImmediatePropagation()),e.current.length&&(n=e.current[e.current.length-1])&&"Escape"==t.key&&"function"==typeof n.close&&(n.close(),t.preventDefault(),t.stopImmediatePropagation())})),document.addEventListener("contextmenu",(function(t){var n=document.activeElement;if(n&&"function"==typeof n.contextmenu)n.contextmenu(t),t.preventDefault(),t.stopImmediatePropagation();else if(n=e.findElement(t.target,(function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")})),n){var r=document.querySelector("#"+n);r?(r.contextmenu.open(t),t.preventDefault(),t.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+n)}})),document.dictionary={},n.version="4.12.0"},n.setExtensions=function(e){if("object"==typeof e)for(var t=Object.keys(e),r=0;r<t.length;r++)n[t[r]]=e[t[r]]},n.tracking=function(t,n){if(1==n)e.current=e.current.filter((function(e){return null!==e})),setTimeout((function(){e.current.push(t)}),0);else{var r=e.current.indexOf(t);r>=0&&e.current.splice(r,1)}},n.path=function(e,t){if((e=e.split(".")).length){for(var n=this,r=null;e.length>1;)if(r=e.shift(),n.hasOwnProperty(r))n=n[r];else{if(void 0===t)return;n[r]={},n=n[r]}if(r=e.shift(),void 0!==t)return n[r]=t,!0;if(n)return n[r]}return!1},n.setDictionary=function(t){document.dictionary||(document.dictionary={});for(var n=Object.keys(t),r=0;r<n.length;r++)document.dictionary[n[r]]=t[n[r]];var o=null;for(r=0;r<e.calendar.weekdays.length;r++)o=e.translate(e.calendar.weekdays[r]),e.calendar.weekdays[r]&&(e.calendar.weekdays[r]=o,e.calendar.weekdaysShort[r]=o.substr(0,3));for(r=0;r<e.calendar.months.length;r++)(o=e.translate(e.calendar.months[r]))&&(e.calendar.months[r]=o,e.calendar.monthsShort[r]=o.substr(0,3))},n.translate=function(e){return document.dictionary&&document.dictionary[e]||e},n.current=[],n}();"undefined"!=typeof document&&e.init(),e.ajax=function(t,n){if(Array.isArray(t)){var r={instance:[],complete:n};if(t.length>0)for(var o=0;o<t.length;o++)t[o].multiple=r,r.instance.push(e.ajax(t[o]));return r}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var i=function(e,t){var n=[],r=Object.keys(e);if(r.length)for(var o=0;o<r.length;o++){if(t)var a=t+"["+r[o]+"]";else a=r[o];if(e[a]instanceof FileList)n[a]=e[r[o]];else if("object"==typeof e[r[o]])for(var s=i(e[r[o]],a),l=Object.keys(s),u=0;u<l.length;u++)n[l[u]]=s[l[u]];else n[a]=e[r[o]]}return n},a=i(t.data),s=Object.keys(a);if("GET"==t.method){if(s.length){var l=[];for(o=0;o<s.length;o++)l.push(s[o]+"="+encodeURIComponent(a[s[o]]));t.url.indexOf("?")<0&&(t.url+="?"),t.url+=l.join("&")}}else for(l=new FormData,o=0;o<s.length;o++)if(a[s[o]]instanceof FileList){if(a[s[o]].length)for(var u=0;u<a[s[o]].length;u++)l.append(s[o],a[s[o]][u],a[s[o]][u].name)}else l.append(s[o],a[s[o]])}var c=new XMLHttpRequest;return c.open(t.method,t.url,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.contentType&&c.setRequestHeader("Content-Type",t.contentType),"POST"==t.method?c.setRequestHeader("Accept","application/json"):"blob"==t.dataType?c.responseType="blob":t.contentType||("json"==t.dataType?c.setRequestHeader("Content-Type","text/json"):"html"==t.dataType&&c.setRequestHeader("Content-Type","text/html")),1!=t.cache&&(c.setRequestHeader("pragma","no-cache"),c.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(c.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(c),"function"==typeof e.ajax.beforeSend&&e.ajax.beforeSend(c),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(c),c.onload=function(){if(200===c.status)if("json"==t.dataType)try{var n=JSON.parse(c.responseText);t.success&&"function"==typeof t.success&&t.success(n)}catch(e){t.error&&"function"==typeof t.error&&t.error(e,n)}else n="blob"==t.dataType?c.response:c.responseText,t.success&&"function"==typeof t.success&&t.success(n);else t.error&&"function"==typeof t.error&&t.error(c.responseText,c.status);if(e.ajax.queue&&e.ajax.queue.length>0&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var r=e.ajax.requests.indexOf(c);e.ajax.requests.splice(r,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(n),t.group&&e.ajax.oncomplete&&"function"==typeof e.ajax.oncomplete[t.group]&&(e.ajax.pending(t.group)||(e.ajax.oncomplete[t.group](),e.ajax.oncomplete[t.group]=null)),t.multiple&&t.multiple.instance&&(r=t.multiple.instance.indexOf(c),t.multiple.instance.splice(r,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(n))}},c.options=t,c.data=l,1==t.queue&&e.ajax.requests.length>0?e.ajax.queue.push(c):e.ajax.send(c),c},e.ajax.send=function(t){t.data?Array.isArray(t.data)?t.send(t.data.join("&")):t.send(t.data):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},e.ajax.pending=function(t){var n=0,r=e.ajax.requests;if(r&&r.length)for(var o=0;o<r.length;o++)t&&t!=r[o].options.group||n++;return n},e.ajax.oncomplete={},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){e.getWindowWidth()<800&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(e,t,n){1==t?(e.classList.add("slide-left-in"),setTimeout((function(){e.classList.remove("slide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-left-out"),setTimeout((function(){e.classList.remove("slide-left-out"),"function"==typeof n&&n()}),400))},e.animation.slideRight=function(e,t,n){1==t?(e.classList.add("slide-right-in"),setTimeout((function(){e.classList.remove("slide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-right-out"),setTimeout((function(){e.classList.remove("slide-right-out"),"function"==typeof n&&n()}),400))},e.animation.slideTop=function(e,t,n){1==t?(e.classList.add("slide-top-in"),setTimeout((function(){e.classList.remove("slide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-top-out"),setTimeout((function(){e.classList.remove("slide-top-out"),"function"==typeof n&&n()}),400))},e.animation.slideBottom=function(e,t,n){1==t?(e.classList.add("slide-bottom-in"),setTimeout((function(){e.classList.remove("slide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-bottom-out"),setTimeout((function(){e.classList.remove("slide-bottom-out"),"function"==typeof n&&n()}),100))},e.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout((function(){e.classList.remove("fade-in"),"function"==typeof t&&t()}),2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()}),1e3)},e.calendar=function(t,n){if(t.calendar)return t.calendar.setOptions(n,!0);var r={type:"calendar",options:{},date:null,setOptions:function(n,o){for(var i={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:e.calendar.monthsShort,monthsFull:e.calendar.months,weekdays:e.calendar.weekdays,weekdays_short:e.calendar.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},a=0;a<i.weekdays_short.length;a++)i.weekdays_short[a]=i.weekdays_short[a].substr(0,1);for(var s in i)n&&n.hasOwnProperty(s)?r.options[s]=n[s]:void 0!==r.options[s]&&!0!==o||(r.options[s]=i[s]);if(0==r.options.resetButton?l.style.display="none":l.style.display="",r.options.readonly?t.setAttribute("readonly","readonly"):t.removeAttribute("readonly"),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.removeAttribute("placeholder"),e.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=e.calendar.numToDate(r.options.value),r.options.dataType="numeric"),l.innerHTML=r.options.textReset,u.innerHTML=r.options.textDone,w.innerHTML=r.options.textUpdate,t.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var c=e.calendar.now();else c=r.options.value;return c&&(r.options.value=null,r.setValue(c)),r},open:function(n){if(!s.classList.contains("jcalendar-focus")&&!s.classList.contains("jcalendar-inline")){if(e.calendar.current=r,e.tracking(r,!0),r.getDays(),"year-month-picker"==r.options.type&&r.getMonths(),r.options.time&&(E.value=r.date[3],b.value=r.date[4]),s.classList.add("jcalendar-focus"),e.getWindowWidth()<800||r.options.fullscreen)s.classList.add("jcalendar-fullsize"),e.animation.slideBottom(f,1);else{s.classList.remove("jcalendar-fullsize");var o=t.getBoundingClientRect(),i=f.getBoundingClientRect();if(r.options.position)c.style.position="fixed",window.innerHeight<o.bottom+i.height?c.style.top=o.top-(i.height+2)+"px":c.style.top=o.top+o.height+2+"px",c.style.left=o.left+"px";else if(window.innerHeight<o.bottom+i.height?((a=-1*(o.height+i.height+2))+o.top<0&&(a=-1*(o.top+o.height)),c.style.top=a+"px"):c.style.top="2px",window.innerWidth<o.left+i.width){var a=window.innerWidth-(o.left+i.width+20);c.style.left=a+"px"}else c.style.left="0px"}"function"==typeof r.options.onopen&&r.options.onopen(t)}},close:function(n,o){if(s.classList.contains("jcalendar-focus")){if(!1!==o){var i=s.querySelector(".jcalendar-selected");if("string"==typeof o)var a=o;else a=!i||i.classList.contains("jcalendar-disabled")?r.options.value:r.getValue();r.setValue(a)}n||"function"!=typeof r.options.onclose||r.options.onclose(t),s.classList.remove("jcalendar-focus"),e.tracking(r,!1),e.calendar.current=null}return r.options.value},prev:function(){"years"==r.options.mode?(r.date[0]=r.date[0]-12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},next:function(){"years"==r.options.mode?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return r.setValue(e),e},setValue:function(e){e||(e=""+e);var n=e,o=r.options.value;if(o!=n){if(n){r.setLabel(n,r.options),(a=n.split(" "))[1]||(a[1]="00:00:00");var i=a[1].split(":"),a=a[0].split("-"),s=parseInt(a[0]),l=parseInt(a[1]),u=parseInt(a[2]),c=parseInt(i[0]),f=parseInt(i[1]);r.date=[s,l,u,c,f,0],e=r.setLabel(n,r.options)}else{r.date=null;e=""}r.options.value=n,"function"==typeof r.options.onchange&&r.options.onchange(t,n,o),t.value!=e&&(t.value=e,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))}r.getDays()},getValue:function(){return r.date?r.options.time?e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(r.date[3])+":"+e.two(r.date[4])+":"+e.two(0):e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=s.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(r.date[1]=t,r.date[2]=1):r.date[2]=e.innerText,r.options.time?(r.date[3]=E.value,r.date[4]=b.value):r.close()}a()},reset:function(){r.setValue(""),r.date=null,r.close(!1,!1)},getDays:function(){r.options.mode="days";var t=new Date,n=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear()),o=r.date&&e.isNumeric(r.date[1])?r.date[1]:parseInt(t.getMonth())+1,i=r.date&&e.isNumeric(r.date[2])?r.date[2]:parseInt(t.getDate()),s=r.date&&e.isNumeric(r.date[3])?r.date[3]:parseInt(t.getHours()),l=r.date&&e.isNumeric(r.date[4])?r.date[4]:parseInt(t.getMinutes());r.date=[n,o,i,s,l,0],d.innerHTML=n,p.innerHTML=r.options.months[o-1];var u=t.getMonth()==o-1&&t.getFullYear()==n,c=t.getDate(),f=(t=new Date(n,o,0,0,0)).getDate(),h=(t=new Date(n,o-1,0,0,0)).getDay()+1;h-=y=r.options.startingDay||0,g.innerHTML="",(b=document.createElement("tr")).setAttribute("align","center"),g.appendChild(b);for(var m=0;m<7;m++)(M=document.createElement("td")).classList.add("jcalendar-weekday"),M.innerHTML=r.options.weekdays_short[y],b.appendChild(M),++y>6&&(y=0);for(var y=0,w=0,E=0;E<6;E++){var b;(b=document.createElement("tr")).setAttribute("align","center");var x=!0;for(m=0;m<7;m++){var M;if((M=document.createElement("td")).classList.add("jcalendar-set-day"),y>=h&&y<h+f){w++,M.innerHTML=w,w==i&&M.classList.add("jcalendar-selected"),u&&c==w&&(M.style.fontWeight="bold");var T=e.calendar.now(new Date(n,o-1,w),!0);if(r.options.validRange){if(!r.options.validRange[0]||T>=r.options.validRange[0])var A=!0;else A=!1;if(!r.options.validRange[1]||T<=r.options.validRange[1])var N=!0;else N=!1;A&&N||M.classList.add("jcalendar-disabled")}x=!1}b.appendChild(M),y++}0==x&&g.appendChild(b)}r.options.time?v.style.display="":v.style.display="none",a()},getMonths:function(){r.options.mode="months";var t=r.options.months,n=(r.options.value,new Date),o=parseInt(n.getFullYear()),i=parseInt(n.getMonth())+1,s=r.date&&e.isNumeric(r.date[0])?r.date[0]:o,l=r.date&&e.isNumeric(r.date[1])?r.date[1]:i;d.innerHTML=r.date[0],p.innerHTML=t[l-1];var u=document.createElement("table");u.setAttribute("width","100%");for(var c=null,f=0;f<12;f++){f%4||((c=document.createElement("tr")).setAttribute("align","center"),u.appendChild(c));var h=document.createElement("td");if(h.classList.add("jcalendar-set-month"),h.setAttribute("data-value",f+1),h.innerText=t[f],r.options.validRange){var m=s+"-"+e.two(f+1);if(!r.options.validRange[0]||m>=r.options.validRange[0].substr(0,7))var v=!0;else v=!1;if(!r.options.validRange[1]||m<=r.options.validRange[1].substr(0,7))var y=!0;else y=!1;v&&y||h.classList.add("jcalendar-disabled")}f+1==l&&h.classList.add("jcalendar-selected"),o==s&&f+1==i&&(h.style.fontWeight="bold"),c.appendChild(h)}g.innerHTML='<tr><td colspan="7"></td></tr>',g.children[0].children[0].appendChild(u),a()},getYears:function(){r.options.mode="years";for(var t=new Date,n=t.getFullYear(),o=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear()),i=[],s=0;s<25;s++)i[s]=parseInt(r.date[0])+(s-12);var l=document.createElement("table");for(l.setAttribute("width","100%"),s=0;s<25;s++){if(!(s%5)){var u=document.createElement("tr");u.setAttribute("align","center"),l.appendChild(u)}var c=document.createElement("td");c.classList.add("jcalendar-set-year"),c.innerText=i[s],o==i[s]&&c.classList.add("jcalendar-selected"),n==i[s]&&(c.style.fontWeight="bold"),u.appendChild(c)}g.innerHTML='<tr><td colspan="7"></td></tr>',g.firstChild.firstChild.appendChild(l),a()},setLabel:function(t,n){return e.calendar.getDateString(t,n)},fromFormatted:function(t,n){return e.calendar.extractDateFromString(t,n)}},o=function(t){if(e.findElement(t.target,"jcalendar-container")){var n=t.target.className;if("jcalendar-prev"==n)r.prev();else if("jcalendar-next"==n)r.next();else if("jcalendar-month"==n)r.getMonths();else if("jcalendar-year"==n)r.getYears();else if("jcalendar-set-year"==n)r.date[0]=t.target.innerText,"year-month-picker"==r.options.type?r.getMonths():r.getDays();else if(t.target.classList.contains("jcalendar-set-month")){var o=parseInt(t.target.getAttribute("data-value"));"year-month-picker"==r.options.type?r.update(t.target,o):(r.date[1]=o,r.getDays())}else"jcalendar-confirm"==n||"jcalendar-update"==n||"jcalendar-close"==n?r.close():"jcalendar-backdrop"==n?r.close(!1,!1):"jcalendar-reset"==n?r.reset():t.target.classList.contains("jcalendar-set-day")&&t.target.innerText&&r.update(t.target)}else r.close()},i=function(t){if(t.target.value&&t.target.value.length>3){var n=e.calendar.extractDateFromString(t.target.value,r.options.format);n&&r.setValue(n)}},a=function(){var e=s.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(w.setAttribute("disabled","disabled"),E.setAttribute("disabled","disabled"),b.setAttribute("disabled","disabled")):(w.removeAttribute("disabled"),E.removeAttribute("disabled"),b.removeAttribute("disabled")),"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},s=null,l=null,u=null,c=null,f=null,d=null,p=null,h=null,g=null,m=null,v=null,y=null,w=null,E=null,b=null;return function(){"INPUT"==t.tagName&&t.value&&(n.value=t.value),(l=document.createElement("div")).className="jcalendar-reset",(u=document.createElement("div")).className="jcalendar-confirm",(m=document.createElement("div")).className="jcalendar-controls",m.style.borderBottom="1px solid #ddd",m.appendChild(l),m.appendChild(u),(c=document.createElement("div")).className="jcalendar-container",(f=document.createElement("div")).className="jcalendar-content",c.appendChild(f),"DIV"==t.tagName?(s=t).classList.add("jcalendar-inline"):(f.appendChild(m),(s=document.createElement("div")).className="jcalendar"),s.classList.add("jcalendar-container"),s.appendChild(c);var a=document.createElement("div");a.className="jcalendar-table",f.appendChild(a);var x=document.createElement("td");x.setAttribute("colspan","2"),x.className="jcalendar-prev",(d=document.createElement("span")).className="jcalendar-year",(p=document.createElement("span")).className="jcalendar-month";var M=document.createElement("td");M.className="jcalendar-header",M.setAttribute("colspan","3"),M.appendChild(p),M.appendChild(d);var T=document.createElement("td");T.setAttribute("colspan","2"),T.className="jcalendar-next";var A=document.createElement("thead"),N=document.createElement("tr");N.appendChild(x),N.appendChild(M),N.appendChild(T),A.appendChild(N),h=document.createElement("table"),g=document.createElement("tbody"),h.setAttribute("cellpadding","0"),h.setAttribute("cellspacing","0"),h.appendChild(A),h.appendChild(g),a.appendChild(h),(E=document.createElement("select")).className="jcalendar-select",E.onchange=function(){r.date[3]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())};for(var L=0;L<24;L++)(C=document.createElement("option")).value=L,C.innerHTML=e.two(L),E.appendChild(C);for((b=document.createElement("select")).className="jcalendar-select",b.onchange=function(){r.date[4]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},L=0;L<60;L++){var C;(C=document.createElement("option")).value=L,C.innerHTML=e.two(L),b.appendChild(C)}var I=document.createElement("div");I.className="jcalendar-controls",(v=document.createElement("div")).className="jcalendar-time",v.style.maxWidth="140px",v.appendChild(E),v.appendChild(b),(w=document.createElement("button")).setAttribute("type","button"),w.className="jcalendar-update",(y=document.createElement("div")).style.flexGrow="10",y.appendChild(w),I.appendChild(v),"INPUT"==t.tagName&&I.appendChild(y),f.appendChild(I);var S=document.createElement("div");S.className="jcalendar-backdrop",s.appendChild(S),t.addEventListener("keyup",i),s.addEventListener("swipeleft",(function(t){e.animation.slideLeft(h,0,(function(){r.next(),e.animation.slideRight(h,1)})),t.preventDefault(),t.stopPropagation()})),s.addEventListener("swiperight",(function(t){e.animation.slideRight(h,0,(function(){r.prev(),e.animation.slideLeft(h,1)})),t.preventDefault(),t.stopPropagation()})),t.onmouseup=function(){r.open()},"ontouchend"in document.documentElement==1?s.addEventListener("touchend",o):s.addEventListener("mouseup",o),e.calendar.hasEvents||(e.calendar.hasEvents=!0,document.addEventListener("keydown",e.calendar.keydown)),r.setOptions(n),"INPUT"==t.tagName?(t.parentNode.insertBefore(s,t.nextSibling),t.setAttribute("autocomplete","off"),t.classList.add("jcalendar-input"),t.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(E.value=r.date[3],b.value=r.date[4])),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.calendar=s.calendar=r}(),r},e.calendar.keydown=function(t){var n=null;(n=e.calendar.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.calendar.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var n=new Date,r=new Date(e),o=parseInt((n-r)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==o)var i=t.justNow;else i=o<90?t.xMinutesAgo.format(o):o<1440?t.xHoursAgo.format(Math.round(o/60)):o<20160?t.xDaysAgo.format(Math.round(o/1440)):o<43200?t.xWeeksAgo.format(Math.round(o/10080)):o<1036800?t.xMonthsAgo.format(Math.round(o/43200)):t.xYearsAgo.format(Math.round(o/525600));return i},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.calendar.prettify(t[n].getAttribute("data-date")):t[n].innerHTML&&(t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.calendar.prettify(t[n].innerHTML))},e.calendar.now=function(t,n){if(Array.isArray(t))var r=t[0],o=t[1],i=t[2],a=t[3],s=t[4],l=t[5];else t||(t=new Date),r=t.getFullYear(),o=t.getMonth()+1,i=t.getDate(),a=t.getHours(),s=t.getMinutes(),l=t.getSeconds();return 1==n?e.two(r)+"-"+e.two(o)+"-"+e.two(i):e.two(r)+"-"+e.two(o)+"-"+e.two(i)+" "+e.two(a)+":"+e.two(s)+":"+e.two(l)},e.calendar.toArray=function(e){var t=(n=e.split(-1!==e.indexOf("T")?"T":" "))[1],n=n[0].split("-"),r=parseInt(n[0]),o=parseInt(n[1]),i=parseInt(n[2]);if(t){t=t.split(":");var a=parseInt(t[0]),s=parseInt(t[1])}else a=0,s=0;return[r,o,i,a,s,0]},e.calendar.extractDateFromString=function(t,n){if(t>0&&Number(t)==t){var r=new Date(Math.round(86400*(t-25569)*1e3));return r.getFullYear()+"-"+e.two(r.getMonth())+"-"+e.two(r.getDate())+" 00:00:00"}var o=e.mask(t,{mask:n},!0);return o.date[0]&&o.date[1]?(o.date[2]||(o.date[2]=1),o.date[0]+"-"+e.two(o.date[1])+"-"+e.two(o.date[2])+" "+e.two(o.date[3])+":"+e.two(o.date[4])+":"+e.two(o.date[5])):""};var t,n,r=Date.UTC(1900,0,0),o=Date.UTC(1900,1,29),i=864e5;return e.calendar.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=o&&(t+=i),(t-=r)/i},e.calendar.numToDate=function(t){var n=r+t*i;n>=o&&(n-=i);const a=new Date(n);var s=[a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()];return e.calendar.now(s)},e.calendar.getDateString=function(t,n){if(n||(n={}),n&&"object"==typeof n)var r=n.format;else r=n;if(r||(r="YYYY-MM-DD"),"number"==typeof t&&r.indexOf("[h]")>=0){var o=parseFloat(24*Number(t));if(r.indexOf("mm")>=0){if((f=(""+o).split("."))[1]){var i=60*parseFloat("0."+f[1]);i=parseFloat(i.toFixed(2))}else i=0;o=parseInt(f[0])+":"+e.two(i)}return o}t instanceof Date?t=e.calendar.now(t):t&&e.isNumeric(t)&&(t=e.calendar.numToDate(t));for(var a=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),s=r.match(a),l=0;l<s.length;l++)"MM"==s[l].toUpperCase()&&(s[l-1]&&s[l-1].toUpperCase().indexOf("H")>=0||s[l-2]&&s[l-2].toUpperCase().indexOf("H")>=0||s[l+1]&&s[l+1].toUpperCase().indexOf("S")>=0||s[l+2]&&s[l+2].toUpperCase().indexOf("S")>=0)&&(s[l]="mi");var u={tokens:s};if(t){var c=-1!==(i=""+t).indexOf("T")?"T":" ",f=0,d=0,p=0;if((i=i.split(c))[1]&&(d=(f=i[1].split(":"))[1]?f[1]:0,p=f[2]?f[2]:0,f=f[0]?f[0]:0),(i=i[0].split("-"))[0]&&i[1]&&i[2]&&i[0]>0&&i[1]>0&&i[1]<13&&i[2]>0&&i[2]<32){u.data=[i[0],i[1],i[2],f,d,p],u.value=[];var h=new Date(u.data[0],u.data[1]-1,u.data[2],u.data[3],u.data[4],u.data[5]),g=function(t){var n=this.tokens[t],r=n.toUpperCase(),o=null;"YYYY"===r?o=this.data[0]:"YYY"===r?o=this.data[0].substring(1,4):"YY"===r?o=this.data[0].substring(2,4):"Y"===r?o=this.data[0].substring(3,4):"MON"===n?o=e.calendar.months[h.getMonth()].substr(0,3).toUpperCase():"mon"===n?o=e.calendar.months[h.getMonth()].substr(0,3).toLowerCase():"MONTH"===n?o=e.calendar.months[h.getMonth()].toUpperCase():"month"===n?o=e.calendar.months[h.getMonth()].toLowerCase():"MMMMM"===r?o=e.calendar.months[h.getMonth()].substr(0,1):"MMMM"===r||"Month"===n?o=e.calendar.months[h.getMonth()]:"MMM"===r||"Mon"==n?o=e.calendar.months[h.getMonth()].substr(0,3):"MM"===r?o=e.two(this.data[1]):"M"===r?o=h.getMonth()+1:"DAY"===n?o=e.calendar.weekdays[h.getDay()].toUpperCase():"day"===n?o=e.calendar.weekdays[h.getDay()].toLowerCase():"DDDD"===r||"Day"==n?o=e.calendar.weekdays[h.getDay()]:"DDD"===r?o=e.calendar.weekdays[h.getDay()].substr(0,3):"DD"===r?o=e.two(this.data[2]):"D"===r?o=this.data[2]:"Q"===r?o=Math.floor((h.getMonth()+3)/3):"HH24"===r||"HH"===r?o=e.two(this.data[3]):"HH12"===r?o=this.data[3]>12?e.two(this.data[3]-12):e.two(this.data[3]):"H"===r?o=this.data[3]:"MI"===r?o=e.two(this.data[4]):"SS"===r?o=e.two(this.data[5]):"MS"===r?o=h.getMilliseconds():"AM/PM"===r?o=this.data[3]>=12?"PM":"AM":"WD"===r&&(o=e.calendar.weekdays[h.getDay()]),this.value[t]=null===o?this.tokens[t]:o};for(l=0;l<u.tokens.length;l++)g.call(u,l);t=u.value.join("")}else t=""}return t},e.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],e.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.color=function(t,n){if(t.color)return t.color.setOptions(n,!0);var r={type:"color",options:{}},o=null,i=null,a=null,s=null,l=null,u=null,c=null;r.setOptions=function(n,o){var i={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var a in n||(n={}),n&&!n.palette&&(n.palette=e.palette()),i)n&&n.hasOwnProperty(a)?r.options[a]=n[a]:void 0!==r.options[a]&&!0!==o||(r.options[a]=i[a]);return s&&(s.innerHTML=r.options.resetLabel),l&&(l.innerHTML=r.options.doneLabel),r.options.palette&&c&&c.updateContent(0,g()),"string"==typeof r.options.value&&(t.value=r.options.value,"INPUT"===t.tagName&&(t.style.color=t.value,t.style.backgroundColor=t.value)),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.getAttribute("placeholder")&&t.removeAttribute("placeholder"),r},r.select=function(e){var t=o.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),r.values[e]&&r.values[e].classList.add("jcolor-selected")},r.open=function(){if(!o.classList.contains("jcolor-focus")){e.tracking(r,!0),o.classList.add("jcolor-focus"),r.options.value&&r.select(r.options.value),a.style.marginTop="",a.style.marginLeft="";var n=a.getBoundingClientRect(),s=e.getWindowWidth(),l=e.getWindowHeight();if(s<800||1==r.options.fullscreen?(a.classList.add("jcolor-fullscreen"),e.animation.slideBottom(a,1),i.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),i.style.display=""),r.options.position?a.style.position="fixed":a.style.position="",n.left+n.width>s&&(a.style.marginLeft=-1*(n.left+n.width-(s-20))+"px"),n.top+n.height>l&&(a.style.marginTop=-1*(n.top+n.height-(l-20))+"px")),"function"==typeof r.options.onopen&&r.options.onopen(t),c.setBorder(c.getActive()),r.options.value){var u=h(r.options.value);x.forEach((function(e,t){e.value=u[t],e.dispatchEvent(new Event("input"))}))}}},r.close=function(n){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),i.style.display="",n||"function"!=typeof r.options.onclose||r.options.onclose(t),e.tracking(r,!1)),r.options.value},r.setValue=function(e){e||(e=""),e!=r.options.value&&(r.options.value=e,b=e,r.select(e),"function"==typeof r.options.onchange&&r.options.onchange(t,e),t.value!=r.options.value&&(t.value=r.options.value,"INPUT"===t.tagName&&(t.style.color=t.value,t.style.backgroundColor=t.value),"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),1==r.options.closeOnChange&&r.close())},r.getValue=function(){return r.options.value};var f=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},d=function(e,t,n){return"#"+f(e)+f(t)+f(n)},p=function(e){return parseInt("0x"+e)},h=function(e){return[p(e.substr(1,2)),p(e.substr(3,2)),p(e.substr(5,2))]},g=function(){var e=document.createElement("div");e.className="jcolor-grid",r.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<r.options.palette.length;n++){for(var o=document.createElement("tr"),i=0;i<r.options.palette[n].length;i++){var a=document.createElement("td"),s=r.options.palette[n][i];s.length<7&&"#"!==s.substr(0,1)&&(s="#"+s),a.style.backgroundColor=s,a.setAttribute("data-value",s),a.innerHTML="",o.appendChild(a),r.options.value==s&&a.classList.add("jcolor-selected"),r.values[s]=a}t.appendChild(o)}return e.appendChild(t),e},m=document.createElement("canvas");m.width=200,m.height=160;var v=m.getContext("2d"),y=function(){var e=u.firstChild.getBoundingClientRect();m.width=e.width-14,w()},w=function(){var e=v.createLinearGradient(0,0,m.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),v.fillStyle=e,v.fillRect(0,0,m.width,m.height),(e=v.createLinearGradient(0,0,0,m.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),v.fillStyle=e,v.fillRect(0,0,m.width,m.height)},E=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(m),n.appendChild(t),e.appendChild(n);var r=function(n,r,o){if(1===n){var i=e.getBoundingClientRect(),a=r-i.left,s=o-i.top;a<0&&(a=0),s<0&&(s=0),a>i.width&&(a=i.width),s>i.height&&(s=i.height),t.style.left=a+"px",t.style.top=s+"px";var l=v.getImageData(a,s,1,1).data;b=d(l[0],l[1],l[2])}};return e.addEventListener("mousedown",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){r(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},b="",x=[],M=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var r=document.createElement("label");r.innerText=e;var o=document.createElement("div");o.className="jcolor-sliders-input-subcontainer";var i=document.createElement("input");i.type="range",i.min=0,i.max=255,i.value=0,n.appendChild(r),o.appendChild(i);var a=document.createElement("div");return a.innerText=i.value,i.addEventListener("input",(function(){a.innerText=i.value})),o.appendChild(a),n.appendChild(o),t.appendChild(n),i};x=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var r=document.createElement("div");r.className="jcolor-sliders-final-color";var o=document.createElement("div");o.style.visibility="hidden",o.innerText="a",r.appendChild(o);return x.forEach((function(e){e.addEventListener("input",(function(){var e;e=d(parseInt(x[0].value),parseInt(x[1].value),parseInt(x[2].value)),o.innerText=e,o.style.color=e,o.style.removeProperty("visibility"),b=e,function(){if(""!==b)for(var e=0;e<x.length;e++){var t=h(b);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",x[e].style.backgroundImage=n}}()}))})),e.appendChild(r),e};return r.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};return/^#[0-9A-F]{6}$/i.test(e)?e:"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])},function(){r.setOptions(n),"INPUT"==t.tagName&&(t.classList.add("jcolor-input"),t.readOnly=!0),(o=document.createElement("div")).className="jcolor",(i=document.createElement("div")).className="jcolor-backdrop",o.appendChild(i),(a=document.createElement("div")).className="jcolor-content";var f=document.createElement("div");f.className="jcolor-controls",a.appendChild(f),(s=document.createElement("div")).className="jcolor-reset",s.innerHTML=r.options.resetLabel,f.appendChild(s),(l=document.createElement("div")).className="jcolor-close",l.innerHTML=r.options.doneLabel,f.appendChild(l),u=document.createElement("div"),a.appendChild(u),c=e.tabs(u,{animation:!0,data:[{title:"Grid",contentElement:g()},{title:"Spectrum",contentElement:E()},{title:"Sliders",contentElement:M()}],onchange:function(e,t,n){if(1===n)y();else{var o=""!==b?b:r.getValue();if(2===n&&o){var i=h(o);x.forEach((function(e,t){e.value=i[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),o.appendChild(a),"INPUT"==t.tagName?t.parentNode.insertBefore(o,t.nextSibling):t.appendChild(o),o.addEventListener("click",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&r.setValue(t)}else e.target.classList.contains("jcolor-reset")?(r.setValue(""),r.close()):e.target.classList.contains("jcolor-close")?(c.getActive()>0&&r.setValue(b),r.close()):e.target.classList.contains("jcolor-backdrop")?r.close():r.open()})),t.addEventListener("mouseup",(function(e){r.open()})),window.addEventListener("resize",(function(){o.classList.contains("jcolor-focus")&&1==c.getActive()&&y()})),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.color=r,o.color=r}(),r},e.contextmenu=function(t,n){var r={type:"contextmenu",options:{}},o={items:null,onclick:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];function a(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){u=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&u.setAttribute("title",e.tooltip),e.icon&&u.setAttribute("data-icon",e.icon),e.id&&(u.id=e.id),e.disabled?u.className="jcontextmenu-disabled":e.onclick&&(u.method=e.onclick,u.addEventListener("mousedown",(function(e){e.preventDefault()})),u.addEventListener("mouseup",(function(e){this.method(this,e)}))),u.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",u.appendChild(n),u.classList.add("jcontexthassubmenu");var r=document.createElement("div");r.classList.add("jcontextmenu"),r.setAttribute("tabindex","900");for(var o=e.submenu,i=0;i<o.length;i++){var s=a(o[i]);r.appendChild(s)}u.appendChild(r)}else if(e.shortcut){var l=document.createElement("span");l.innerHTML=e.shortcut,u.appendChild(l)}}else var u=document.createElement("hr");return u}return t.classList.add("jcontextmenu"),r.open=function(n,o){if(o&&(r.options.items=o,r.create(o)),e.contextmenu.current&&e.contextmenu.current.close(),e.tracking(r,!0),t.classList.add("jcontextmenu-focus"),e.contextmenu.current=r,r.options.items&&r.options.items.length>0||t.children.length){if(n.target)if(n.changedTouches&&n.changedTouches[0])i=n.changedTouches[0].clientX,a=n.changedTouches[0].clientY;else var i=n.clientX,a=n.clientY;else i=n.x,a=n.y;var s=t.getBoundingClientRect();if(window.innerHeight<a+s.height){var l=a-s.height;l<0&&(l=0),t.style.top=l+"px"}else t.style.top=a+"px";window.innerWidth<i+s.width?i-s.width>0?t.style.left=i-s.width+"px":t.style.left="10px":t.style.left=i+"px"}},r.isOpened=function(){return!!t.classList.contains("jcontextmenu-focus")},r.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus"),e.tracking(r,!1)},r.create=function(n){t.innerHTML="";var o=function(){var t=document.createElement("div");t.classList.add("header"),t.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var n=document.createElement("a");n.classList.add("title"),n.innerHTML=e.translate("Menu"),t.appendChild(n);var o=document.createElement("a");return o.classList.add("close"),o.innerHTML=e.translate("close"),o.addEventListener("click",(function(e){r.close()})),t.appendChild(o),t}();t.appendChild(o);for(var i=0;i<n.length;i++){var s=a(n[i]);t.appendChild(s)}},"function"==typeof r.options.onclick&&t.addEventListener("click",(function(e){r.options.onclick(r,e)})),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",(function(){r.close()})),t.contextmenu=r,r},e.dropdown=function(t,n){if(t.dropdown)return t.dropdown.setOptions(n,!0);var r={type:"dropdown",options:{}},o=function(e,n){e&&e.length&&(!1!==r.options.sortResults&&("function"==typeof r.options.sortResults?e.sort(r.options.sortResults):e.sort(i)),r.setData(e)),"function"==typeof r.options.onload&&r.options.onload(t,r,e,n),n&&s(n),null==n&&(r.options.value=""),t.value=r.options.value,1==r.options.opened&&r.open()},i=function(e,t){var n,r;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?r=t:t.text?r=t.text:t.name&&(r=t.name),"string"==typeof n||"string"==typeof r?("string"!=typeof n&&(n=""+n),"string"!=typeof r&&(r=""+r),n.localeCompare(r)):n-r},a=function(){r.value={};for(var e=0;e<r.items.length;e++)1==r.items[e].selected&&(r.items[e].element&&r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=null);r.options.value=""},s=function(e){if(a(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)r.value[e[t]]=""}else void 0!==r.value[""]&&(r.value[""]="");for(t=0;t<r.items.length;t++)void 0!==r.value[l(t)]&&(r.items[t].element&&r.items[t].element.classList.add("jdropdown-selected"),r.items[t].selected=!0,r.value[l(t)]=u(t));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},l=function(e,t){if(r.options.format)n="id";else var n="value";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},u=function(e,t){if(r.options.format)n="name";else var n="text";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},c=function(){return Object.keys(r.value)},f=function(){for(var e=[],t=Object.keys(r.value),n=0;n<t.length;n++)e.push(r.value[t[n]]);return e};r.setOptions=function(n,i){n||(n={});var a={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(var s in a)n&&n.hasOwnProperty(s)?r.options[s]=n[s]:void 0!==r.options[s]&&!0!==i||(r.options[s]=a[s]);return 1!=r.options.remoteSearch&&"searchbar"!==r.options.type||(r.options.autocomplete=!0),1==r.options.newOptions?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),1==r.options.autocomplete?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),t.classList.remove("jdropdown-searchbar"),t.classList.remove("jdropdown-picker"),t.classList.remove("jdropdown-list"),"searchbar"==r.options.type?t.classList.add("jdropdown-searchbar"):"list"==r.options.type?t.classList.add("jdropdown-list"):"picker"==r.options.type?t.classList.add("jdropdown-picker"):e.getWindowWidth()<800?r.options.autocomplete?(t.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(t.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(t.style.width=r.options.width,t.style.minWidth=r.options.width):(t.style.removeProperty("width"),t.style.removeProperty("min-width")),t.classList.add("jdropdown-default"),r.options.type="default"),"searchbar"==r.options.type?d.appendChild(g):p.insertBefore(g,p.firstChild),r.options.url&&!n.data?e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){e&&o(e,r.options.value)}}):o(r.options.data,r.options.value),r};var d=null,p=null,h=null,g=null,m=null,v=null,y=null;r.getUrl=function(){return r.options.url},r.setUrl=function(t,n){r.options.url=t,e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){r.setData(e),"function"==typeof n&&n(r)}})},r.setId=function(e,t){if(r.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:r.items[e].data[n]=t},r.add=function(t,n){if(!t){var o=1==r.options.autocomplete?r.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),o)))return!1}if(n||(n=e.guid()),r.options.format)i={id:n,name:t};else var i={value:n,text:t};if("function"==typeof r.options.onbeforeinsert){var a=r.options.onbeforeinsert(r,i);if(!1===a)return!1;a&&(i=a)}r.options.data.push(i);var s=r.createItem(i);return h.appendChild(s.element),"function"==typeof r.options.oninsert&&r.options.oninsert(r,i,s),"none"==h.style.display&&(h.style.display=""),r.results&&r.results.push(s),i},r.createItem=function(e,t,n){r.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var o={};if(o.element=document.createElement("div"),o.element.className="jdropdown-item",o.element.indexValue=r.items.length,o.data=e,t&&(o.group=t),e.id&&o.element.setAttribute("id",e.id),1==e.disabled&&o.element.setAttribute("data-disabled",!0),e.tooltip&&o.element.setAttribute("title",e.tooltip),e.image){var i=document.createElement("img");i.className="jdropdown-image",i.src=e.image,e.title||i.classList.add("jdropdown-image-small"),o.element.appendChild(i)}else if(e.icon){var a=document.createElement("span");a.className="jdropdown-icon material-icons",a.innerText=e.icon,e.title||a.classList.add("jdropdown-icon-small"),e.color&&(a.style.color=e.color),o.element.appendChild(a)}else if(e.color){var s=document.createElement("div");s.className="jdropdown-color",s.style.backgroundColor=e.color,o.element.appendChild(s)}if(r.options.format)l=e.name;else var l=e.text;var u=document.createElement("div");if(u.className="jdropdown-description",u.innerHTML=l||"&nbsp;",e.title){var c=document.createElement("div");c.className="jdropdown-title",c.innerText=e.title,u.appendChild(c)}if(r.options.format)f=e.id;else var f=e.value;return r.value[f]&&(o.element.classList.add("jdropdown-selected"),o.selected=!0),r.items.push(o),o.element.appendChild(u),o},r.appendData=function(e){if(e.length){for(var t=[],n=[],o=0;o<e.length;o++)e[o].group?(n[e[o].group]||(n[e[o].group]=[]),n[e[o].group].push(o)):t.push(o);var i=0,a=Object.keys(n);if(a.length>0)for(o=0;o<a.length;o++){var s=document.createElement("div");s.className="jdropdown-group";var l=document.createElement("div");l.className="jdropdown-group-name",l.innerHTML=a[o];var u=document.createElement("i");u.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(u);var c=document.createElement("div");c.className="jdropdown-group-items";for(var f=0;f<n[a[o]].length;f++){var d=r.createItem(e[n[a[o]][f]],s,a[o]);(0==r.options.lazyLoading||i<200)&&(c.appendChild(d.element),i++)}s.appendChild(l),s.appendChild(c),r.groups.push(s),c.children.length>0&&h.appendChild(s)}if(t.length)for(o=0;o<t.length;o++)d=r.createItem(e[t[o]]),(0==r.options.lazyLoading||i<200)&&(h.appendChild(d.element),i++)}},r.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(r.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});a(),h.innerHTML="",r.header.value="",r.items=[],r.appendData(e),r.options.data=e}},r.getData=function(){return r.options.data},r.getPosition=function(e){for(var t=0;t<r.items.length;t++)if(l(t)==e)return t;return!1},r.getText=function(e){var t=f();return e?t:t.join("; ")},r.getValue=function(e){var t=c();return e?t:t.join(";")};var w=function(e){t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),"function"==typeof r.options.onchange&&r.options.onchange(t,r,e,r.options.value)};r.setValue=function(e){var t=r.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(s(e),w(t))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(e,t){if(e=parseInt(e),r.items&&r.items[e]&&(!0===t||!0!==r.items[e].data.disabled))if(r.setCursor(e,!1),r.options.multiple){var n=r.options.value;r.items[e].selected?(r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=!1,delete r.value[l(e)]):(r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[l(e)]=u(e)),r.options.value=Object.keys(r.value).join(";"),0==r.options.autocomplete&&(r.header.value=f().join("; ")),w(n)}else r.items[e].selected?r.setValue(null):r.setValue(l(e)),r.close()},r.selectItem=function(e){r.selectIndex(e.indexValue)};var E=function(e,t){for(var n=0;n<t.length;n++)if(r.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return r.find=function(t){if(r.search==t.trim())return!1;if(r.search=t,r.setCursor(),r.groups.length)for(var n=0;n<r.groups.length;n++)r.groups[n].lastChild.innerHTML="";if(h.innerHTML="",1==r.options.remoteSearch){r.results=null;var o=r.options.url+(r.options.url.indexOf("?")>0?"&":"?")+"q="+t;e.ajax({url:o,method:"GET",dataType:"json",success:function(e){r.items=[];var t=Object.keys(r.value);if(t.length)for(var n=0;n<t.length;n++)E(t[n],e)||(r.options.format?e.unshift({id:t[n],name:r.value[t[n]]}):e.unshift({value:t[n],text:r.value[t[n]]}));r.appendData(e),e.length?h.style.display="":h.style.display="none"}})}else{t=new RegExp(t,"gi");var i=[];for(n=0;n<r.items.length;n++){var a=u(n),s=r.items[n].data.title||"",l=r.items[n].data.group||"",c=r.items[n].data.synonym||"";c&&(c=c.join(" ")),(null==t||1==r.items[n].selected||a.match(t)||s.match(t)||l.match(t)||c.match(t))&&i.push(r.items[n])}if(i.length){h.style.display="",r.results=i;var f=i.length||0;for(1==r.options.lazyLoading&&f>200&&(f=200),n=0;n<f;n++)r.results[n].group?(r.results[n].group.parentNode||h.appendChild(r.results[n].group),r.results[n].group.lastChild.appendChild(r.results[n].element)):h.appendChild(r.results[n].element)}else h.style.display="none",r.results=null}1==r.options.autofocus&&r.first()},r.open=function(){if(!t.classList.contains("jdropdown-focus")){e.dropdown.current=r,e.tracking(r,!0),t.classList.add("jdropdown-focus"),e.getWindowWidth()<800&&(null!=r.options.type&&"picker"!=r.options.type||e.animation.slideBottom(p,1)),1==r.options.autocomplete&&(r.header.value=r.search,r.header.focus());var n=c();if(n[0]){var o=r.getPosition(n[0]);!1!==o&&r.setCursor(o)}if(!r.options.type||"default"==r.options.type){var i=t.getBoundingClientRect(),a=p.getBoundingClientRect();r.options.position?(p.style.position="fixed",window.innerHeight<i.bottom+a.height?(p.style.top="",p.style.bottom=window.innerHeight-i.top+1+"px"):(p.style.top=i.bottom+"px",p.style.bottom=""),p.style.left=i.left+"px"):window.innerHeight<i.bottom+a.height?(p.style.top="",p.style.bottom=i.height+1+"px"):(p.style.top="",p.style.bottom=""),p.style.minWidth=i.width+"px",r.options.maxWidth&&(p.style.maxWidth=r.options.maxWidth),r.items.length||1!=r.options.autocomplete?h.style.display="":h.style.display="none"}}"function"==typeof r.options.onopen&&r.options.onopen(t)},r.close=function(n){return t.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),n||"function"!=typeof r.options.onclose||r.options.onclose(t),r.header.blur&&r.header.blur(),t.classList.remove("jdropdown-focus"),e.tracking(r,!1),e.dropdown.current=null),r.getValue()},r.setCursor=function(e,t){if(null!=r.currentIndex&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)r.currentIndex=null;else if(e=parseInt(e),r.items[e].element.parentNode&&(r.items[e].element.classList.add("jdropdown-cursor"),r.currentIndex=e,!1!==t&&r.items[r.currentIndex].element)){h.scrollTop;var n=r.items[r.currentIndex].element;h.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){!0===r.options.lazyLoading&&r.loadFirst();var e=h.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;r.setCursor(t)}},r.last=function(){!0===r.options.lazyLoading&&r.loadLast();var e=h.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;r.setCursor(t)}},r.next=function(e){var t=null;if(e){if(1==e.length){var n=r.currentIndex||-1;e=e.toLowerCase();var o=null,i=null,a=h.querySelectorAll(".jdropdown-item");if(a.length){for(var s=0;s<a.length;s++)if(a[s].indexValue>n&&(o=r.items[a[s].indexValue])&&(i=o.element.innerText[0])&&e==(i=i.toLowerCase())){t=a[s].indexValue;break}r.setCursor(t)}}}else if(null==r.currentIndex||null==r.currentIndex)r.first();else{var l=r.items[r.currentIndex].element,u=l.nextElementSibling;u?(u.classList.contains("jdropdown-group")&&(u=u.lastChild.firstChild),t=u.indexValue):l.parentNode.classList.contains("jdropdown-group-items")&&((u=l.parentNode.parentNode.nextElementSibling)&&(u.classList.contains("jdropdown-group")?u=u.lastChild.firstChild:u.classList.contains("jdropdown-item")?t=u.indexValue:u=null),u&&(t=u.indexValue)),null!==t&&r.setCursor(t)}},r.prev=function(){var e=null;if(null===r.currentIndex)r.first();else{var t=r.items[r.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&r.setCursor(e)},r.loadFirst=function(){if(r.results)var e=r.results;else e=r.items;var t=e.length||0;1==r.options.lazyLoading&&t>200&&(t=200),h.innerHTML="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):h.appendChild(e[n].element);h.scrollTop=0},r.loadLast=function(){if(r.results)var e=r.results;else e=r.items;var t=e.length;if(t>200){t-=200,h.innerHTML="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):h.appendChild(e[n].element);h.scrollTop=h.scrollHeight}},r.loadUp=function(){var e=!1;if(r.results)var t=r.results;else t=r.items;var n=h.querySelectorAll(".jdropdown-item")[0].indexValue;n=r.items[n];var o=t.indexOf(n)-1;if(o>0){for(var i=0;o>0&&t[o]&&i<200;)t[o].group?(t[o].group.parentNode||h.insertBefore(t[o].group,h.firstChild),t[o].group.lastChild.insertBefore(t[o].element,t[o].group.lastChild.firstChild)):h.insertBefore(t[o].element,h.firstChild),o--,i++;e=!0}return e},r.loadDown=function(){var e=!1;if(r.results)var t=r.results;else t=r.items;var n=h.querySelectorAll(".jdropdown-item"),o=n[n.length-1].indexValue;o=r.items[o];var i=t.indexOf(o)+1;if(i<t.length){for(var a=0;i<t.length&&t[i]&&a<200;)t[i].group?(t[i].group.parentNode||h.appendChild(t[i].group),t[i].group.lastChild.appendChild(t[i].element)):h.appendChild(t[i].element),i++,a++;e=!0}return e},function(){if(n||(n={}),"SELECT"==t.tagName){var o=e.dropdown.extractFromDom(t,n);t=o.el,n=o.options}!n.placeholder&&t.getAttribute("placeholder")&&(n.placeholder=t.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,t.classList.add("jdropdown"),(d=document.createElement("div")).className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){"function"==typeof r.options.onfocus&&r.options.onfocus(t)},r.header.onblur=function(){"function"==typeof r.options.onblur&&r.options.onblur(t)},r.header.onkeyup=function(e){1!=r.options.autocomplete||y?r.options.autocomplete||r.next(e.key):(r.search!=r.header.value.trim()&&(y=setTimeout((function(){r.find(r.header.value.trim()),y=null}),400)),t.classList.contains("jdropdown-focus")||r.open())},e.dropdown.hasEvents||(e.dropdown.hasEvents=!0,document.addEventListener("keydown",e.dropdown.keydown)),(p=document.createElement("div")).className="jdropdown-container",(h=document.createElement("div")).className="jdropdown-content",(g=document.createElement("div")).className="jdropdown-close",g.innerHTML="Done",(m=document.createElement("div")).className="jdropdown-reset",m.innerHTML="x",m.onclick=function(){r.reset(),r.close()},(v=document.createElement("div")).className="jdropdown-backdrop",d.appendChild(r.header),p.appendChild(h),t.appendChild(d),t.appendChild(p),t.appendChild(v),r.setOptions(n),"ontouchsend"in document.documentElement==1?t.addEventListener("touchsend",e.dropdown.mouseup):t.addEventListener("mouseup",e.dropdown.mouseup),1==r.options.lazyLoading&&e.lazyLoading(h,{loadUp:r.loadUp,loadDown:r.loadDown}),h.onwheel=function(e){e.stopPropagation()},t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue(!!r.options.multiple);r.setValue(e)},t.dropdown=r}(),r},e.dropdown.keydown=function(t){var n=null;if(n=e.dropdown.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var r=0;r<7;r++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(r=0;r<7;r++)n.next();t.preventDefault()}},e.dropdown.mouseup=function(t){var n=e.findElement(t.target,"jdropdown");if(n){var r=n.dropdown;if(t.target.classList.contains("jdropdown-header"))if(n.classList.contains("jdropdown-focus")&&n.classList.contains("jdropdown-default")){var o=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var i=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else i=t.clientX,t.clientY;o.width-(i-o.left)<30?t.target.classList.contains("jdropdown-add")?r.add():r.close():0==r.options.autocomplete&&r.close()}else r.open();else if(t.target.classList.contains("jdropdown-group-name")){var a=t.target.nextSibling.children;if("none"!=t.target.nextSibling.style.display)for(var s=0;s<a.length;s++)"none"!=a[s].style.display&&r.selectItem(a[s])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?r.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?r.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?r.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&r.close()}},e.dropdown.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var r=0;r<e.children.length;r++)if("OPTGROUP"==e.children[r].tagName)for(var o=0;o<e.children[r].children.length;o++)t.data.push({value:e.children[r].children[o].value,text:e.children[r].children[o].innerHTML,group:e.children[r].getAttribute("label")});else t.data.push({value:e.children[r].value,text:e.children[r].innerHTML})}t&&null!=t.onchange||(t.onchange=function(e,r,o,i){1==t.multiple?obj.items[r].classList.contains("jdropdown-selected")?n.options[r].setAttribute("selected","selected"):n.options[r].removeAttribute("selected"):n.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",{el:e=i,options:t}},e.editor=function(t,n){var r={type:"editor",options:{}},o={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,userSearch:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];var a=null,s=null,l=[];t.innerHTML="",r.el=t,"function"==typeof r.options.onclick&&(t.onclick=function(e){r.options.onclick(t,r,e)}),t.classList.add("jeditor-container"),1==r.options.padding&&t.classList.add("jeditor-padding"),0==r.options.border&&(t.style.border="0px");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var c=document.createElement("div");c.className="jeditor-toolbar";var f=document.createElement("div");if(f.setAttribute("contenteditable",!0),f.setAttribute("spellcheck",!1),f.className="jeditor",r.options.placeholder&&f.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(f.style.overflowY="auto",r.options.maxHeight&&(f.style.maxHeight=r.options.maxHeight),r.options.height&&(f.style.height=r.options.height)),r.options.value)var d=r.options.value;else d=t.innerHTML?t.innerHTML:"";d||(d="");var p=function(e){"function"==typeof r.options.onchange&&r.options.onchange(t,r,e),r.options.value=r.getData(),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},h=function(e){var t,n;window.getSelection&&(t=window.getSelection()).rangeCount&&((n=t.getRangeAt(0)).toString(),n.deleteContents(),n.insertNode(e),n.setStartAfter(e),n.setEndAfter(e),t.removeAllRanges(),t.addRange(n))},g=function(){var e=null;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}},m=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var r=document.createElement("div");if(r.className="jsnippet-"+t[n],r.setAttribute("data-k",t[n]),u.appendChild(r),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var o=0;o<e.image.length;o++){var i=document.createElement("img");i.src=e.image[o],r.appendChild(i)}}else r.innerHTML=e[t[n]]}f.appendChild(document.createElement("br")),f.appendChild(u)},v=function(){clearTimeout(a),a=setTimeout((function(){if(!f.querySelector(".jsnippet")){var t=f.innerHTML.replace(/\n/g," "),n=document.createElement("div");n.innerHTML=t;var o=n.innerText,i=e.editor.detectUrl(o);if(i)if("jpg"==i[0].substr(-3)||"png"==i[0].substr(-3)||"gif"==i[0].substr(-3))r.addImage(i[0],!0);else{var a=e.editor.youtubeParser(i[0]);r.parseWebsite(i[0],a)}}}),1e3)};r.parseContent=function(){v()},r.parseWebsite=function(t,n){if(r.options.remoteParser){n&&(t="https://www.youtube.com/watch?v="+n);var o={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:r.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(o.title=e.title),e.description&&(o.description=e.description),e.host&&(o.host=e.host),e.url&&(o.url=e.url),m(o),e.image?r.addImage(e.image,!0):e["og:image"]&&r.addImage(e["og:image"],!0)}})}else console.log("The remoteParser is not defined")},r.setData=function(t){f.innerHTML="object"==typeof t?t.content:t,r.options.focus&&e.editor.setCursor(f,!0),l=[]},r.getFiles=function(){for(var e=f.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)l[e[n].src]&&t.push(l[e[n].src]);return t},r.getText=function(){return f.innerText},r.getData=function(e){if(e){if(p={content:""},u.innerHTML){p.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n){p.snippet.image||(p.snippet.image=[]);for(var r=0;r<u.children[t].children.length;r++)p.snippet.image.push(u.children[t].children[r].getAttribute("src"))}else p.snippet[n]=u.children[t].innerHTML}}var o=Object.keys(l);if(o.length)for(p.files=[],t=0;t<o.length;t++)p.files.push(l[o[t]]);if(j){var i=f.querySelectorAll("a[data-user]");if(i.length){for(p.users=[],t=0;t<i.length;t++){var a=i[t].getAttribute("data-user");a&&p.users.push(a)}p.users=p.users.join(",")}}var s=document.createElement("div");s.innerHTML=f.innerHTML;var c=s.querySelector(".jsnippet");c&&c.remove();var d=s.innerHTML;d=(d=(d=d.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),p.content=d.trim()}else var p=f.innerHTML;return p},r.reset=function(){f.innerHTML="",u.innerHTML="",l=[]},r.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",l[n.src]={file:n.src,extension:"pdf",content:e.result},h(n)}))}},r.addImage=function(e,t){if(e||(e=""),"data"==e.substr(0,4)||r.options.remoteParser){if("data"==e.substr(0,4))n=(n=(n=e.split(";"))[0].split("/"))[1];else{var n=e.substr(e.lastIndexOf(".")+1);e=r.options.remoteParser+e}var o=new Image;o.onload=function(){var e=document.createElement("canvas");e.width=o.width,e.height=o.height,e.getContext("2d").drawImage(o,0,0,e.width,e.height),e.toBlob((function(o){var i,a=document.createElement("img");a.src=window.URL.createObjectURL(o),a.classList.add("jfile"),a.setAttribute("tabindex","900"),l[a.src]={file:a.src,extension:n,content:e.toDataURL()},r.options.dropAsSnippet||t?(i=a,u.innerHTML||m({}),u.children[0].appendChild(i),g(),l[a.src].snippet=!0):h(a),p()}))},o.src=e}else console.error("remoteParser not defined in your initialization")},r.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>r.options.maxFileSize)alert("The file is too big");else{var o=e[n].type.split("/");(o="image"==o[0]?1:"pdf"==o[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=o,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==r.options.acceptFiles&&r.addPdf(e.target):r.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},r.destroy=function(){f.removeEventListener("mouseup",y),f.removeEventListener("mousedown",w),f.removeEventListener("mousemove",E),f.removeEventListener("keyup",b),f.removeEventListener("keydown",x),f.removeEventListener("dragstart",C),f.removeEventListener("dragenter",I),f.removeEventListener("dragover",S),f.removeEventListener("drop",D),f.removeEventListener("paste",L),f.removeEventListener("blur",O),f.removeEventListener("focus",R),t.editor=null,t.classList.remove("jeditor-container"),c.remove(),u.remove(),f.remove()};var y=function(e){s&&s.e&&s.e.classList.remove("resizing"),s=!1},w=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();s={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.width||(e.target.width=n.width+"px"),e.target.height||(e.target.height=n.height+"px");var r=window.getSelection();if(r.rangeCount)for(var o=0;o<r.rangeCount;o++)r.removeRange(r.getRangeAt(o));e.target.classList.add("resizing")}else s=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),s=!0},E=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==r.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&s&&s.d){if("e-resize"==s.d||"ne-resize"==s.d||"se-resize"==s.d)if(s.e.width=s.w+(e.clientX-s.x),e.shiftKey){var n=(e.clientX-s.x)*(s.h/s.w);s.e.height=s.h+n}else n=null;n||"s-resize"!=s.d&&"se-resize"!=s.d&&"sw-resize"!=s.d||e.shiftKey||(s.e.height=s.h+(e.clientY-s.y))}},b=function(n){if(f.innerHTML||(f.innerHTML="<div><br></div>"),j){var o=e.getNode();o&&(!0===o.searchable?o.innerText&&"@"==o.innerText.substr(0,1)&&k(o.innerText.substr(1)):!1===o.searchable&&o.innerText!==o.getAttribute("data-label")&&(o.searchable=!0,o.removeAttribute("href")))}"function"==typeof r.options.onkeyup&&r.options.onkeyup(t,r,n)},x=function(e){1==r.options.parseURL&&v(),j&&("@"==e.key?(function(){var e=(window.getSelection?window.getSelection():document.selection).getRangeAt(0);e.deleteContents();var t=document.createElement("a");t.innerText="@",t.searchable=!0,e.insertNode(t);var n=e.getBoundingClientRect();e.collapse(!1),j.style.position="fixed",j.style.top=n.top+n.height+10+"px",j.style.left=n.left+2+"px"}(),e.preventDefault()):k.isOpened()&&k.keydown(e)),"function"==typeof r.options.onkeydown&&r.options.onkeydown(t,r,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),g())},M=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],T=["width","height","align","border","src","tabindex"],A=["color","font-weight","font-size","background","background-color","margin"],N=function(e){if(e.attributes&&e.attributes.length){var t=null,n=e.getAttribute("style");if(n){t=[];for(var o=n.split(";"),i=0;i<o.length;i++){var a=o[i].trim().split(":");if(A.indexOf(a[0].trim())>=0){var s=a.shift();a=a.join(":"),t.push(s+":"+a)}}}"IMG"==e.tagName.toUpperCase()&&(r.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),r.addImage(e.src)):e.parentNode.removeChild(e));var l=[],u=e.attributes.length-1;if(u>0){for(var c=u;c>=0;c--)l.push(e.attributes[c].name);l.forEach((function(t){-1==T.indexOf(t)&&e.removeAttribute(t)}))}e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(c=0;c<e.children.length;c++)N(e.children[c]);M.indexOf(e.constructor)>=0&&e.remove()},L=function(e){if(1==r.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),o=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),o=window.clipboardData.files);if(o.length)r.addFile(o);else if(t){var i=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");N(t);var n=document.createElement("span");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,i.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertHtml",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,f.appendChild(t)}));e.preventDefault()}},C=function(e){s&&s.e&&e.preventDefault()},I=function(e){s||0==r.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},S=function(e){s||0==r.options.dropZone||(a&&clearTimeout(a),a=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},D=function(e){if(s||0==r.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var o=window.getSelection();o.removeAllRanges(),o.addRange(n),o.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),a=(e.originalEvent||e).dataTransfer.getData("text/plain"),l=(e.originalEvent||e).dataTransfer.files;l.length?r.addFile(l):a&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var o=0;o<n.length;o++)r.addImage(n[o].src)}(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},O=function(e){j&&k.isOpened()&&k.close(),"function"==typeof r.options.onblur&&r.options.onblur(t,r,e),p(e)},R=function(e){"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,e)};f.addEventListener("mouseup",y),f.addEventListener("mousedown",w),f.addEventListener("mousemove",E),f.addEventListener("keyup",b),f.addEventListener("keydown",x),f.addEventListener("dragstart",C),f.addEventListener("dragenter",I),f.addEventListener("dragover",S),f.addEventListener("drop",D),f.addEventListener("paste",L),f.addEventListener("focus",R),f.addEventListener("blur",O),"function"==typeof r.options.onload&&r.options.onload(t,r,f),f.innerHTML=d,t.appendChild(f),r.options.snippet&&m(r.options.snippet),null==r.options.toolbar&&(r.options.toolbar=e.editor.getDefaultToolbar()),r.options.toolbar&&(t.appendChild(c),e.toolbar(c,{container:!0,responsive:!0,items:r.options.toolbar}));var j=null,k=null;return r.options.userSearch&&(j=document.createElement("div"),t.appendChild(j),k=e.search(j,{data:r.options.userSearch,placeholder:e.translate("Type the name a user"),onselect:function(t,n,r,o){if(k.isOpened()){var i=e.getNode();i&&1==i.searchable&&i.innerText.trim()&&i.innerText.substr(1)&&(i.innerText="@"+r,i.href="/"+r,i.setAttribute("data-user",o),i.setAttribute("data-label",i.innerText),i.searchable=!1,e.focus(i))}}})),r.options.focus&&e.editor.setCursor(f,"initial"==r.options.focus),t.change=r.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return r.getData(n)}r.setData(e)},t.editor=r,r},e.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),r=n.getRangeAt(0);if(1==t)var o=r.startContainer,i=0;else i=(o=r.endContainer).length;r.setStart(o,i),r.setEnd(o,i),n.removeAllRanges(),n.addRange(r)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){var t=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi);return t&&"www"==t[0].substr(0,3)&&(t[0]="http://"+t[0]),t},e.editor.youtubeParser=function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!t||11!=t[7].length)&&t[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.form=function(t,n){var r={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(t,n){e.alert(n)}};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=t.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=e.validations.email),r.options.validations.length||(r.options.validations.length=e.validations.length),r.options.validations.required||(r.options.validations.required=e.validations.required),r.setUrl=function(e){r.options.url=e},r.load=function(){e.ajax({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof r.options.onbeforeload){var o=r.options.onbeforeload(t,n);o&&(n=o)}e.form.setElements(t,n),"function"==typeof r.options.onload&&r.options.onload(t,n)}})},r.save=function(){var n=r.validate();if(n)r.options.onerror(t,n);else{var o=e.form.getElements(t,!0);if("function"==typeof r.options.onbeforesave&&!1===(o=r.options.onbeforesave(t,o)))return;e.ajax({url:r.options.url,method:"POST",dataType:"json",data:o,success:function(e){"function"==typeof r.options.onsave&&r.options.onsave(t,o,e)}})}},r.remove=function(){if("function"==typeof r.options.onbeforeremove&&!1===r.options.onbeforeremove(t,r))return!1;e.ajax({url:r.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof r.options.onremove&&r.options.onremove(t,r,e),r.reset()}})};return r.validateElement=function(n){var o=!1,i=e.form.getValue(n),a=n.getAttribute("data-validation");return"function"!=typeof r.options.validations[a]||r.options.validations[a](i,n)?n.classList.contains("error")&&function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)o[i].getAttribute("data-validation")&&o[i].classList.contains("error")&&(n=!0);r.options.submitButton&&(n?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))}(n):o=function(e){e.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(n),o},r.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},r.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),o=0;o<n.length;o++)if(n[o].getAttribute("data-validation")){var i=r.validateElement(n[o]);i&&e.push(i)}return e.length>0&&e.join("<br>")},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(e.form.getElements(t))},r.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},r.isChanged=function(){var e=r.setHash();return r.options.currentHash!=e},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(e){r.options.ignore=!!e},setTimeout((function(){r.options.currentHash=r.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&r.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(r.isChanged()&&0==r.options.ignore){var t=r.options.message?r.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.form.hasEvents=!0),t.form=r,r},e.form.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),r=0;r<n.length;r++)t.push(n[r].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.form.getElements=function(t,n){for(var r={},o=null,i=t.querySelectorAll("input, select, textarea, div[name]"),a=0;a<i.length;a++)(o=i[a].getAttribute("name"))&&(r[o]=e.form.getValue(i[a])||"");return 1==n?r:JSON.stringify(r)},e.form.setElements=function(t,n){for(var r=null,o=null,i=t.querySelectorAll("input, select, textarea, div[name]"),a=0;a<i.length;a++){var s=i[a].getAttribute("type");if(r=i[a].getAttribute("name")){if(o=null,(r=r.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var l=e.path.call(n,r)||"";void 0!==l&&(o=l)}else void 0!==n[r]&&(o=n[r]);null!==o&&("checkbox"==s||"radio"==s?i[a].checked=!!o:"file"==s||("function"==typeof i[a].val?i[a].val(o):i[a].value=o))}}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),r=e.childNodes[e.childNodes.length-1];t.setStart(r,r.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return!isNaN(e)&&null!==e&&""!==e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},e.hash=function(e){var t,n,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(r=(r<<5)-r+n,r|=0);return r},e.randomColor=function(t){var n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);var r,o,i=[];for(o=0;o<3;o++)r=parseInt(n.substr(2*o,2),16),r=Math.round(Math.min(Math.max(0,r+-.25*r),255)).toString(16),i.push(("00"+r).substr(r.length));return 1==t?"#"+e.two(i[0].toString(16))+e.two(i[1].toString(16))+e.two(i[2].toString(16)):i},e.getWindowWidth=function(){var e=window,t=document,n=t.documentElement,r=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||r.clientWidth},e.getWindowHeight=function(){var e=window,t=document,n=t.documentElement,r=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||r.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){var n=!1;return function e(r){r&&!n&&("function"==typeof t?n=t(r):"string"==typeof t&&r.classList&&r.classList.contains(t)&&(n=r)),r.parentNode&&!n&&e(r.parentNode)}(e),n},e.two=function(e){return 1==(e=""+e).length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,r,o,i,a,s,l,u,c,f,d=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],p=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64);function g(e,n){var r,o,i;return r=(65535&e.lowOrder)+(65535&n.lowOrder),i=(65535&(o=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r>>>16)))<<16|65535&r,r=(65535&e.highOrder)+(65535&n.highOrder)+(o>>>16),new t((65535&(o=(e.highOrder>>>16)+(n.highOrder>>>16)+(r>>>16)))<<16|65535&r,i)}function m(e,n,r,o){var i,a,s;return i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&o.lowOrder),s=(65535&(a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(o.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&o.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(o.highOrder>>>16)+(i>>>16)))<<16|65535&i,s)}function v(e,n,r,o,i){var a,s,l;return a=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&o.lowOrder)+(65535&i.lowOrder),l=(65535&(s=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(o.lowOrder>>>16)+(i.lowOrder>>>16)+(a>>>16)))<<16|65535&a,a=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&o.highOrder)+(65535&i.highOrder)+(s>>>16),new t((65535&(s=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(o.highOrder>>>16)+(i.highOrder>>>16)+(a>>>16)))<<16|65535&a,l)}function y(e,n,r){return new t(e.highOrder&n.highOrder^e.highOrder&r.highOrder^n.highOrder&r.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&r.lowOrder^n.lowOrder&r.lowOrder)}function w(e,n,r){return new t(e.highOrder&n.highOrder^~e.highOrder&r.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&r.lowOrder)}function E(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function b(e){var n=E(e,28),r=E(e,34),o=E(e,39);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function x(e){var n=E(e,14),r=E(e,18),o=E(e,41);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function M(e){var n=E(e,1),r=E(e,8),o=T(e,7);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function T(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var A,N,L,C,I=8*(e=function(e){return unescape(encodeURIComponent(e))}(e)).length;(e=function(e){for(var t=[],n=8*e.length,r=0;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<24-r%32;return t}(e))[I>>5]|=128<<24-I%32,e[31+(I+128>>10<<5)]=I;for(var S=0;S<e.length;S+=32){n=d[0],r=d[1],o=d[2],i=d[3],a=d[4],s=d[5],l=d[6],u=d[7];for(var D=0;D<80;D++)h[D]=D<16?new t(e[2*D+S],e[2*D+S+1]):m((A=h[D-2],N=void 0,L=void 0,C=void 0,N=E(A,19),L=E(A,61),C=T(A,6),new t(N.highOrder^L.highOrder^C.highOrder,N.lowOrder^L.lowOrder^C.lowOrder)),h[D-7],M(h[D-15]),h[D-16]),c=v(u,x(a),w(a,s,l),p[D],h[D]),f=g(b(n),y(n,r,o)),u=l,l=s,s=a,a=g(i,c),i=o,o=r,r=n,n=g(c,f);d[0]=g(n,d[0]),d[1]=g(r,d[1]),d[2]=g(o,d[2]),d[3]=g(i,d[3]),d[4]=g(a,d[4]),d[5]=g(s,d[5]),d[6]=g(l,d[6]),d[7]=g(u,d[7])}var O=[];for(S=0;S<d.length;S++)O.push(d[S].highOrder),O.push(d[S].lowOrder);return function(e){for(var t,n="0123456789abcdef",r="",o=4*e.length,i=0;i<o;i+=1)t=e[i>>2]>>8*(3-i%4),r+=n.charAt(t>>4&15)+n.charAt(15&t);return r}(O)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=e.upload=function(t,n){var r={options:{}},o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];1==r.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==r.options.input&&t.classList.add("input"),r.add=function(n){if(0==r.options.multiple&&(t.content=[],t.innerText=""),"image"==r.options.type){var o=document.createElement("img");o.setAttribute("src",n.file),o.setAttribute("tabindex",-1),t.getAttribute("name")||(o.className="jfile",o.content=n),t.appendChild(o)}else{if(n.name)var i=n.name;else i=n.file;var a=document.createElement("div");a.innerText=i||r.options.type,a.classList.add("jupload-item"),a.setAttribute("tabindex",-1),t.appendChild(a)}n.content&&(n.file=e.guid()),t.content.push(n),"function"==typeof r.options.onchange&&r.options.onchange(t,n)},r.addFromFile=function(e){if(e.type.split("/")[0]==r.options.type){var t=new FileReader;t.addEventListener("load",(function(t){var n={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result};r.add(n)})),t.readAsDataURL(e)}else alert(r.options.text.extensionNotAllowed)},r.addFromUrl=function(t){if("data"==t.substr(0,4)||r.options.remoteParser)if("data"==t.substr(0,4))if((o=(o=t.split(";"))[0].split("/"))[0].replace("data:","")==r.options.type){var n={file:t,name:"",extension:o[1],content:t};r.add(n)}else alert(r.options.text.extensionNotAllowed);else{var o=t.substr(t.lastIndexOf(".")+1);t=r.options.remoteParser+t,e.ajax({url:t,type:"GET",dataType:"blob",success:function(e){}})}else console.error("remoteParser not defined in your initialization")};var a=r.options.type+"/"+r.options.extension,s=document.createElement("input");s.type="file",s.setAttribute("accept",a),s.onchange=function(){for(var e=0;e<this.files.length;e++)r.addFromFile(this.files[e])},1==r.options.multiple&&s.setAttribute("multiple",!0);var l=null;return t.addEventListener("click",(function(n){l=null,t.children.length&&n.target!==t?n.target.parentNode==t&&(l=n.target):e.click(s)})),t.addEventListener("dblclick",(function(t){e.click(s)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){if(l&&46==e.which){var n=Array.prototype.indexOf.call(t.children,l);n>=0&&(t.content.splice(n,1),l.remove(),l=null)}})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var o=0;o<e.dataTransfer.files.length;o++)r.addFromFile(e.dataTransfer.files[o]);else if(n){0==r.options.multiple&&(t.innerText="");var i=document.createElement("div");i.innerHTML=n;var a=i.querySelectorAll("img");if(a.length)for(o=0;o<a.length;o++)r.addFromUrl(a[o].src)}return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?r.add({file:e[n]}):r.add(e[n]);else"string"==typeof e&&r.add({file:e})},t.upload=t.image=r,r},e.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},e.lazyLoading=function(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,r=function(r){if(null==n){var o=!1,i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),o=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),o=!0),n=setTimeout((function(){n=null}),t.timer),o&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){r()},e.onwheel=function(e){r()},{}},e.loading=function(){var e={},t=null;return e.show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e}(),e.mask=function(){var t,n={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},r=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var t=0;this.date[4]&&(t=parseFloat(this.date[4]/60));var n=parseInt(this.date[3])+t;n/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),n=e.two(this.date[0])+"-"+e.two(this.date[1])+"-"+e.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(n+=" "+e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]))):n=e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]);return n},o=function(e){return null===e||""===e||void 0===e},i=function(e){return"currency"===e||"percentage"===e||"numeric"===e},a=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},s=function(e,t){return""==e?"":(t||(t=a.call(this)),(e=(""+e).split(t))[0]=e[0].match(/[\-0-9]+/g),e[0]&&(e[0]=e[0].join("")),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):"")},l=function(e,t){if(""==e)return"";var n=a.call(this),r=this.options;if(""==(e=s.call(this,e)))return"";if(e[0]){var o=parseFloat(e[0]+".1");"percent"==r.style&&(o/=100)}else o=null;if(("-"==e[0]||"-00"==e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var i=new Intl.NumberFormat(this.locale,r).format(o);if(void 0!==(i=i.split(n))[1]){var l=i[1].replace(/[0-9]*/g,"");l&&(i[2]=l)}return void 0!==e[1]?i[1]=n+e[1]:i[1]="",i.join("")},u=function(e,t){var n=d.call(e);if(n){a.call(this);var r=l.call(this,n,t),o=r.length-n.length,i=f.call(e)+o;d.call(e,r,i,!0)}},c=function(e){var t=s.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},f=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0;return(a=window.getSelection())&&0!==a.rangeCount&&((o=(s=a.getRangeAt(0)).cloneRange()).selectNodeContents(this),o.setEnd(s.endContainer,s.endOffset),n=o.toString().length),n}return this.selectionStart}var r=d.call(this);if(t){for(var o=null,i=0;i<r.length;i++)(r[i].match(/[\-0-9]/g)||"."==r[i]||","==r[i])&&(o=i);null===o&&(o=r.indexOf(" ")),e>=o&&(e=o+1)}if(e>r.length&&(e=r.length),e)if("DIV"==this.tagName){var a=window.getSelection(),s=document.createRange();this.childNodes[0]&&(s.setStart(this.childNodes[0],e),a.removeAllRanges(),a.addRange(s))}else this.selectionStart=e,this.selectionEnd=e},d=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return this.innerText;this.innerText!==e&&(this.innerText=e,t&&f.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&f.call(this,t,n))}},p=e.calendar.weekdays,h=e.calendar.weekdaysShort,g=e.calendar.months,m=e.calendar.monthsShort,v={YEAR:function(e,t){var n=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){v.YEAR.call(this,e,4)},YYY:function(e){v.YEAR.call(this,e,3)},YY:function(e){v.YEAR.call(this,e,2)},FIND:function(e,t){o(this.values[this.index])&&(this.values[this.index]="");for(var n=0,r=0,i=(this.values[this.index]+e).toLowerCase(),a=0;a<t.length;a++)0==t[a].toLowerCase().indexOf(i)&&(n=a,r++);if(r>1)this.values[this.index]+=e;else if(1==r){var s=t[n].length-this.values[this.index].length-1;return this.position+=s,this.values[this.index]=t[n],this.index++,n}},MMM:function(e){var t=v.FIND.call(this,e,m);void 0!==t&&(this.date[1]=t+1)},MMMM:function(e){var t=v.FIND.call(this,e,g);void 0!==t&&(this.date[1]=t+1)},MMMMM:function(e){o(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<g.length;n++)if(0==g[n][0].toLowerCase().indexOf(t)){this.values[this.index]=g[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?o(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?o(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){o(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){v.FIND.call(this,e,h)},DDDD:function(e){v.FIND.call(this,e,p)},HH12:function(e,t){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){v.HH24.call(this,e,1)},H:function(e){v.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){v.N60.call(this,e,4)},SS:function(e){v.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(this.date[3]>12?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=a.call(this),n=!1;o(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var r=s.call(this,this.values[this.index],t);r&&(this.values[this.index]=r.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){v["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){v["0{1}(.{1}0+)?"].call(this,e);var t=a.call(this),n=this.tokens[this.index].substr(1,1),r="-"===this.values[this.index][0],o=s.call(this,this.values[this.index],t);if(""!==o){var i=o[0].match(/[0-9]/g);if(i){for(var l=[],u=0,c=(i=i.join("")).length-1;c>=0;c--)l.push(i[c]),++u%3||l.push(n);l=l.reverse(),o[0]=l.join(""),o[0].substr(0,1)==n&&(o[0]=o[0].substr(1))}else o[0]="";this.values[this.index]=o.join(t),r&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){o(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){v["[0-9a-zA-Z$]+"].call(this,e)}},y=function(e){if("general"==this.type)var t=[].concat(n.general);else t=[].concat(n.currency,n.datetime,n.percentage,n.numeric,n.general);var r=new RegExp(t.join("|"),"gi");return e.match(r)},w=function(e){if(this.type)t="general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"];else var t=Object.keys(n);for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<n[o].length;i++){var a=new RegExp(n[o][i],"gi");if(e.match(a))return{type:o,method:n[o][i]}}},E=function(e){for(var t=[],n=0;n<e.length;n++){var r=w.call(this,e[n]);r?t.push(r.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},b=function(e){var t=w.call(this,e);if(t)var n=t.type;if(n){for(var r=0,o=y.call(this,e),a=0;a<o.length;a++)(t=w.call(this,o[a]))&&i(t.type)&&r++;r>1&&(n="general")}return n},x=function(){"function"==typeof v[this.methods[this.index]]?(v[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},M=(t=function(e){return"="==(""+e)[0]},function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,r,o){return o<0?t+"0."+Array(1-o-n.length).join(0)+n+r:t+n+r+Array(o-r.length+1).join(0)}))}),T=function(n,o,s){var p=null,h={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof n){if(h.input=n.target,h.value=d.call(n.target),h.caret=f.call(n.target),(p=n.target.getAttribute("data-mask"))&&(h.mask=p),(p=n.target.getAttribute("data-type"))&&(h.type=p),n.target.mask?(n.target.mask.options&&(h.options=n.target.mask.options),n.target.mask.locale&&(h.locale=n.target.mask.locale)):(p=n.target.getAttribute("data-locale"))&&(h.locale=p,h.mask&&(h.options.style=h.mask)),n.target.attributes&&n.target.attributes.length)for(var g=0;g<n.target.attributes.length;g++){var m=n.target.attributes[g].name,v=n.target.attributes[g].value;"data"==m.substr(0,4)&&(h.options[m.substr(5)]=v)}}else{if("string"==typeof o)h.mask=o;else for(m=Object.keys(o),g=0;g<m.length;g++)h[m[g]]=o[m[g]];"number"==typeof n&&(a.call(h,h.mask),n=(""+n).replace(".",h.options.decimal)),h.value=n,h.input&&(d.call(h.input,n),e.focus(h.input),h.caret=f.call(h.input))}if(!t(h.value)&&(h.mask||h.locale)){if(h.mask){if(h.mask=h.mask.replace("[-]",""),-1!==h.mask.indexOf("##")){var M=h.mask.split(";");M[0]&&(M[0]=M[0].replace("*",""),M[0]=M[0].replace(/_/g,""),M[0]=M[0].replace(/-/g,""),M[0]=M[0].replace("(",""),M[0]=M[0].replace(")",""),M[0]=M[0].replace("##0.###","##0.000"),M[0]=M[0].replace("##0.##","##0.00"),M[0]=M[0].replace("##0.#","##0.0")),h.mask=M[0]}h.type||(h.type=b.call(h,h.mask)),h.tokens=y.call(h,h.mask)}if("object"!=typeof n||!n.inputType||!n.inputType.indexOf("insert")||!n.inputType.indexOf("delete"))if(h.locale)if(h.input)u.call(h,h.input,n);else var T=l.call(h,h.value);else{for(h.methods=E.call(h,h.tokens);h.position<h.value.length&&void 0!==h.tokens[h.index];)x.call(h);if(i(h.type)){for(;void 0!==h.tokens[h.index];)(p=w.call(h,h.tokens[h.index]))&&"general"==p.type&&(h.values[h.index]=h.tokens[h.index]),h.index++;var A=!0}else A=!1;if(T=h.values.join(""),h.input){if((p=T.length-h.value.length)>0)var N=h.caret+p;else N=h.caret;d.call(h.input,T,N,A)}}if(h.input){var L=null;i(h.type)?(h.number=c.call(h,d.call(h.input)),L="percentage"==h.type?h.number/100:h.number):"datetime"==h.type&&(L=r.call(h),h.date[0]&&h.date[1]&&h.date[2]&&h.input.setAttribute("data-completed",!0)),L&&h.input.setAttribute("data-value",L)}if(void 0!==T)return s?h:T}};return T.prepare=function(e,t){return t||(t={}),y.call(t,e)},T.apply=function(e){var t=d.call(e.target);1==e.key.length&&(t+=e.key),d.call(e.target,T(t,e.target.getAttribute("data-mask")))},T.run=function(e,t,n){return T(e,{mask:t,decimal:n})},T.extract=function(t,n,i){if(o(t))return t;if("object"!=typeof n)return f;(n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),a.call(n,n.mask);var s=null;if("percent"==n.type||"percent"==n.options.style?s="percentage":n.mask&&(s=b.call(n,n.mask)),"general"===s){var l=T(t,n,!0);f=t}else if("datetime"===s){if(t instanceof Date)var u=e.calendar.getDateString(f,n.mask);if(l=T(t,n,!0),e.isNumeric(t))f=t;else{var f=r.call(l);u=e.calendar.now(l.date),f=e.calendar.dateToNum(u)}}else f=c.call(n,t),"percentage"==s&&(f/=100),l=n;return l.value=f,!l.type&&s&&(l.type=s),i?l:f},T.render=function(t,n,r){if(o(t))return t;if("object"!=typeof n)return t;(n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format);var i=null;"percent"==n.type||"percent"==n.options.style?i="percentage":n.mask?i=b.call(n,n.mask):t instanceof Date&&(i="datetime");var s=!1;if("datetime"==i||"calendar"==n.type)(l=e.calendar.getDateString(t,n.mask))&&(t=l),n.mask&&r&&(s=!0);else if("percentage"==i&&(t*=100),"number"==typeof t){var l=null;if(n.mask&&r){var u=a.call(n,n.mask);-1!==n.mask.indexOf(u)?(u=(u=""+(u=n.mask.split(u))[1].match(/[0-9]+/g)).length,l=t.toFixed(u)):l=t.toFixed(0)}else if(n.locale&&r){if(u=(""+t).split("."),n.options){void 0===u[1]&&(u[1]="");var c=u[1].length;if(n.options.minimumFractionDigits>c)for(var f=0;f<n.options.minimumFractionDigits-c;f++)u[1]+="0"}l=u[1].length?u.join("."):u[0],c=u[1].length,n.options&&n.options.maximumFractionDigits<c&&(l=parseFloat(l).toFixed(n.options.maximumFractionDigits))}else l=M(t);null!==l&&(t=l,a.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))}else n.mask&&r&&(s=!0);if(s){var d=n.mask.length-t.length;if(d>0)for(f=0;f<d;f++)t+=" "}return T(t,n)},T.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},"undefined"!=typeof document&&document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&T(e)})),T}(),e.modal=function(t,n){var r={options:{}},o={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];!r.options.title&&t.getAttribute("title")&&(r.options.title=t.getAttribute("title"));for(var a=document.createElement("div");t.children[0];)a.appendChild(t.children[0]);for(r.content=document.createElement("div"),r.content.className="jmodal_content",r.content.innerHTML=t.innerHTML;a.children[0];)r.content.appendChild(a.children[0]);if(r.container=document.createElement("div"),r.container.className="jmodal",r.container.appendChild(r.content),r.options.padding&&(r.content.style.padding=r.options.padding),r.options.width&&(r.container.style.width=r.options.width),r.options.height&&(r.container.style.height=r.options.height),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(r.container),r.options.backdrop){var s=document.createElement("div");s.className="jmodal_backdrop",s.onclick=function(){r.close()},t.appendChild(s)}if(r.open=function(){t.style.display="block";var n=r.container.getBoundingClientRect();e.getWindowWidth()<n.width?(r.container.style.top="",r.container.style.left="",r.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(r.container,1)):r.options.backdrop&&(s.style.display="block"),"function"==typeof r.options.onopen&&r.options.onopen(t,r)},r.resetPosition=function(){r.container.style.top="",r.container.style.left=""},r.isOpen=function(){return"none"!=t.style.display},r.close=function(){r.isOpen()&&(t.style.display="none",r.options.backdrop&&(s.style.display=""),r.container.classList.remove("jmodal_fullscreen"),"function"==typeof r.options.onclose&&r.options.onclose(t,r))},!e.modal.hasEvents){var l=null;document.addEventListener("keydown",(function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()})),document.addEventListener("mouseup",(function(t){var n=e.findElement(t.target,"jmodal");if(n){var r=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var o=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY;else o=t.clientX,i=t.clientY;r.width-(o-r.left)<50&&i-r.top<50&&n.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)})),document.addEventListener("mousedown",(function(t){var n=e.findElement(t.target,"jmodal");if(n){var r=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var o=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY;else o=t.clientX,i=t.clientY;r.width-(o-r.left)<50&&i-r.top<50||t.target.getAttribute("title")&&i-r.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:r.left,top:r.top,x:t.clientX,y:t.clientY,width:r.width,height:r.height,element:n})}})),document.addEventListener("mousemove",(function(e){if(l){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;t?(l.element.style.top=l.top+(e.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(e.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}})),e.modal.hasEvents=!0}return r.options.url?e.ajax({url:r.options.url,method:"GET",dataType:"text/html",success:function(e){r.content.innerHTML=e,r.options.closed||r.open()}}):r.options.closed||r.open(),t.modal=r,r},e.notification=function(t){var n={options:{}},r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];var i=document.createElement("div");i.className="jnotification",n.options.error&&i.classList.add("jnotification-error");var a=document.createElement("div");a.className="jnotification-container",i.appendChild(a);var s=document.createElement("div");s.className="jnotification-header",a.appendChild(s);var l=document.createElement("div");if(l.className="jnotification-image",s.appendChild(l),n.options.icon){var u=document.createElement("img");u.src=n.options.icon,l.appendChild(u)}var c=document.createElement("div");if(c.className="jnotification-name",c.innerHTML=n.options.name,s.appendChild(c),1==n.options.closeable){var f=document.createElement("div");f.className="jnotification-close",f.onclick=function(){n.hide()},s.appendChild(f)}var d=document.createElement("div");d.className="jnotification-date",s.appendChild(d);var p=document.createElement("div");if(p.className="jnotification-content",a.appendChild(p),n.options.title){var h=document.createElement("div");h.className="jnotification-title",h.innerHTML=n.options.title,p.appendChild(h)}var g=document.createElement("div");if(g.className="jnotification-message",g.innerHTML=n.options.message,p.appendChild(g),n.show=function(){document.body.appendChild(i),e.getWindowWidth()>800?e.animation.fadeIn(i):e.animation.slideTop(i,1)},n.hide=function(){e.getWindowWidth()>800?e.animation.fadeOut(i,(function(){i.parentNode&&(i.parentNode.removeChild(i),m&&clearTimeout(m))})):e.animation.slideTop(i,0,(function(){i.parentNode&&(i.parentNode.removeChild(i),m&&clearTimeout(m))}))},n.show(),1==n.options.autoHide)var m=setTimeout((function(){n.hide()}),n.options.timeout);return e.getWindowWidth()<800&&i.addEventListener("swipeup",(function(e){n.hide(),e.preventDefault(),e.stopPropagation()})),n},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=(t={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},(n=function(e){return t[e]?t[e]:t.material}).get=function(e){return t[e]?t[e]:t},n.set=function(e,n){t[e]=n},n),e.picker=function(t,n){if(t.picker)return t.picker.setOptions(n,!0);var r={type:"picker",options:{}},o=null,i=null;return r.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var a in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(a)?r.options[a]=e[a]:void 0!==r.options[a]&&!0!==t||(r.options[a]=n[a]);return!1===r.options.header?o.style.display="none":o.style.display="",r.options.width?o.style.width=parseInt(r.options.width)+"px":o.style.width="",r.options.height?(i.style.maxHeight=r.options.height+"px",i.style.overflow="scroll"):i.style.overflow="",r.options.columns>0&&(i.classList.add("jpicker-columns"),i.style.width=r.options.width?r.options.width:36*r.options.columns+"px"),isNaN(r.options.value)&&(r.options.value="0"),function(){i.innerHTML="";for(var e=Object.keys(r.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.k=e[t],n.v=r.options.data[e[t]],n.innerHTML=r.getLabel(e[t]),i.appendChild(n)}}(),r.setValue(r.options.value),r},r.getValue=function(){return r.options.value},r.setValue=function(e){r.setLabel(e),r.options.value=String(e),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),"generic"!==i.children[e].getAttribute("type")&&r.close()},r.getLabel=function(e){var t=r.options.data[e]||null;return"function"==typeof r.options.render&&(t=r.options.render(t)),t},r.setLabel=function(e){if(r.options.content)var t='<i class="material-icons">'+r.options.content+"</i>";else t=r.getLabel(e);o.innerHTML=t},r.open=function(){if(!t.classList.contains("jpicker-focus")){e.tracking(r,!0),t.classList.add("jpicker-focus"),t.focus();var n,a=0;i.style.marginLeft="";var s=o.getBoundingClientRect(),l=i.getBoundingClientRect();n=window.innerHeight<s.bottom+l.height?-1*(l.height+4):s.height+4,!0===r.options.right&&(a=-1*l.width+s.width),l.left+a<0&&(a=a+l.left+10),l.left+l.width>window.innerWidth&&(a=-1*(10+l.left+l.width-window.innerWidth)),i.style.marginTop=parseInt(n)+"px",i.style.marginLeft=parseInt(a)+"px","function"==typeof r.options.onopen&&r.options.onopen(t,r)}},r.close=function(){t.classList.contains("jpicker-focus")&&(t.classList.remove("jpicker-focus"),e.tracking(r,!1),"function"==typeof r.options.onclose&&r.options.onclose(t,r))},t.classList.add("jpicker"),t.setAttribute("tabindex","900"),t.onmousedown=function(e){t.classList.contains("jpicker-focus")||r.open()},(o=document.createElement("div")).classList.add("jpicker-header"),(i=document.createElement("div")).classList.add("jpicker-content"),i.onclick=function(n){var o=e.findElement(n.target,"jpicker-item");o&&o.parentNode===i&&(r.setValue(o.k),"function"==typeof r.options.onchange&&r.options.onchange.call(r,t,r,o.v,o.v,o.k,n))},t.appendChild(o),t.appendChild(i),t.value=n.value||0,r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.picker=r,r},e.progressbar=function(e,t){var n={options:{}},r={value:0,onchange:null,width:null};for(var o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var i=document.createElement("div");i.style.width=n.options.value+"%",i.style.color="#fff",e.appendChild(i),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var a=function(t){if(t.which){var r=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var o=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else o=t.clientX,t.clientY;n.setValue(Math.round((o-r.left)/r.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",a),e.addEventListener("touchend",a)):(e.addEventListener("mousedown",a),e.addEventListener("mousemove",a)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},e.rating=function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,r){var o={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in o)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:void 0!==n.options[i]&&!0!==r||(n.options[i]=o[i]);e.innerHTML="";for(var a=0;a<n.options.number;a++){var s=document.createElement("div");s.setAttribute("data-index",a+1),s.setAttribute("title",n.options.tooltip[a]),e.appendChild(s)}if(n.options.value)for(a=0;a<n.options.number;a++)a<n.options.value&&e.children[a].classList.add("jrating-selected");return n},setValue:function(t){for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-selected"):(e.children[r].classList.remove("jrating-over"),e.children[r].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var r=t.target.getAttribute("data-index"),o=0;o<n.options.number;o++)o<r?e.children[o].classList.add("jrating-over"):e.children[o].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var r=0;r<n.options.number;r++)e.children[r].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},e.search=function(t,n){if(t.search)return t.search;var r=null,o=function(e){if(l.innerHTML="",e.length){t.style.display="block";for(var n=e.length<11?e.length:10,r=0;r<n;r++){if("string"==typeof e[r])var o=e[r],i=e[r];else!(o=e[r].text)&&e[r].name&&(o=e[r].name),!(i=e[r].value)&&e[r].id&&(i=e[r].id);var a=document.createElement("div");a.setAttribute("data-value",i),a.setAttribute("data-text",o),a.className="jsearch_item",e[r].id&&a.setAttribute("id",e[r].id),s.options.forceSelect&&0==r&&a.classList.add("selected");var u=document.createElement("img");e[r].image?u.src=e[r].image:u.style.display="none",a.appendChild(u);var c=document.createElement("div");c.innerHTML=o,a.appendChild(c),l.appendChild(a)}}else t.style.display=""},i=function(t){if(t!=s.terms)if(s.terms=t,r=s.options.forceSelect?0:null,Array.isArray(s.options.data)){var n=s.options.data.filter((function(e){return function(e){if("string"==typeof e){if((""+e).toLowerCase().search(t.toLowerCase())>=0)return!0}else for(var n in e)if((""+e[n]).toLowerCase().search(t.toLowerCase())>=0)return!0;return!1}(e)}));o(n)}else e.ajax({url:s.options.data+t,method:"GET",dataType:"json",success:function(e){o(e)}})},a=null,s=function(e){a&&clearTimeout(a),a=setTimeout((function(){i(e)}),500)};null===n.forceSelect&&(n.forceSelect=!0),s.options={data:n.data||null,input:n.input||null,searchByNode:n.searchByNode||null,onselect:n.onselect||null,forceSelect:n.forceSelect,onbeforesearch:n.onbeforesearch||null},s.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),r=e.getAttribute("data-value");"function"==typeof s.options.onselect&&s.options.onselect(s,n,r,t),s.close()},s.open=function(){t.style.display="block"},s.close=function(){a&&clearTimeout(a),s.terms="",l.innerHTML="",t.style.display=""},s.isOpened=function(){return!!t.style.display},s.keydown=function(e){s.isOpened()&&("Enter"==e.key?null!==r&&l.children[r]?(s.selectIndex(l.children[r]),e.preventDefault()):s.close():"ArrowUp"===e.key?(null!==r&&l.children[0]&&(l.children[r].classList.remove("selected"),s.options.forceSelect||0!==r?(r=Math.max(0,r-1),l.children[r].classList.add("selected")):r=null),e.preventDefault()):"ArrowDown"===e.key&&(null==r?r=-1:l.children[r].classList.remove("selected"),r<9&&l.children[r+1]&&r++,l.children[r].classList.add("selected"),e.preventDefault()))},s.keyup=function(t){if(s.options.searchByNode){var n=e.getNode();n&&(r=n.innerText)}else if("DIV"===s.options.input.tagName)var r=s.options.input.innerText;else r=s.options.input.value;if("function"==typeof s.options.onbeforesearch){var o=s.options.onbeforesearch(s,r);if(o)r=o;else if(!1===o)return}s(r)},s.options.input&&(s.options.input.addEventListener("keyup",s.keyup),s.options.input.addEventListener("keydown",s.keydown));var l=document.createElement("div");return l.classList.add("jsearch_container"),l.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;s.selectIndex(t),e.preventDefault()},t.appendChild(l),t.classList.add("jsearch"),t.search=s,s},e.slider=function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=n.options.height),n.options.width&&(e.style.width=n.options.width),n.options.grid){e.classList.add("jslider-grid");var r=e.children.length;r>4&&e.setAttribute("data-total",r-4),e.setAttribute("data-number",r>4?4:r)}var o=document.createElement("div");if(o.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){n.options.items.push(e.children[i]);var a=document.createElement("div");a.onclick=function(){var e=Array.prototype.slice.call(o.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},o.appendChild(a)}var s=document.createElement("div");s.className="jslider-caption";var l=document.createElement("div"),u=document.createElement("div");u.className="jslider-close",u.innerHTML="",u.onclick=function(){n.close()},l.appendChild(s),l.appendChild(u)}n.updateCounter=function(e){for(var t=0;t<o.children.length;t++)if(o.children[t].classList.contains("jslider-counter-focus")){o.children[t].classList.remove("jslider-counter-focus");break}o.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(l),e.appendChild(o);var r=n.options.items.indexOf(t);n.updateCounter(r);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),l.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";o.remove(),l.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var c=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",c):e.addEventListener("mouseup",c),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n,n},e.sorting=function(e,t){var n={options:{}},r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},o=null;for(var i in r)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:n.options[i]=r[i];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var r=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);o={element:t.target,o:r,d:r},t.target.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),a(e.target)&&o&&"true"==e.target.getAttribute("draggable")&&o.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(o.element,e.target):e.target.parentNode.insertBefore(o.element,e.target.nextSibling),o.d=Array.prototype.indexOf.call(e.target.parentNode.children,o.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),o&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,o.element,t),o.o<o.d?t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o]):t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o].nextSibling),o.element.style.opacity="",o=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),o&&o.o!=o.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,o.o,o.d,o.element,t.target,t),o.element.style.opacity="",o=null}));for(var a=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},s=0;s<e.children.length;s++)e.children[s].hasAttribute("draggable")||e.children[s].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],r=0;r<e.children.length;r++)(t=e.children[r].getAttribute("data-id"))&&n.push(t);return n},e},e.tabs=function(t,n){var r={options:{}},o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];t.classList.add("jtabs");var a=null,s=null,l=null,u=function(e){r.options.animation&&setTimeout((function(){var t=r.headers.children[e].getBoundingClientRect();"modern"==r.options.palette?(l.style.width=t.width-4+"px",l.style.left=r.headers.children[e].offsetLeft+2+"px"):(l.style.width=t.width+"px",l.style.left=r.headers.children[e].offsetLeft+"px"),"bottom"==r.options.position?l.style.top="0px":l.style.bottom="0px"}),150)},c=function(e){"function"==typeof r.headers.scrollTo?r.headers.scrollTo({left:e,behavior:"smooth"}):r.headers.scrollLeft=e,e<=1?a.classList.add("disabled"):a.classList.remove("disabled"),e>=r.headers.scrollWidth-r.headers.offsetWidth?s.classList.add("disabled"):s.classList.remove("disabled"),r.headers.scrollWidth<=r.headers.offsetWidth?(a.style.display="none",s.style.display="none"):(a.style.display="",s.style.display="")};if(r.setBorder=u,r.open=function(e){for(var n=null,o=0;o<r.headers.children.length;o++)r.headers.children[o].classList.contains("jtabs-selected")&&(n=o),r.headers.children[o].classList.remove("jtabs-selected"),r.content.children[o]&&r.content.children[o].classList.remove("jtabs-selected");if(r.headers.children[e].classList.add("jtabs-selected"),r.content.children[e]&&r.content.children[e].classList.add("jtabs-selected"),n!=e&&"function"==typeof r.options.onchange&&r.content.children[e]&&r.options.onchange(t,r,e,r.headers.children[e],r.content.children[e]),1==r.options.hideHeaders&&r.headers.children.length<3&&0==r.options.allowCreate)r.headers.parentNode.style.display="none";else{u(e),r.headers.parentNode.style.display="";var i=r.headers.children[e].offsetLeft,a=i+r.headers.children[e].offsetWidth,s=r.headers.scrollLeft,l=s+r.headers.offsetWidth;s<=i&&l>=a||c(i-1)}},r.selectIndex=function(e){var t=Array.prototype.indexOf.call(r.headers.children,e);return t>=0&&r.open(t),t},r.rename=function(e,t){t||(t=prompt("New title",r.headers.children[e].innerText)),r.headers.children[e].innerText=t,r.open(e)},r.create=function(e,n){if("function"==typeof r.options.onbeforecreate){var o=r.options.onbeforecreate(t);if(!1===o)return!1;e=o}var i=r.appendElement(e);return"function"==typeof r.options.oncreate&&r.options.oncreate(t,i),u(),i},r.remove=function(e){return r.deleteElement(e)},r.nextNumber=function(){for(var e=0,t=0;t<r.headers.children.length;t++){var n=r.headers.children[t].innerText.match(/[0-9].*/);n>e&&(e=parseInt(n))}return e?e++:e=1,e},r.deleteElement=function(e){if(!r.headers.children[e])return!1;r.headers.removeChild(r.headers.children[e]),r.content.removeChild(r.content.children[e]),r.open(0),"function"==typeof r.options.ondelete&&r.options.ondelete(t,e)},r.appendElement=function(e,t){if(e||(e=prompt("Title?","")),e){var n=document.createElement("div");r.content.appendChild(n);var o=document.createElement("div");return o.innerHTML=e,o.content=n,r.headers.insertBefore(o,r.headers.lastChild),r.options.allowChangePosition&&o.setAttribute("draggable","true"),r.selectIndex(o),"function"==typeof t&&t(n,o),n}},r.getActive=function(){for(var e=0;e<r.headers.children.length;e++)if(r.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},r.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),r.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),r.content.replaceChild(t,r.content.children[e]),u()},r.updatePosition=function(e,t){e>t?r.content.insertBefore(r.content.children[e],r.content.children[t]):r.content.insertBefore(r.content.children[e],r.content.children[t].nextSibling),r.open(t),"function"==typeof r.options.onchangeposition&&r.options.onchangeposition(r.headers,e,t)},r.move=function(e,t){e>t?r.headers.insertBefore(r.headers.children[e],r.headers.children[t]):r.headers.insertBefore(r.headers.children[e],r.headers.children[t].nextSibling),r.updatePosition(e,t)},r.setBorder=u,r.init=function(){t.innerHTML="",r.headers=document.createElement("div"),r.content=document.createElement("div"),r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),r.options.palette?t.classList.add("jtabs-modern"):t.classList.remove("jtabs-modern"),r.options.padding&&(r.content.style.padding=parseInt(r.options.padding)+"px");var n=document.createElement("div");n.className="jtabs-headers-container",n.appendChild(r.headers),r.options.maxWidth&&(n.style.maxWidth=parseInt(r.options.maxWidth)+"px");var o=document.createElement("div");if(o.className="jtabs-controls",o.setAttribute("draggable","false"),n.appendChild(o),"bottom"==r.options.position?(t.appendChild(r.content),t.appendChild(n)):(t.appendChild(n),t.appendChild(r.content)),1==r.options.allowCreate){var i=document.createElement("div");i.className="jtabs-add",i.onclick=function(){r.create()},o.appendChild(i)}(a=document.createElement("div")).className="jtabs-prev",a.onclick=function(){c(r.headers.scrollLeft-r.headers.offsetWidth)},o.appendChild(a),(s=document.createElement("div")).className="jtabs-next",s.onclick=function(){c(r.headers.scrollLeft+r.headers.offsetWidth)},o.appendChild(s);for(var u=0;u<r.options.data.length;u++){if(r.options.data[u].titleElement)var f=r.options.data[u].titleElement;else f=document.createElement("div");if(r.options.data[u].icon){var d=document.createElement("div"),p=document.createElement("i");p.classList.add("material-icons"),p.innerHTML=r.options.data[u].icon,d.appendChild(p),f.appendChild(d)}if(r.options.data[u].title){var h=document.createTextNode(r.options.data[u].title);f.appendChild(h)}if(r.options.data[u].width&&(f.style.width=r.options.data[u].width),r.options.data[u].contentElement)var g=r.options.data[u].contentElement;else(g=document.createElement("div")).innerHTML=r.options.data[u].content;r.headers.appendChild(f),r.content.appendChild(g)}(l=document.createElement("div")).className="jtabs-border",r.headers.appendChild(l),r.options.animation&&t.classList.add("jtabs-animation"),r.headers.addEventListener("click",(function(e){if(e.target.parentNode.classList.contains("jtabs-headers"))var n=e.target;else n="I"==e.target.tagName?e.target.parentNode.parentNode:e.target.parentNode;var o=r.selectIndex(n);"function"==typeof r.options.onclick&&r.options.onclick(t,r,o,r.headers.children[o],r.content.children[o])})),r.headers.addEventListener("contextmenu",(function(e){r.selectIndex(e.target)})),r.headers.children.length&&r.open(0),c(0),1==r.options.allowChangePosition&&e.sorting(r.headers,{direction:1,ondrop:function(e,t,n){r.updatePosition(t,n)}}),"function"==typeof r.options.onload&&r.options.onload(t,r)},t.children[0]&&t.children[0].children.length)for(var f=0;f<t.children[0].children.length;f++){var d=r.options.data&&r.options.data[f]?r.options.data[f]:{};t.children[1]&&t.children[1].children[f]?(d.titleElement=t.children[0].children[f],d.contentElement=t.children[1].children[f]):d.contentElement=t.children[0].children[f],r.options.data[f]=d}var p=!1;if(r.options.data)for(f=0;f<r.options.data.length;f++)r.options.data[f].url&&(e.ajax({url:r.options.data[f].url,type:"GET",dataType:"text/html",index:f,success:function(e){r.options.data[this.index].content=e},complete:function(){r.init()}}),p=!0);return p||r.init(),t.tabs=r,r},e.tags=function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var r={type:"tags",options:{}},o=function(){return!!(r.options.limit&&t.children.length>=r.options.limit)},i=null,a=null;r.setOptions=function(n,o){var s={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var l in s)n&&n.hasOwnProperty(l)?r.options[l]=n[l]:void 0!==r.options[l]&&!0!==o||(r.options[l]=s[l]);return r.options.placeholder?t.setAttribute("data-placeholder",r.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=r.options.placeholder,r.setValue(r.options.value),c(),r.options.search?a||(a=document.createElement("div"),t.parentNode.insertBefore(a,t.nextSibling),i=e.search(a,{data:r.options.search,onselect:function(e,t,n){r.selectIndex(t,n)}})):a&&(i=null,a.remove(),a=null),r},r.add=function(n,a){if("function"==typeof r.options.onbeforechange){var c=r.options.onbeforechange(t,r,r.options.value,n);if(!1===c)return!1;null!=c&&(n=c)}if(i&&i.close(),o())"function"==typeof r.options.onlimit?r.options.onlimit(r,r.options.limit):r.options.limitMessage&&alert(r.options.limitMessage+" "+r.options.limit);else{var f=e.getNode();if(!(f&&f.parentNode&&f.parentNode.classList.contains("jtags")&&f.nextSibling)||f.nextSibling.innerText&&f.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(var d=0;d<=n.length;d++)if(!o()){if(n[d]&&"string"!=typeof n[d])p=n[d].text,h=n[d].value;else var p=n[d]||"",h=null;g=l(p,h)}}else var g=l(n,n,f);u()}else g=f.nextSibling;a&&s(g)}},r.setLimit=function(e){for(r.options.limit=e,t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},r.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():r.add("",!0)},r.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var r=t.children[n].innerText.replace("\n",""),o=t.children[n].getAttribute("data-value");o||(o=r),(r||o)&&e.push({text:r,value:o})}return e},r.getValue=function(e){var n=null;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{for(var o=[],i=0;i<t.children.length;i++)(n=t.children[i].innerText.replace("\n",""))&&o.push(r.getValue(i));n=o.join(",")}return n},r.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))r.add(e);else{var n=(""+e).trim(),o=d(n);t.innerHTML="",r.add(o)}}else r.reset()},r.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},r.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},r.selectIndex=function(t,n){var i=e.getNode();i&&(i.innerText=t,n&&i.setAttribute("data-value",n),i.classList.remove("jtags_error"),o()||r.add("",!0))},r.search=function(e){e.innerText},r.destroy=function(){t.removeEventListener("mouseup",v),t.removeEventListener("keydown",h),t.removeEventListener("keyup",g),t.removeEventListener("paste",m),t.removeEventListener("focus",y),t.removeEventListener("blur",w),t.parentNode.removeChild(t)};var s=function(e){if(t.children.length>1){var n=document.createRange(),r=window.getSelection();e||(e=t.childNodes[t.childNodes.length-1]),n.setStart(e,e.length),n.collapse(!0),r.removeAllRanges(),r.addRange(n),t.scrollLeft=t.scrollWidth}},l=function(e,n,r){var o=document.createElement("div");return o.innerHTML=e||"",n&&o.setAttribute("data-value",n),r&&r.parentNode.classList.contains("jtags")?t.insertBefore(o,r.nextSibling):t.appendChild(o),o},u=function(){var e=r.getValue();e!=r.options.value&&(r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(t,r,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))),c()},c=function(){for(var e=0;e<t.children.length;e++)r.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof r.options.validation&&r.getValue(e)?r.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label");f()},f=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):(t.innerHTML="<div></div>",t.classList.add("jtags-empty"))},d=function(e){var t=[],n="";if(e=e.trim()){for(var r=0;r<e.length;r++)","==e[r]||";"==e[r]||"\n"==e[r]?n&&(t.push(n.trim()),n=""):n+=e[r];n&&t.push(n)}return t},p=0,h=function(e){p=window.getSelection().anchorOffset,f(),"Tab"===e.key||";"===e.key||","===e.key?(window.getSelection().anchorOffset>1&&(o()?"function"==typeof r.options.onlimit&&r.options.onlimit(r,r.options.limit):r.add("",!0)),e.preventDefault()):"Enter"==e.key?i&&i.isOpened()||(window.getSelection().anchorOffset>1&&(o()||r.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),i&&i.keydown(e)},g=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==p&&r.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():i&&i.keyup(e);c()},m=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var n=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(n=window.clipboardData.getData("Text"));var o=d(n);if("function"==typeof r.options.onbeforepaste){var i=r.options.onbeforepaste(t,r,o);if(!1===i)return e.preventDefault(),!1;i&&(o=i)}o.length>1?(r.add(o,!0),e.preventDefault()):o[0]&&(document.execCommand("insertText",!1,o[0]),e.preventDefault())},v=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();n.width-(e.clientX-n.left)<16&&r.remove(e.target)}e.target==t&&s()},y=function(){t.classList.contains("jtags-focus")||(t.children.length&&!r.getValue(t.children.length-1)||o()||l(""),"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,r.getValue()),t.classList.add("jtags-focus"))},w=function(){if(t.classList.contains("jtags-focus")){i&&i.close();for(var e=0;e<t.children.length-1;e++)r.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof r.options.onblur&&r.options.onblur(t,r,r.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",v):t.addEventListener("mouseup",v),t.addEventListener("keydown",h),t.addEventListener("keyup",g),t.addEventListener("paste",m),t.addEventListener("focus",y),t.addEventListener("blur",w),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.tags=r,r},e.toolbar=function(t,n){var r={type:"toolbar",options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];!t&&n.app&&n.app.el&&(t=document.createElement("div"),n.app.el.appendChild(t));var a=document.createElement("div");a.classList.add("jtoolbar-item"),a.classList.add("jtoolbar-arrow");var s=document.createElement("div");s.classList.add("jtoolbar-floating"),a.appendChild(s),r.selectItem=function(e){for(var t=l.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},r.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},r.show=function(){t.style.display="",e.animation.slideBottom(t,1)},r.get=function(){return t},r.setBadge=function(e,t){l.children[e].children[1].firstChild.innerHTML=t},r.destroy=function(){toolbar.remove(),t.innerHTML=""},r.update=function(e,n){for(var o=0;o<l.children.length;o++)"function"==typeof(i=l.children[o]).updateState&&i.updateState(t,r,i,e,n);for(o=0;o<s.children.length;o++){var i;"function"==typeof(i=s.children[o]).updateState&&i.updateState(t,r,i,e,n)}},r.create=function(n){l.innerHTML="";for(var o=0;o<n.length;o++){var i=document.createElement("div");if(i.classList.add("jtoolbar-item"),n[o].width&&(i.style.width=parseInt(n[o].width)+"px"),n[o].k&&(i.k=n[o].k),n[o].tooltip&&i.setAttribute("title",n[o].tooltip),n[o].id&&i.setAttribute("id",n[o].id),n[o].updateState&&(i.updateState=n[o].updateState),n[o].active&&i.classList.add("jtoolbar-active"),"select"==n[o].type||"dropdown"==n[o].type)e.picker(i,n[o]);else if("divisor"==n[o].type)i.classList.add("jtoolbar-divisor");else if("label"==n[o].type)i.classList.add("jtoolbar-label"),i.innerHTML=n[o].content;else{var a=document.createElement("i");if(void 0===n[o].class)a.classList.add("material-icons");else for(var s=n[o].class.split(" "),u=0;u<s.length;u++)a.classList.add(s[u]);if(a.innerHTML=n[o].content?n[o].content:"",i.appendChild(a),1==r.options.badge){var c=document.createElement("div");c.classList.add("jbadge");var f=document.createElement("div");f.innerHTML=n[o].badge?n[o].badge:"",c.appendChild(f),i.appendChild(c)}if(n[o].title)if(1==r.options.title){var d=document.createElement("span");d.innerHTML=n[o].title,i.appendChild(d)}else i.setAttribute("title",n[o].title);r.options.app&&n[o].route&&(i.route=n[o].route,i.onclick=function(){r.options.app.pages(this.route)},r.options.app.pages(n[o].route,{toolbarItem:i,closed:!0}))}n[o].onclick&&(i.onclick=n[o].onclick.bind(n[o],t,r,i)),l.appendChild(i)}setTimeout((function(){r.refresh()}),0)},r.open=function(){a.classList.add("jtoolbar-arrow-selected"),t.getBoundingClientRect(),s.getBoundingClientRect().bottom>window.innerHeight||r.options.bottom?s.style.bottom="0":s.style.removeProperty("bottom"),s.style.right="0",a.children[0].focus(),e.tracking(r,!0)},r.close=function(){a.classList.remove("jtoolbar-arrow-selected"),e.tracking(r,!1)},r.refresh=function(){if(1==r.options.responsive){var e=t.parentNode.getBoundingClientRect();r.options.maxWidth||(r.options.maxWidth=e.width);var n=parseInt(r.options.maxWidth);for(a.parentNode&&a.parentNode.removeChild(a);s.firstChild;)l.appendChild(s.firstChild);if(n<l.offsetWidth)for(n-=50;l.lastChild&&n<l.offsetWidth;)s.insertBefore(l.lastChild,s.firstChild);s.children.length>0&&l.appendChild(a)}},t.onclick=function(t){var n=e.findElement(t.target,"jtoolbar-item");n&&r.selectItem(n),t.target.classList.contains("jtoolbar-arrow")&&r.open()},window.addEventListener("resize",(function(){r.refresh()})),t.classList.add("jtoolbar"),t.innerHTML="",1==r.options.container&&t.classList.add("jtoolbar-container");var l=document.createElement("div");return t.appendChild(l),r.options.app&&t.classList.add("jtoolbar-mobile"),r.create(r.options.items),t.toolbar=r,r},e.validations=function(){var e={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]}},t={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},n={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"=":function(e,t){return e===t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},r=function(e,t){return"function"==typeof r[t.type]?!(!t.allowBlank||""!==e)||r[t.type](e,t):null};return r.url=function(){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(data)},r.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},r.required=function(e){return!!e.trim()},r.number=function(t,n){if(r=t,isNaN(r)||null===r||""===r)return!1;var r;if(!n||!n.criteria)return!0;if(!e[n.criteria])return!1;var o=n.value.map((function(e){return parseFloat(e)}));return e[n.criteria](t,o)},r.login=function(e){var t=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!(!e||!t.test(e))},r.list=function(e,t){var n=typeof e;return("string"===n||"number"===n)&&t.value[0].split(",").findIndex((function(t){return t==e}))>-1},r.date=function(e,n){if("Invalid Date"==new Date(e))return!1;if(!n||!n.criteria)return!0;if(!t[n.criteria])return!1;var r=n.value.map((function(e){return new Date(e).getTime()}));return t[n.criteria](new Date(e).getTime(),r)},r.text=function(e,t){return"string"==typeof e&&(!t||!t.criteria||!!n[t.criteria]&&n[t.criteria](e,t.value))},r}(),e}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.d(r,{default:()=>sf});var e={};n.r(e),n.d(e,{call:()=>S,data:()=>I,div0:()=>x,error:()=>C,na:()=>L,name:()=>A,nil:()=>b,num:()=>N,ref:()=>T,spill:()=>D,undefined:()=>O,value:()=>M});var t={};n.r(t),n.d(t,{DATE:()=>pe,DATEDIF:()=>ge,DATEVALUE:()=>me,DAY:()=>ve,DAYS:()=>ye,DAYS360:()=>we,EDATE:()=>Ee,EOMONTH:()=>be,HOUR:()=>xe,INTERVAL:()=>Me,ISOWEEKNUM:()=>Ne,MINUTE:()=>Le,MONTH:()=>Ce,NETWORKDAYS:()=>Ie,NOW:()=>Se,SECOND:()=>De,TIME:()=>Oe,TIMEVALUE:()=>Re,TODAY:()=>je,WEEKDAY:()=>ke,WEEKNUM:()=>Ue,WORKDAY:()=>Pe,YEAR:()=>He,YEARFRAC:()=>Ve});var o={};n.r(o),n.d(o,{ARRAY:()=>Je,ARRAYFORMULA:()=>Ze,SINGLE:()=>et,getColumnName:()=>We,getColumnNameFromCoords:()=>ze,getCoordsFromColumnName:()=>$e,getRangeFromTokens:()=>Ke,getTokensFromRange:()=>Qe});var i={};n.r(i),n.d(i,{ASC:()=>ct,BAHTTEXT:()=>ft,CHAR:()=>dt,CLEAN:()=>pt,CODE:()=>ht,CONCAT:()=>mt,CONCATENATE:()=>gt,DBCS:()=>vt,DOLLAR:()=>yt,EXACT:()=>wt,FIND:()=>Et,FINDB:()=>bt,FIXED:()=>xt,HTML2TEXT:()=>Mt,LEFT:()=>Tt,LEFTB:()=>At,LEN:()=>Nt,LENB:()=>Lt,LOWER:()=>Ct,MID:()=>It,MIDB:()=>St,NUMBERVALUE:()=>Dt,PRONETIC:()=>Ot,PROPER:()=>Rt,REGEXEXTRACT:()=>jt,REGEXMATCH:()=>Ut,REGEXREPLACE:()=>kt,REPLACE:()=>Pt,REPLACEB:()=>Ht,REPT:()=>Ft,RIGHT:()=>Vt,RIGHTB:()=>Bt,SEARCH:()=>Yt,SEARCHB:()=>qt,SPLIT:()=>_t,SUBSTITUTE:()=>Xt,T:()=>Gt,TEXT:()=>Wt,TEXTJOIN:()=>zt,TRIM:()=>$t,UNICHAR:()=>Kt,UNICODE:()=>Zt,UPPER:()=>Qt,VALUE:()=>Jt});var a={};n.r(a),n.d(a,{BESSELI:()=>tn,BESSELJ:()=>nn,BESSELK:()=>rn,BESSELY:()=>on,BIN2DEC:()=>an,BIN2HEX:()=>sn,BIN2OCT:()=>ln,BITAND:()=>un,BITLSHIFT:()=>cn,BITOR:()=>fn,BITRSHIFT:()=>dn,BITXOR:()=>pn,COMPLEX:()=>hn,CONVERT:()=>gn,DEC2BIN:()=>mn,DEC2HEX:()=>vn,DEC2OCT:()=>yn,DELTA:()=>wn,ERF:()=>En,ERFC:()=>bn,GESTEP:()=>xn,HEX2BIN:()=>Mn,HEX2DEC:()=>Tn,HEX2OCT:()=>An,IMABS:()=>Nn,IMAGINARY:()=>Sn,IMARGUMENT:()=>Dn,IMCONJUGATE:()=>On,IMCOS:()=>Rn,IMCOSH:()=>jn,IMCOT:()=>kn,IMCOTH:()=>In,IMCSC:()=>$n,IMCSCH:()=>Kn,IMDIV:()=>Un,IMEXP:()=>Pn,IMLN:()=>Hn,IMLOG:()=>Ln,IMLOG10:()=>Fn,IMLOG2:()=>Vn,IMPOWER:()=>Bn,IMPRODUCT:()=>Yn,IMREAL:()=>qn,IMSEC:()=>_n,IMSECH:()=>Xn,IMSIN:()=>Gn,IMSINH:()=>Wn,IMSQRT:()=>zn,IMSUB:()=>Zn,IMSUM:()=>Qn,IMTAN:()=>Jn,IMTANH:()=>Cn,OCT2BIN:()=>er,OCT2DEC:()=>tr,OCT2HEX:()=>nr});var s={};n.r(s),n.d(s,{ERROR:()=>gr,INFO:()=>mr,ISBINARY:()=>vr,ISBLANK:()=>yr,ISDATE:()=>xr,ISEMAIL:()=>Mr,ISERR:()=>wr,ISERROR:()=>Er,ISEVEN:()=>br,ISFORMULA:()=>Tr,ISLOGICAL:()=>Ar,ISNA:()=>Nr,ISNONTEXT:()=>Lr,ISNUMBER:()=>Cr,ISODD:()=>Ir,ISREF:()=>Sr,ISTEXT:()=>Dr,N:()=>Or,NA:()=>Rr,SHEET:()=>jr,SHEETS:()=>kr,TYPE:()=>Ur});var l={};n.r(l),n.d(l,{ARGS2ARRAY:()=>Fr,FLATTEN:()=>Hr,GETJSON:()=>qr,JOIN:()=>Br,NUMBERS:()=>Yr,NUMERAL:()=>_r,REFERENCE:()=>Vr,UNIQUE:()=>Pr});var u={};n.r(u),n.d(u,{AVEDEV:()=>Xr,AVERAGE:()=>Gr,AVERAGEA:()=>Wr,AVERAGEIF:()=>zr,AVERAGEIFS:()=>$r,BETA:()=>Kr,BINOM:()=>Zr,CHISQ:()=>Qr,COLUMN:()=>eo,COLUMNS:()=>to,CONFIDENCE:()=>no,CORREL:()=>ro,COUNT:()=>oo,COUNTA:()=>io,COUNTBLANK:()=>so,COUNTIF:()=>lo,COUNTIFS:()=>uo,COUNTIN:()=>ao,COUNTUNIQUE:()=>co,COVARIANCE:()=>fo,DEVSQ:()=>po,EXPON:()=>ho,F:()=>go,FISHER:()=>mo,FISHERINV:()=>vo,FORECAST:()=>yo,FREQUENCY:()=>wo,GAMMA:()=>Eo,GAMMALN:()=>bo,GAUSS:()=>xo,GEOMEAN:()=>Mo,GROWTH:()=>To,HARMEAN:()=>Ao,HYPGEOM:()=>No,INTERCEPT:()=>Lo,KURT:()=>Co,LARGE:()=>Io,LINEST:()=>So,LOGEST:()=>Do,LOGNORM:()=>Oo,MAX:()=>Ro,MAXA:()=>jo,MAXIFS:()=>ko,MEDIAN:()=>Po,MIN:()=>Ho,MINA:()=>Fo,MINIFS:()=>Uo,MODE:()=>Vo,NEGBINOM:()=>Bo,NORM:()=>Yo,PEARSON:()=>qo,PERCENTILE:()=>_o,PERCENTRANK:()=>Xo,PERMUT:()=>Go,PERMUTATIONA:()=>Wo,PHI:()=>zo,POISSON:()=>$o,PROB:()=>Ko,QUARTILE:()=>Zo,RANK:()=>Qo,ROW:()=>Jo,ROWS:()=>ei,RSQ:()=>ti,SKEW:()=>ni,SLOPE:()=>ri,SMALL:()=>oi,STANDARDIZE:()=>ii,STDEV:()=>ai,STDEVA:()=>si,STDEVPA:()=>li,STEYX:()=>ui,T:()=>fi,TRANSPOSE:()=>ci,TREND:()=>di,TRIMMEAN:()=>pi,VAR:()=>hi,VARA:()=>gi,VARPA:()=>mi,WEIBULL:()=>vi,Z:()=>yi});var c={};n.r(c),n.d(c,{ABS:()=>wi,ACOS:()=>Ei,ACOSH:()=>bi,ACOT:()=>xi,ACOTH:()=>Mi,ADD:()=>Ti,AGGREGATE:()=>Ni,ARABIC:()=>Li,ASIN:()=>Ci,ASINH:()=>Ii,ATAN:()=>Si,ATAN2:()=>Di,ATANH:()=>Oi,BASE:()=>Ri,CEILING:()=>ki,COMBIN:()=>Ui,COMBINA:()=>Pi,COS:()=>Hi,COSH:()=>Fi,COT:()=>Vi,COTH:()=>Bi,CSC:()=>Yi,CSCH:()=>qi,DECIMAL:()=>_i,DEGREES:()=>Xi,DIVIDE:()=>Gi,E:()=>Ea,EQ:()=>zi,EVEN:()=>Wi,EXP:()=>$i,FACT:()=>Zi,FACTDOUBLE:()=>Qi,FLOOR:()=>Ji,GCD:()=>ea,GT:()=>Wa,GTE:()=>za,INT:()=>ta,ISO:()=>na,LCM:()=>ra,LN:()=>oa,LN10:()=>ia,LN2:()=>aa,LOG:()=>ua,LOG10:()=>ca,LOG10E:()=>sa,LOG2E:()=>la,LT:()=>$a,LTE:()=>Ka,MDETERM:()=>fa,MINUS:()=>Xa,MINVERSE:()=>da,MMULT:()=>pa,MOD:()=>ha,MROUND:()=>ga,MULTINOMIAL:()=>ma,MULTIPLY:()=>Ga,MUNIT:()=>va,NE:()=>Za,ODD:()=>ya,PI:()=>wa,POW:()=>Qa,POWER:()=>ba,PRODUCT:()=>xa,QUOTIENT:()=>Ma,RADIANS:()=>Ta,RAND:()=>Aa,RANDARRAY:()=>Na,RANDBETWEEN:()=>La,ROMAN:()=>Ca,ROUND:()=>Ia,ROUNDDOWN:()=>Sa,ROUNDUP:()=>Da,SEC:()=>Oa,SECH:()=>Ra,SEQUENCE:()=>ka,SERIESSUM:()=>ja,SIGN:()=>Ua,SIN:()=>Pa,SINH:()=>Ha,SQRT:()=>Fa,SQRT1_2:()=>Ba,SQRT2:()=>Ya,SQRTPI:()=>Va,SUBTOTAL:()=>_a,SUM:()=>Ja,SUMIF:()=>es,SUMIFS:()=>ts,SUMPRODUCT:()=>ns,SUMSQ:()=>rs,SUMX2MY2:()=>os,SUMX2PY2:()=>is,SUMXMY2:()=>as,TAN:()=>ss,TANH:()=>ls,TRUNC:()=>us});var f={};n.r(f),n.d(f,{BETADIST:()=>cs,BETAINV:()=>fs,BINOMDIST:()=>ds,CEILINGMATH:()=>ps,CEILINGPRECISE:()=>hs,CHIDIST:()=>gs,CHIDISTRT:()=>ms,CHIINV:()=>vs,CHIINVRT:()=>ys,CHITEST:()=>ws,COVAR:()=>Es,COVARIANCEP:()=>bs,COVARIANCES:()=>xs,CRITBINOM:()=>Ms,ERFCPRECISE:()=>Ts,ERFPRECISE:()=>As,EXPONDIST:()=>Ns,FDIST:()=>Ls,FDISTRT:()=>Cs,FINV:()=>Is,FINVRT:()=>Ss,FLOORMATH:()=>Ds,FLOORPRECISE:()=>Os,FTEST:()=>Rs,GAMMADIST:()=>js,GAMMAINV:()=>ks,GAMMALNPRECISE:()=>Us,HYPGEOMDIST:()=>Ps,LOGINV:()=>Hs,LOGNORMDIST:()=>Fs,LOGNORMINV:()=>Vs,MODEMULT:()=>Bs,MODESNGL:()=>Ys,NEGBINOMDIST:()=>qs,NETWORKDAYSINTL:()=>_s,NORMDIST:()=>Xs,NORMINV:()=>Gs,NORMSDIST:()=>Ws,NORMSINV:()=>zs,PERCENTILEEXC:()=>$s,PERCENTILEINC:()=>Ks,PERCENTRANKEXC:()=>Zs,PERCENTRANKINC:()=>Qs,POISSONDIST:()=>Js,QUARTILEEXC:()=>el,QUARTILEINC:()=>tl,RANKAVG:()=>nl,RANKEQ:()=>rl,SKEWP:()=>ol,STDEVP:()=>il,STDEVS:()=>al,TDIST:()=>sl,TDISTRT:()=>ll,TINV:()=>ul,TTEST:()=>cl,VARP:()=>fl,VARS:()=>dl,WEIBULLDIST:()=>pl,WORKDAYINTL:()=>hl,ZTEST:()=>gl});var d={};n.r(d),n.d(d,{DAVERAGE:()=>wl,DCOUNT:()=>El,DCOUNTA:()=>bl,DGET:()=>xl,DMAX:()=>Ml,DMIN:()=>Tl,DPRODUCT:()=>Al,DSTDEV:()=>Nl,DSTDEVP:()=>Ll,DSUM:()=>Cl,DVAR:()=>Il,DVARP:()=>Sl,FINDFIELD:()=>vl});var p={};n.r(p),n.d(p,{ACCRINT:()=>Rl,ACCRINTM:()=>jl,AMORDEGRC:()=>kl,AMORLINC:()=>Ul,COUPDAYBS:()=>Pl,COUPDAYS:()=>Hl,COUPDAYSNC:()=>Fl,COUPNCD:()=>Vl,COUPNUM:()=>Bl,COUPPCD:()=>Yl,CUMIPMT:()=>ql,CUMPRINC:()=>_l,DB:()=>Xl,DDB:()=>Gl,DISC:()=>Wl,DOLLARDE:()=>zl,DOLLARFR:()=>$l,DURATION:()=>Kl,EFFECT:()=>Zl,FV:()=>Ql,FVSCHEDULE:()=>Jl,INTRATE:()=>eu,IPMT:()=>tu,IRR:()=>nu,ISPMT:()=>ru,MDURATION:()=>ou,MIRR:()=>iu,NOMINAL:()=>au,NPER:()=>su,NPV:()=>lu,ODDFPRICE:()=>uu,ODDFYIELD:()=>cu,ODDLPRICE:()=>fu,ODDLYIELD:()=>du,PDURATION:()=>pu,PMT:()=>hu,PPMT:()=>gu,PRICE:()=>mu,PRICEDISC:()=>vu,PRICEMAT:()=>yu,PV:()=>wu,RATE:()=>Eu,RECEIVED:()=>bu,RRI:()=>xu,SLN:()=>Mu,SYD:()=>Tu,TBILLEQ:()=>Au,TBILLPRICE:()=>Nu,TBILLYIELD:()=>Lu,VDB:()=>Cu,XIRR:()=>Iu,XNPV:()=>Su,YIELD:()=>Du,YIELDDISC:()=>Ou,YIELDMAT:()=>Ru});var h={};n.r(h),n.d(h,{AND:()=>ku,CHOOSE:()=>Uu,FALSE:()=>Pu,IF:()=>Hu,IFERROR:()=>Vu,IFNA:()=>Bu,IFS:()=>Fu,NOT:()=>Yu,OR:()=>qu,SWITCH:()=>Gu,TRUE:()=>_u,XOR:()=>Xu});var g={};n.r(g),n.d(g,{ADDRESS:()=>Ju,AREAS:()=>ec,FORMULATEXT:()=>tc,GETPIVOTDATA:()=>nc,HLOOKUP:()=>cc,HYPERLINK:()=>rc,INDEX:()=>dc,INDIRECT:()=>ac,LOOKUP:()=>fc,MATCH:()=>zu,OFFSET:()=>sc,RTD:()=>lc,VLOOKUP:()=>uc});var m={};n.r(m),n.d(m,{ENCODEURL:()=>pc,IMPORTDATA:()=>hc,IMPORTFEED:()=>gc,IMPORTHTML:()=>mc,IMPORTRANGE:()=>vc,IMPORTXML:()=>yc,ISURL:()=>wc});var v={};n.r(v),n.d(v,{CUBEKPIMEMBER:()=>Ec,CUBEMEMBER:()=>bc,CUBEMEMBERPROPERTY:()=>xc,CUBERANKEDMEMBER:()=>Mc,CUBESET:()=>Tc,CUBESETCOUNT:()=>Ac,CUBEVALUE:()=>Nc});var y={};n.r(y),n.d(y,{TO_DATE:()=>Lc,TO_DOLLARS:()=>Cc,TO_PERCENT:()=>Ic,TO_PURE_NUMBER:()=>Sc,TO_TEXT:()=>Dc});var w={};n.r(w),n.d(w,{ISBETWEEN:()=>Oc,UMINUS:()=>Rc,UNARY_PERCENT:()=>jc,UPLUS:()=>kc});const E=function(){if(void 0===e)if("undefined"==typeof window)var e=function(e){return Buffer.from(e,"base64").toString()};else e=window.atob;var t=function(e){t.license=e,t.run()};return t.k=[74,50,48,50,48,33].join(""),t.apply=function(e,t){var n=jSuites.sha512,r="",o="";e.length>128&&(e=n(e));for(var i=0;i<128;i++){var a=e[i]?e[i].charCodeAt(0):0;r+=String.fromCharCode(54^a),o+=String.fromCharCode(92^a)}return n(o+n(r+t))},t.run=function(){if(void 0===t.result){t.result=1;try{if(t.license){var n=e(t.license);if((n=n.split(","))[1])if(n[1]=e(n[1]),n[0]!=t.apply(t.k,n[1]))t.result=3;else if(n[1]=JSON.parse(n[1]),n[1].date){if("undefined"!=typeof window&&window.location&&window.location.hostname)var r=window.location.hostname;else r="localhost";var o=r.split(".");(r=r.split(".")).length>2&&!jSuites.isNumeric(r[r.length-1])&&o.shift(),o=o.join("."),r=r.join("."),-1==n[1].domain.indexOf(o)&&-1==n[1].domain.indexOf(r)?t.result=4:n[1].scope&&n[1].scope.indexOf("formula")>=0?t.result=6:t.result=5}else t.result=4;else t.result=2}}catch(e){console.log(e)}}return t.result},t.label=function(){var e="";return t.result&&1!=t.result?2==t.result||3==t.result||4==t.result?e="A valid license is required":5==t.result&&(e="This plugin is not included on the scope of this license"):e="License required",e},t.status=function(){return t.result},t}(),b=new Error("#NULL!"),x=new Error("#DIV/0!"),M=new Error("#VALUE!"),T=new Error("#REF!"),A=new Error("#NAME?"),N=new Error("#NUM!"),L=new Error("#N/A"),C=new Error("#ERROR!"),I=new Error("#GETTING_DATA"),S=new Error("#CALC!"),D=new Error("#SPILL!"),O=new Error("#UNDEFINED!");var R=new RegExp(/^-?\d+(\.\d+)?$/);function j(e){const t={};let n,r=e.split("!",2);2===r.length?(t.sheet=r[0],n=r[1]):(t.sheet="",n=r[0]);let o=n.split(":",2);return t.start=o[0],2===o.length&&(t.end=o[1]),t}function k(e){var t=typeof e;if("number"===t)return e;if("boolean"===t)return+e;if("string"===t){const t=e.trim();if(R.test(t))return parseFloat(t);const n=new Date(e);if(!Number.isNaN(n.getTime()))return J(n);const r=P(e);return null!==r?r:e}return null===e?0:e}const U=/^(\d{2}):(\d{2})(?:(?::(\d{2}))|((?: AM)|(?: PM)))?$/,P=function(e){const t=U.exec(e);if(!U.test(e))return null;let n=parseInt(t[1]);if(t[4]){if(n<1||n>12)return e;" PM"===t[4]&&n<12?n+=12:" AM"===t[4]&&12===n&&(n=0)}else if(n<0||n>23)return e;let r=0;return r+=36e5*n,r+=6e4*parseInt(t[2]),t[3]&&(r+=1e3*parseInt(t[3])),r/Z};function H(e){if("string"==typeof e){const t=P(e);if(null!==t)return t}return"number"==typeof(e=k(e))&&e>=0?e%1:e}function F(e){return e&&e.reduce?e.reduce(((e,t)=>{const n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]})):e}function V(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function B(){let e=Y.apply(null,arguments);for(;!V(e);)e=F(e);return e}function Y(e){const t=[];return le(e,(e=>{t.push(e)})),t}function q(){const e=B.apply(null,arguments);return e.filter((e=>"number"==typeof e))}function _(e){const t=1e14;return Math.round(e*t)/t}function X(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if(null===e)return!1;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return M}function G(e){return e instanceof Error?e:null==e||""===e?0:("boolean"==typeof e&&(e=+e),isNaN(e)?M:parseFloat(e))}function W(e){return e instanceof Error?e:null==e?"":e.toString()}function z(e){let t,n;if(!e||0===(t=e.length))return M;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=G(e[t]),n instanceof Error)return n;e[t]=n}return e}var $=Date.UTC(1900,0,0),K=Date.UTC(1900,1,29),Z=864e5;function Q(e){var t=$+e*Z;return t>=K&&(t-=Z),new Date(t)}var J=function(e){var t=e.getTime();return t>=K&&(t+=Z),(t-=$)/Z};function ee(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?N:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),n=new Date(86400*t*1e3),r=e-Math.floor(e)+1e-7;let o=Math.floor(86400*r);const i=o%60;o-=i;const a=Math.floor(o/3600),s=Math.floor(o/60)%60;let l=n.getDate(),u=n.getMonth();return e>=60&&e<61&&(l=29,u=1),new Date(n.getFullYear(),u,l,a,s,i)}(t)}return"string"!=typeof e||(e=new Date(e),isNaN(e))?M:e}function te(e){let t,n=e.length;for(;n--;){if(t=ee(e[n]),t===M)return t;e[n]=t}return e}function ne(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function re(e){return null!=e}function oe(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function ie(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function ae(e){let t,n=e.length;for(;n--;)if(t=e[n],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const r=G(t);r instanceof Error?e[n]=0:e[n]=r}}else e[n]=0;else e[n]=1;return e}function se(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function le(e,t){let n=-1;const r=e.length;for(;++n<r&&!1!==t(e[n],n,e););return e}function ue(e){return e?e[0].map(((t,n)=>e.map((e=>e[n])))):M}new Date(Date.UTC(1900,0,1));const ce={1:0,2:1,11:1,12:2,13:3,14:4,15:5,16:6,17:0},fe={1:[1,2,3,4,5,6,7],2:[7,1,2,3,4,5,6],3:[6,0,1,2,3,4,5],11:[7,1,2,3,4,5,6],12:[6,7,1,2,3,4,5],13:[5,6,7,1,2,3,4],14:[4,5,6,7,1,2,3],15:[3,4,5,6,7,1,2],16:[2,3,4,5,6,7,1],17:[1,2,3,4,5,6,7]},de={1:[6,0],2:[0,1],3:[1,2],4:[2,3],5:[3,4],6:[4,5],7:[5,6],11:[0],12:[1],13:[2],14:[3],15:[4],16:[5],17:[6]};function pe(e,t,n){if(3!==arguments.length)return L;if((e=k(e))instanceof Error)return e;if("string"==typeof e)return M;if((t=k(t))instanceof Error)return t;if("string"==typeof t)return M;if((n=k(n))instanceof Error)return n;if("string"==typeof n)return M;e<1900&&(e+=1900);let r=new Date(Date.UTC(e,t-1,n));return r=J(r),r<0?N:r}var he={Y:function(e,t){const n=e.getUTCFullYear();let r=t.getUTCFullYear()-n;return(t.getUTCMonth()<e.getUTCMonth()||t.getUTCDate()<e.getUTCDate())&&r--,r},M:function(e,t){const n=e.getUTCFullYear(),r=t.getUTCFullYear(),o=e.getUTCMonth(),i=t.getUTCMonth(),a=e.getUTCDate();let s=12*(r-n)+(i-o);return t.getUTCDate()-a<0&&s--,s},D:function(e,t){const n=J(e);return J(t)-n},MD:function(e,t){const n=e.getUTCDate(),r=t.getUTCDate();return r>=n?r-n:31-(n-r)},YM:function(e,t){const n=e.getUTCMonth(),r=t.getUTCMonth();let o=r>=n?r-n:12-(n-r);return t.getUTCDate()<e.getUTCDate()&&o--,o},YD:function(e,t){const n=e.getUTCDate(),r=e.getUTCMonth(),o=t.getUTCDate(),i=t.getUTCMonth();if(i>r||i===r&&o>=n){const t=e.getUTCFullYear(),a=J(new Date(Date.UTC(t,r,n)));return J(new Date(Date.UTC(t,i,o)))-a}{const e=t.getUTCFullYear(),a=J(new Date(Date.UTC(e-1,r,n)));return J(new Date(Date.UTC(e,i,o)))-a}}};function ge(e,t,n){if(3!==arguments.length)return L;const r=ne(e,t,n);if(r)return r;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if("number"!=typeof(t=k(t)))return M;if(t<0||e>t)return N;if("string"!=typeof n)return N;n=n.toUpperCase();const o=he[n];if(void 0===o)return N;const i=Q(e),a=Q(t);return o(i,a)}function me(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("string"==typeof e){const t=new Date(e);if(!Number.isNaN(t.getTime()))return J(t)}return M}function ve(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("string"==typeof(e=k(e)))return M;if(e<0)return N;if(0===e)return 0;const t=Q(e);return t.getUTCDate()}function ye(e,t){if(2!==arguments.length)return L;const n=ne(t,e);return n||(t=k(t),e=k(e),"string"==typeof t||"string"==typeof e?M:(t=Math.trunc(t),(e=Math.trunc(e))-t))}function we(e,t,n=!1){if(arguments.length<2||arguments.length>3)return L;const r=ne(e,t,n);if(r)return r;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if("number"!=typeof(t=k(t)))return M;if(t<0)return N;if("boolean"!=typeof(n=X(n)))return M;e=Q(e),t=Q(t);const o=e.getUTCMonth();let i,a,s=t.getUTCMonth();if(n)i=31===e.getUTCDate()?30:e.getUTCDate(),a=31===t.getUTCDate()?30:t.getUTCDate();else{const n=new Date(e.getTime());n.setDate(n.getDate()+1),i=o!==n.getUTCMonth()?30:e.getUTCDate();const r=new Date(t.getTime());r.setDate(r.getDate()+1),t.getUTCDate()>=30?i<30?(s++,a=1):a=30:a=t.getUTCDate()}return 360*(t.getUTCFullYear()-e.getUTCFullYear())+30*(s-o)+(a-i)}function Ee(e,t){if(2!==arguments.length)return L;const n=ne(e,t);if(n)return n;const r=[e,t].some((e=>"boolean"==typeof e));if(r)return M;if("string"==typeof(e=k(e)))return M;if(e<0)return N;if("string"==typeof(t=k(t)))return M;e=Math.trunc(e),t=Math.trunc(t);const o=(e=Q(e)).getUTCMonth()+t;return e.setUTCMonth(o),e.getUTCMonth()!==o%12&&e.setDate(-1),J(e)}function be(e,t){const n=Ee(...arguments);if(n instanceof Error)return n;const r=Q(n);return r.setUTCMonth(r.getUTCMonth()+1),r.setUTCDate(0),J(r)}function xe(e){return 1!==arguments.length?L:e instanceof Error?e:"number"!=typeof(e=H(e))?M:e<0?N:Math.trunc(Math.round(24*e*1e8)/1e8)}function Me(e){if("number"!=typeof e&&"string"!=typeof e)return M;e=parseInt(e,10);let t=Math.floor(e/94608e4);e%=94608e4;let n=Math.floor(e/2592e3);e%=2592e3;let r=Math.floor(e/86400);e%=86400;let o=Math.floor(e/3600);e%=3600;let i=Math.floor(e/60),a=e%=60;return t=t>0?t+"Y":"",n=n>0?n+"M":"",r=r>0?r+"D":"",o=o>0?o+"H":"",i=i>0?i+"M":"",a=a>0?a+"S":"","P"+t+n+r+"T"+o+i+a}var Te=864e5;const Ae=e=>{const t=e=>Math.round(e+e/4-e/100+e/400)%7;return 4===t(e)||3===t(e-1)?53:52};function Ne(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;const t=Q(e);var n=new Date(Date.UTC(t.getUTCFullYear(),0,1));const r=t.getTime()-n.getTime()+Te,o=r/Te;let i=t.getUTCDay();i--,i<0&&(i+=7),i++;let a=Math.trunc((10+o-i)/7);return 0===a?Ae(t.getUTCFullYear()-1):a>Ae(t.getUTCFullYear())?1:a}function Le(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("number"!=typeof(e=H(e)))return M;if(e<0)return N;const t=24*e*60%60;return Math.trunc(t)}function Ce(e){return 1!==arguments.length?L:e instanceof Error?e:"number"!=typeof(e=k(e))?M:e<0?N:0===e?1:(e=Q(e)).getUTCMonth()+1}function Ie(e,t,n){return arguments.length<2||arguments.length>3?L:Ie.INTL(e,t,1,n)}function Se(){if(0!==arguments.length)return L;const e=new Date;return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),J(e)}function De(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("number"!=typeof(e=H(e)))return M;if(e<0)return N;const t=24*e*60*60%60;return Math.round(t)}function Oe(e,t,n){if(3!==arguments.length)return L;const r=ne(e,t,n);if(r)return r;if("number"!=typeof(e=k(e)))return M;if("number"!=typeof(t=k(t)))return M;if("number"!=typeof(n=k(n)))return M;const o=(3600*e+60*t+n)/86400;return o<0?N:o%1}function Re(e){return 1!==arguments.length?L:e instanceof Error?e:"string"!=typeof e||"number"!=typeof(e=H(e))?M:e%1}function je(){if(arguments.length>0)return L;const e=new Date;return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.setUTCHours(0,0,0,0),J(e)}function ke(e,t){if(arguments.length<1||arguments.length>2)return L;const n=ne(e,t);if(n)return n;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if(null===t)return N;if(void 0===t&&(t=1),"number"!=typeof(t=k(t)))return M;if(!fe[t])return N;const r=Q(e).getUTCDay();return fe[t][r]}function Ue(e,t){if(arguments.length<1||arguments.length>2)return L;const n=ne(e,t);if(n)return n;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if(void 0===t&&(t=1),"number"!=typeof(t=k(t)))return M;if(21===t)return Ne(e);const r=ce[t];if(void 0===r)return N;const o=Q(e),i=new Date(Date.UTC(o.getUTCFullYear(),0,1)),a=J(i);let s=i.getUTCDay()-r;s<0&&(s+=7);const l=e-a+1,u=Math.trunc((l-1+s)/7)+1;return u}function Pe(e,t,n){return arguments.length<2||arguments.length>3?L:Pe.INTL(e,t,1,n)}function He(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;const t=Q(e);return t.getUTCFullYear()}function Fe(e){return 1===new Date(e,1,29).getMonth()}function Ve(e,t,n){if(arguments.length<2||arguments.length>3)return L;const r=ne(e,t,n);if(r)return r;if("boolean"==typeof e||"boolean"==typeof t||"boolean"==typeof n)return M;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if("number"!=typeof(t=k(t)))return M;if(t<0)return N;if(e>t){const n=t;t=e,e=n}const o=Q(e),i=Q(t);if("number"!=typeof(n=k(n=n??0)))return M;switch(n){case 0:return we(e,t)/360;case 1:{let n=o.getUTCDate();const r=o.getUTCMonth()+1,a=o.getUTCFullYear();let s=i.getUTCDate();const l=i.getUTCMonth()+1,u=i.getUTCFullYear(),c=(e,t)=>{const n=e.getUTCFullYear(),r=new Date(n,2,1);if(Fe(n)&&e<r&&t>=r)return!0;const o=t.getFullYear(),i=new Date(o,2,1);return Fe(o)&&t>=i&&e<i};if(a===u||a+1===u&&(r>l||r===l&&n>=s)){let n=365;return(a===u&&Fe(a)||c(o,i)||1===l&&29===s)&&(n=366),(t-e)/n}const f=u-a+1;return(t-e)/((J(new Date(Date.UTC(u+1,0,1)))-J(new Date(Date.UTC(a,0,1))))/f)}case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return we(e,t,!0)/360}}Ie.INTL=function(e,t,n,r){if(arguments.length<2||arguments.length>4)return L;const o=ne(e,t);if(o)return o;if(e=k(e),t=k(t),"number"!=typeof e||"number"!=typeof t)return M;if(e<0||t<0)return N;if(n instanceof Error)return M;if(null===n)return N;if(void 0===n)n=1;else if("boolean"==typeof n){if(!1===n)return N;n=1}const i=typeof n;let a;if("number"===i){if(a=de[n],void 0===a)return N}else if("string"===i){if(7!==n.length)return M;if((n=n.split("")).some((e=>"0"!==e&&"1"!==e)))return M;a=[];for(let e=0;e<n.length;e++)"1"===n[e]&&a.push(e);a=a.map((e=>{let t=e+1;return t>6&&(t-=7),t}))}let s=!1;if(t<e){let n=e;e=t,t=n,s=!0}let l=0;const u=Q(e),c=Q(t);let f=e;const d=u.getUTCDay();if(0!==d){const e=a.filter((e=>e>=d));l=7-d-e.length,f=f+7-d}let p=t;const h=c.getUTCDay();if(6!==h){const e=a.filter((e=>e<=h));l+=h+1-e.length,p=p-h-1}const g=(p-f+1)/7;if(l+=g*(7-a.length),void 0!==r){Array.isArray(r)||(r=[r]),r=r.flat(2);for(let n=0;n<r.length;n++){if(r[n]instanceof Error)return r[n];let o=k(r[n]);if("number"!=typeof o)return M;if(o<0)return N;if(o>=e&&o<=t){const e=Q(o);a.includes(e.getUTCDay())||l--}}}return s&&(l*=-1),l},Pe.INTL=function(e,t,n,r){if(arguments.length<2||arguments.length>4)return L;const o=ne(e,t,n);if(o)return o;if("boolean"==typeof e)return M;if("number"!=typeof(e=k(e)))return M;if(e<0)return N;if("boolean"==typeof t)return M;if("number"!=typeof(t=k(t)))return M;const i=Q(e);let a;void 0!==n&&!0!==n||(n=1);const s=typeof n;if("string"===s){if(7!==n.length)return M;if((n=n.split("")).some((e=>"0"!==e&&"1"!==e))||n.every((e=>"1"===e)))return M;a=[];for(let e=0;e<n.length;e++)"1"===n[e]&&a.push(e);a=a.map((e=>{let t=e+1;return t>6&&(t-=7),t}))}else a=de[n];if(void 0===a)return N;let l=e;const u=7-a.length,c=t<0?-1:1;let f=Math.trunc(t/u),d=t%u;d||(f-=c,d=t-f*u),f&&(l+=7*f);const p=new Date(i.getTime());for(;0!==d;)p.setUTCDate(p.getUTCDate()+c),l+=c,a.includes(p.getUTCDay())||(d-=c);if(r){Array.isArray(r)||(r=[r]),r=r.flat(2);const t=ne(...r);if(t)return t;try{r=r.map((e=>{if(e instanceof Error)throw e;const t=k(e);if("number"!=typeof t)throw M;if(t<0)throw N;return t}))}catch(e){return e}let n=r.find((t=>t>=e&&t<=l||t>=l&&t<=e));for(;n;){const t=Q(n);if(!a.includes(t.getUTCDay()))for(var h=!1;!h;)p.setUTCDate(p.getUTCDate()+c),l+=c,a.includes(p.getUTCDay())||(h=!0);r=r.filter((e=>e!==n)),n=r.find((t=>t>=e&&t<=l||t>=l&&t<=e))}}return l<0?N:l};var Be=n(765),Ye=n.n(Be),qe=n(162),_e=n.n(qe),Xe=n(551),Ge=n.n(Xe);function We(e){var t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)}function ze(e,t){return We(parseInt(e))+(parseInt(t)+1)}function $e(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);--n<0&&(n=0);var o=parseInt(/[0-9]+$/.exec(e))||null;return o>0&&o--,[n,o]}}function Ke(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",r=0;r<e.length;r++)e[r].indexOf(".")>=0?t=".":e[r].indexOf("!")>=0&&(t="!"),t&&(n=e[r].split(t),e[r]=n[1],n=n[0]+t);return e.sort((function(e,t){var n=$e(e),r=$e(t);return n[1]>r[1]?1:n[1]<r[1]?-1:n[0]>r[0]?1:n[0]<r[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"}var Ze=Ke;function Qe(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";var n=$e((e=e.split(":"))[0]),r=$e(e[1]);if(n[0]<=r[0])var o=n[0],i=r[0];else o=r[0],i=n[0];if(null===n[1]&&null==r[1]){var a=null,s=null,l=Object.keys(this.vars);l=""===t?l.filter((function(e){return!e.includes(".")&&!e.includes("!")})):(l=l.filter((function(e){return e.startsWith(t)}))).map((function(e){return e.slice(t.length)}));for(var u=0;u<l.length;u++){var c=$e(l[u]);c[0]===n[0]&&(null===a||c[1]<a)&&(a=c[1]),c[0]===r[0]&&(null===s||c[1]>s)&&(s=c[1])}}else n[1]<=r[1]?(a=n[1],s=r[1]):(a=r[1],s=n[1]);for(var f=[],d=a;d<=s;d++){var p=[];for(u=o;u<=i;u++)p.push(t+ze(u,d));f.push(p)}return f}function Je(){return[...arguments]}function et(e){if(Array.isArray(e)){if(e[0].length>1)return M;var t=JSON.parse(this.request.v);if(this.k[0]&&(t=t[this.k[0]]||this.k[0])){var n=2===(t=t.split("!")).length?t[1]:t[0];if(n&&(t=n.split(":"))[0]){if(t=$e(t[0]),(t=this.y-t[1])>e.length||t<0)return M;if(void 0!==e[t][0])return e[t][0]}}return e[0]}return e}var tt=new RegExp(/^-?\d+(\.\d+)?$/),nt=function(e){return Array.isArray(e)?1===e.length?"line":e.every((function(e){return 1===e.length}))?"column":"matrix":"number"},rt=function(e,t,n){var[r,o]=function(e,t){var n=["number","line","column","matrix"];if(nt(e)===nt(t)){var r=nt(e);return"column"===r?[e,t].sort((function(e,t){return t.length-e.length})):"line"===r?[e,t].sort((function(e,t){return t[0].length-e[0].length})):[e,t]}return[e,t].sort((function(e,t){return n.indexOf(nt(t))-n.indexOf(nt(e))}))}(e,t),i=nt(r),a=nt(o);if("matrix"===i){if(i===a){for(var s=Math.max(r.length,o.length),l=Math.max(r[0].length,o[0].length),u=[],c=0;c<s;c++){for(var f=[],d=0;d<l;d++)c<r.length&&d<r[c].length&&c<o.length&&d<o[c].length?f.push(n(r[c][d],o[c][d])):f.push(null);u.push(f)}return u}if("line"===a){for(l=Math.max(r[0].length,o[0].length),u=[],c=0;c<r.length;c++){for(f=[],d=0;d<l;d++)c<r.length&&d<r[c].length&&d<o[0].length?f.push(n(r[c][d],o[0][d])):f.push(null);u.push(f)}return u}if("column"===a){for(s=Math.max(r.length,o.length),u=[],c=0;c<s;c++){for(f=[],d=0;d<r[0].length;d++)c<r.length&&d<r[c].length&&c<o.length?f.push(n(r[c][d],o[c][0])):f.push(null);u.push(f)}return u}return r.map((function(e){return e.map((function(e){return n(e,o)}))}))}if("column"===i){if(i===a)return r.map((function(e,t){return t<o.length?[n(e[0],o[t][0])]:[null]}));if("line"===a){var p=[];for(c=0;c<r.length;c++){for(f=[],d=0;d<o[0].length;d++)f.push(n(r[c][0],o[0][d]));p.push(f)}return p}return r.map((function(e){return[n(e[0],o)]}))}return"line"===i?i===a?[r[0].map((function(e,t){return t<o[0].length?n(e,o[0][t]):null}))]:[r[0].map((function(e){return n(e,o)}))]:n(e,t)},ot=function(e,t,n){var r=nt(e),o=nt(t);if("matrix"===r){if("matrix"===o){for(var i=Math.max(e.length,t.length),a=Math.max(e[0].length,t[0].length),s=[],l=0;l<i;l++){for(var u=[],c=0;c<a;c++)l<e.length&&c<e[l].length&&l<t.length&&c<t[l].length?u.push(n(e[l][c],t[l][c])):u.push(null);s.push(u)}return s}if("column"===o){for(i=Math.max(e.length,t.length),s=[],l=0;l<i;l++){for(u=[],c=0;c<e[0].length;c++)l<e.length&&c<e[l].length&&l<t.length?u.push(n(e[l][c],t[l][0])):u.push(null);s.push(u)}return s}if("line"===o){for(a=Math.max(e[0].length,t[0].length),s=[],l=0;l<e.length;l++){for(u=[],c=0;c<a;c++)l<e.length&&c<e[l].length&&c<t[0].length?u.push(n(e[l][c],t[0][c])):u.push(null);s.push(u)}return s}return e.map((function(e){return e.map((function(e){return n(e,t)}))}))}if("column"===r){if("matrix"===o){for(i=Math.max(e.length,t.length),s=[],l=0;l<i;l++){for(u=[],c=0;c<t[0].length;c++)l<e.length&&l<t.length&&c<t[l].length?u.push(n(e[l][0],t[l][c])):u.push(null);s.push(u)}return s}if("column"===o){for(i=Math.max(e.length,t.length),s=[],l=0;l<i;l++)u=[],l<e.length&&l<t.length?u.push(n(e[l][0],t[l][0])):u.push(null),s.push(u);return s}return"line"===o?e.map((function(e){return t[0].map((function(t){return n(e[0],t)}))})):e.map((function(e){return[n(e[0],t)]}))}if("line"===r){if("matrix"===o){for(a=Math.max(e[0].length,t[0].length),s=[],l=0;l<t.length;l++){for(u=[],c=0;c<a;c++)c<e[0].length&&l<t.length&&c<t[l].length?u.push(n(e[0][c],t[l][c])):u.push(null);s.push(u)}return s}if("column"===o){for(s=[],l=0;l<t.length;l++){for(u=[],c=0;c<e[0].length;c++)u.push(n(e[0][c],t[l][0]));s.push(u)}return s}if("line"===o){var f=Math.max(e[0].length,t[0].length);for(s=[],l=0;l<f;l++)l<e[0].length&&l<t[0].length?s.push(n(e[0][l],t[0][l])):s.push(null);return[s]}return[e[0].map((function(e){return n(e,t)}))]}if("number"===r)return"matrix"===o?t.map((function(t){return t.map((function(t){return n(e,t)}))})):"column"===o?t.map((function(t){return[n(e,t[0])]})):"line"===o?[t[0].map((function(t){return n(e,t)}))]:n(e,t)},it=function(e,t,n){if(e instanceof Error)return e;if(t instanceof Error)return t;if(null===e&&(e=0),null===t&&(t=0),"string"==typeof e){if(e=e.trim(),!tt.test(e))return M;e=parseFloat(e)}if("string"==typeof t){if(t=t.trim(),!tt.test(t))return M;t=parseFloat(t)}var r=n(e,t);return r instanceof Error||!Number.isNaN(r)&&Number.isFinite(r)?r:N},at={number:0,string:"",boolean:!1},st=function(e,t,n){return e instanceof Error?e:t instanceof Error?t:(null===e&&null!==t?e=at[typeof t]:null===t&&null!==e&&(t=at[typeof e]),n(e,t))};const lt={"+":function(e,t){return rt(e,t,(function(e,t){return it(e,t,(function(e,t){return e+t}))}))},"-":function(e,t){return ot(e,t,(function(e,t){return it(e,t,(function(e,t){return e-t}))}))},"*":function(e,t){return rt(e,t,(function(e,t){return it(e,t,(function(e,t){return e*t}))}))},"/":function(e,t){return ot(e,t,(function(e,t){return it(e,t,(function(e,t){return 0===t?x:e/t}))}))},"^":function(e,t){return ot(e,t,(function(e,t){return it(e,t,(function(e,t){return Math.pow(e,t)}))}))},"&":function(e,t){return ot(e,t,(function(e,t){if(null===e)e="";else{if(e instanceof Error)return e;if("string"!=typeof e){if("function"!=typeof e.toString)return M;e=e.toString()}}if(null===t)t="";else{if(t instanceof Error)return t;if("string"!=typeof t){if("function"!=typeof t.toString)return M;t=t.toString()}}return e+t}))}};lt["=="]=lt["="]=function(e,t){return rt(e,t,(function(e,t){return"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase()),st(e,t,(function(e,t){return e===t}))}))},lt["<>"]=lt["!="]=function(e,t){return rt(e,t,(function(e,t){return"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase()),st(e,t,(function(e,t){return e!==t}))}))},lt[">"]=function(e,t){return ot(e,t,(function(e,t){return st(e,t,(function(e,t){return e>t}))}))},lt[">="]=function(e,t){return ot(e,t,(function(e,t){return st(e,t,(function(e,t){return e>=t}))}))},lt["<"]=function(e,t){return ot(e,t,(function(e,t){return st(e,t,(function(e,t){return e<t}))}))},lt["<="]=function(e,t){return ot(e,t,(function(e,t){return st(e,t,(function(e,t){return e<=t}))}))},lt.OP_MINUS=function(e){return Array.isArray(e)?e.map((function(e){return lt.OP_MINUS(e)})):e instanceof Error?e:"number"==typeof(e=k(e))?-e:M},lt.TABLE=function(){return this.instance},lt.CELL=function(){return ze(this.x,this.y)},lt.VAL=function(e,t,n){return void 0===e&&void 0===t&&(e=this.x,t=this.y),"string"==typeof e&&void 0===t?parseFloat(e):this.instance.getValueFromCoords(parseInt(e)-1,parseInt(t)-1,n)},lt.THISROWCELL=function(e){return this.instance.getValueFromCoords(parseInt(e)-1,parseInt(this.y))},lt.TRUE=function(){return!0},lt.FALSE=function(){return!1},lt.NULL=function(){return null};const ut=lt;function ct(){throw new Error("ASC is not implemented")}function ft(){throw new Error("BAHTTEXT is not implemented")}function dt(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>dt(e))):(!0===e&&(e=1),""===e?N:e<1||0===(e=G(e))?M:e instanceof Error?e:String.fromCharCode(e))}function pt(e){if(1!==arguments.length)return L;if(""===e)return"";if(Array.isArray(e))return e.map((e=>pt(e)));if((e=W(e))instanceof Error)return e;const t=/[\0-\x1F]/g;return(e=e||"").replace(t,"")}function ht(e){if(1!==arguments.length)return L;if(Array.isArray(e))return e.map((e=>ht(e)));if("boolean"!=typeof e&&"number"!=typeof e||(e=e.toString()),oe(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=M),t}const gt=mt;function mt(){const e=B(arguments),t=ne.apply(void 0,e);if(0===arguments.length)return L;if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let r=0;for(;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")}function vt(){throw new Error("DBCS is not implemented")}function yt(){throw new Error("DOLLAR is not implemented")}function wt(e,t){if(2!==arguments.length)return L;const n=ne(e,t);return n||(e=W(e))===W(t)}function Et(e,t,n){if(arguments.length<2||arguments.length>3)return L;if(Array.isArray(t))return t.map((t=>Et(e,t,n)));if(null===e&&null===t&&void 0===n)return 1;e=W(e),t=W(t);const r=parseInt(n);if(isNaN(r)&&void 0!==n)return M;n=void 0===n?0:n;const o=t.indexOf(e,n-1);return-1===o?M:o+1}function bt(){throw new Error("FINDB is not implemented")}function xt(){throw new Error("FIXED is not implemented")}function Mt(e){if(oe(e))return e;let t="";return e&&(e instanceof Array?e.forEach((e=>{""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t}function Tt(e,t){const n=ne(e,t);return arguments.length<1||arguments.length>2?L:Array.isArray(e)?e.map((e=>Tt(e,t))):n||(e=W(e),(t=G(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?M:e.substring(0,t))}function At(){throw new Error("LEFTB is not implemented")}function Nt(e){if(1!==arguments.length)return L;if(Array.isArray(e))return e.map((e=>Nt(e)));if(e instanceof Error)return e;if(Array.isArray(e))return M;const t=W(e);return t.length}function Lt(){throw new Error("LENB is not implemented")}function Ct(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Ct(e))):oe(e=W(e))?e:e.toLowerCase()}function It(e,t,n){if(3!==arguments.length)return L;const r=ne(e,t,n);if(r)return r;if(null==t)return M;if(t=k(t),n=k(n),"string"==typeof t||"string"==typeof n)return M;if(Array.isArray(e))return e.map((e=>It(e,t,n)));if(null===e)return"";const o=typeof e;"boolean"===o?e=e.toString().toUpperCase():"number"===o&&(e=e.toString());const i=t-1,a=i+n;return e.substring(i,a)}function St(){throw new Error("MIDB is not implemented")}function Dt(e,t,n){return t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,""))}function Ot(){throw new Error("PRONETIC is not implemented")}function Rt(e){return 1!==arguments.length?L:oe(e)?e:isNaN(e)&&"number"==typeof e?M:Array.isArray(e)?e.map((e=>Rt(e))):(e=W(e)).replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}function jt(e,t){if(arguments.length<2)return L;const n=e.match(new RegExp(t));return n?n[n.length>1?n.length-1:0]:null}function kt(e,t,n){return arguments.length<3?L:e.replace(new RegExp(t),n)}function Ut(e,t,n){if(arguments.length<2)return L;const r=e.match(new RegExp(t));return n?r:!!r}function Pt(e,t,n,r){if(4!==arguments.length)return L;const o=ne(e,t,n,r);return o||(Array.isArray(e)?e.map((e=>Pt(e,t,n,r))):""===t||null===t||0===t||""===n||null===n?M:(t=G(t),n=G(n),"boolean"==typeof e&&(e=e.toString().toUpperCase()),"boolean"==typeof r&&(r=r.toString().toUpperCase()),e=e.toString(),r=r.toString(),oe(t,n)||"string"!=typeof e||"string"!=typeof r?M:e.substr(0,t-1)+r+e.substr(t-1+n)))}function Ht(){throw new Error("REPLACEB is not implemented")}function Ft(e,t){return ne(e,t)||(e=W(e),(t=G(t))instanceof Error?t:new Array(t+1).join(e))}function Vt(e,t){const n=ne(e,t);return arguments.length<1||arguments.length>2?L:Array.isArray(e)?e.map((e=>Vt(e,t))):n||(e=W(e),(t=G(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))}function Bt(){throw new Error("RIGHTB is not implemented")}function Yt(e,t,n){let r;return arguments.length<2||arguments.length>3?L:Array.isArray(t)?t.map((t=>Yt(e,t,n))):e||t?(e=e.toString(),t=t.toString(),n=void 0===n?0:n,r=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===r?M:r):M}function qt(){throw new Error("SEARCHB is not implemented")}function _t(e,t){return e.split(t)}function Xt(e,t,n,r){if(arguments.length<3||arguments.length>4)return L;if(null===n&&(n=""),null===e&&(e=""),"boolean"==typeof e&&(e=e.toString().toUpperCase()),"boolean"==typeof n)return e;if("boolean"==typeof r)return M;if(e&&t){if(void 0===r)return e.split(t).join(n);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return M;let o=e.indexOf(t),i=0;for(;o>-1;){if(i++,i===r)return e.substring(0,o)+n+e.substring(o+t.length);o=e.indexOf(t,o+1)}return e}}return e}function Gt(e){return e instanceof Error||"string"==typeof e?e:""}function Wt(e,t){if(2!==arguments.length)return L;null===e?e=0:"boolean"==typeof e&&(e=e.toString().toUpperCase());const n=Ge().mask.extract(e,{mask:t},!0);return"datetime"===n.type?e=Ge().calendar.getDateString(e,{mask:t}):"number"!=n.type&&"numeric"!=n.type&&"percent"!=n.type&&"currency"!=n.type||n&&""!==n.value&&(e=n.value),Ge().mask.render(e,{mask:t},!0)}function zt(e,t,...n){if(arguments.length<3)return L;if(null!==t&&"boolean"!=typeof t&&(t=X(t)),t===M)return M;e=e??"";let r=B(n),o=t?r.filter((e=>e)):r;if(Array.isArray(e)){e=B(e);let t=o.map((e=>[e])),n=0;for(let r=0;r<t.length-1;r++)t[r].push(e[n]),n++,n===e.length&&(n=0);return o=B(t),o.join("")}return o.join(e)}function $t(e){return 1!==arguments.length?L:null===e?"":""===e?O:Array.isArray(e)?e.map((e=>$t(e))):(e=W(e))instanceof Error?e:e.replace(/\s+/g," ").trim()}const Kt=dt,Zt=ht;function Qt(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Qt(e))):(e=W(e))instanceof Error?e:e.toUpperCase()}function Jt(e,t,n){if(arguments.length>1)return ut.VAL(e,t,n);const r=ne(e);if(r)return r;if("string"!=typeof e)return M;const o=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return M;let i=Number(e);return isNaN(i)?M:(i=i||0,o&&(i*=.01),i)}function en(e){return/^[01]{1,10}$/.test(e)}function tn(e,t){return oe(e=G(e),t=G(t))?M:Ye().besseli(e,t)}function nn(e,t){return oe(e=G(e),t=G(t))?M:Ye().besselj(e,t)}function rn(e,t){return oe(e=G(e),t=G(t))?M:Ye().besselk(e,t)}function on(e,t){return oe(e=G(e),t=G(t))?M:Ye().bessely(e,t)}function an(e){if(!en(e))return N;const t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t}function sn(e,t){if(!en(e))return N;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const r=parseInt(e,2).toString(16);return void 0===t?r:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=r.length?Ft("0",t-r.length)+r:N}function ln(e,t){if(!en(e))return N;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);const r=parseInt(e,2).toString(8);return void 0===t?r:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=r.length?Ft("0",t-r.length)+r:N}function un(e,t){return oe(e=G(e),t=G(t))?M:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?N:e&t}function cn(e,t){return oe(e=G(e),t=G(t))?M:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?N:t>=0?e<<t:e>>-t}function fn(e,t){return oe(e=G(e),t=G(t))?M:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?N:e|t}function dn(e,t){return oe(e=G(e),t=G(t))?M:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?N:t>=0?e>>t:e<<-t}function pn(e,t){return oe(e=G(e),t=G(t))?M:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?N:e^t}function hn(e,t,n){if(oe(e=G(e),t=G(t)))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return M;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();{const r=t>0?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)}}function gn(e,t,n){if(3!==arguments.length||null===t||null===n)return L;if(""===e||"boolean"==typeof e||"boolean"==typeof t||"boolean"==typeof n)return M;if((e=G(e))instanceof Error)return e;const r=[[["g"],"mass"],[["sg"],"mass",e=>e/14593.9029372064,e=>14593.9029372064*e],[["lbm"],"mass",e=>e/453.59237,e=>453.59237*e],[["u"],"mass",e=>60221366516752e10*e,e=>16605402e-31*e],[["ozm"],"mass",e=>e/28.349523125,e=>28.349523125*e],[["grain"],"mass",e=>15.4323583529*e,e=>e/15.4323583529],[["cwt","shweight"],"mass",e=>22046226218488e-18*e,e=>e/22046226218488e-18],[["uk_cwt","lcwt","hweight"],"mass",e=>19684130552221e-18*e,e=>e/19684130552221e-18],[["stone"],"mass",e=>e/6350.29318,e=>6350.29318*e],[["ton"],"mass",e=>e/907184.74,e=>907184.74*e],[["uk_ton","LTON","brton"],"mass",e=>e/1016046.9088,e=>1016046.9088*e],[["m"],"distance"],[["mi"],"distance",e=>e/1609.344,e=>1609.344*e],[["Nmi"],"distance",e=>e/1852,e=>1852*e],[["in"],"distance",e=>e/.0254,e=>.0254*e],[["ft"],"distance",e=>e/.3048,e=>.3048*e],[["yd"],"distance",e=>e/.9144,e=>.9144*e],[["ang"],"distance",e=>e/1e-10,e=>1e-10*e],[["ell"],"distance",e=>e/1.143,e=>1.143*e],[["ly"],"distance",e=>1057e-19*e,e=>e/1057e-19],[["parsec","pc"],"distance",e=>e/308567758128e5,e=>308567758128e5*e],[["Picapt","Pica"],"distance",e=>e/352778e-9,e=>352778e-9*e],[["pica"],"distance",e=>236.2204724409*e,e=>e/236.2204724409],[["survey_mi"],"distance",e=>62137e-8*e,e=>e/62137e-8],[["sec","s"],"time"],[["yr"],"time",e=>e/31557600,e=>31557600*e],[["day","d"],"time",e=>e/86400,e=>86400*e],[["hr"],"time",e=>e/3600,e=>3600*e],[["mn","min"],"time",e=>e/60,e=>60*e],[["Pa","p"],"pressure"],[["atm","at"],"pressure",e=>e/101325,e=>101325*e],[["mmHg"],"pressure",e=>e/133.322,e=>133.322*e],[["psi"],"pressure",e=>e/6894.757293,e=>6894.757293*e],[["Torr"],"pressure",e=>e/133.3223684,e=>133.3223684*e],[["N"],"force"],[["dyn","dy"],"force",e=>e/1e-5,e=>1e-5*e],[["lbf"],"force",e=>e/4.448221615,e=>4.448221615*e],[["pond"],"force",e=>e/.00980665,e=>.00980665*e],[["J"],"energy"],[["e"],"energy",e=>e/1e-7,e=>1e-7*e],[["c"],"energy",e=>e/4.184,e=>4.184*e],[["cal"],"energy",e=>e/4.1868,e=>4.1868*e],[["eV","ev"],"energy",e=>e/16021766531138543e-35,e=>16021766531138543e-35*e],[["HPh","hh"],"energy",e=>e/2684519.538,e=>2684519.538*e],[["Wh","wh"],"energy",e=>e/3600,e=>3600*e],[["flb"],"energy",e=>e/1.3558179483,e=>1.3558179483*e],[["BTU","btu"],"energy",e=>e/1055.055853,e=>1055.055853*e],[["HP","h"],"power"],[["PS"],"power",e=>e/.986320071,e=>.986320071*e],[["W","w"],"power",e=>e/.0013410220888438076,e=>.0013410220888438076*e],[["T"],"magnetism"],[["ga"],"magnetism",e=>e/1e-4,e=>1e-4*e],[["C","cel"],"temperature"],[["K","kel"],"temperature",e=>e+273,e=>e-273],[["F","fah"],"temperature",e=>1.8*e+32,e=>(e-32)/1.8],[["Rank"],"temperature",e=>9*(e+273.15)/5,e=>5*(e-491.67)/9],[["Reau"],"temperature",e=>.8*e,e=>e/.8],[["l","L","lt"],"volume"],[["tsp"],"volume",e=>e/.0049289215940186,e=>.0049289215940186*e],[["tspm"],"volume",e=>e/.005,e=>.005*e],[["tbs"],"volume",e=>e/.014786764782055936,e=>.014786764782055936*e],[["oz"],"volume",e=>e/.029573529564111873,e=>.029573529564111873*e],[["cup"],"volume",e=>e/.2365882365,e=>.2365882365*e],[["pt","us_pt"],"volume",e=>e/.473176473,e=>.473176473*e],[["uk_pt"],"volume",e=>e/.56826125,e=>.56826125*e],[["qt"],"volume",e=>e/.946352946,e=>.946352946*e],[["uk_qt"],"volume",e=>e/1.1365225,e=>1.1365225*e],[["gal"],"volume",e=>e/3.785411784,e=>3.785411784*e],[["uk_gal"],"volume",e=>e/4.54609,e=>4.54609*e],[["ang3","ang^3"],"volume",e=>e/1e-27,e=>1e-27*e],[["barrel"],"volume",e=>e/158.987294928,e=>158.987294928*e],[["bushel"],"volume",e=>e/35.23907017,e=>35.23907017*e],[["ft3","ft^3"],"volume",e=>e/28.316846592,e=>28.316846592*e],[["in3","in^3"],"volume",e=>e/.016387064,e=>.016387064*e],[["ly3","ly^3"],"volume",e=>e/8.46786664623715e50,e=>8.46786664623715e50*e],[["m3","m^3"],"volume",e=>e/1e3,e=>1e3*e],[["mi3","mi^3"],"volume",e=>e/4168181825440.6,e=>4168181825440.6*e],[["yd3","yd^3"],"volume",e=>e/764.554857984,e=>764.554857984*e],[["Nmi3","Nmi^3"],"volume",e=>e/6352182208e3,e=>6352182208e3*e],[["Picapt3","Picapt^3","Pica3","Pica^3"],"volume",e=>e/4.39039566186557e-8,e=>4.39039566186557e-8*e],[["GRT","regton"],"volume",e=>e/2831.6846592,e=>2831.6846592*e],[["MTON"],"volume",e=>e/1132.67386368,e=>1132.67386368*e],[["m2","m^2"],"area"],[["uk_acre"],"area",e=>e/4046.8564224,e=>4046.8564224*e],[["us_acre"],"area",e=>e/4046.87260987425,e=>4046.87260987425*e],[["ang2","ang^2"],"area",e=>e/1e-20,e=>1e-20*e],[["ar"],"area",e=>e/100,e=>100*e],[["ft2","ft^2"],"area",e=>e/.09290304,e=>.09290304*e],[["ha"],"area",e=>e/1e4,e=>1e4*e],[["in2","in^2"],"area",e=>e/64516e-8,e=>64516e-8*e],[["ly2","ly^2"],"area",e=>e/895054210748189e17,e=>895054210748189e17*e],[["Morgen"],"area",e=>e/2500,e=>2500*e],[["mi2","mi^2"],"area",e=>e/2589988.110336,e=>2589988.110336*e],[["Nmi2","Nmi^2"],"area",e=>e/3429904,e=>3429904*e],[["Picapt2","Pica2","Pica^2","Picapt^2"],"area",e=>e/1.2445216049382718e-7,e=>1.2445216049382718e-7*e],[["yd2","yd^2"],"area",e=>e/.83612736,e=>.83612736*e],[["bit"],"information"],[["byte"],"information",e=>e/8,e=>8*e],[["m/s","m/sec"],"speed"],[["admkn"],"speed",e=>e/.5147733333333333,e=>.5147733333333333*e],[["kn"],"speed",e=>e/.5144444444444445,e=>.5144444444444445*e],[["m/h","m/hr"],"speed",e=>e/.0002777777777777778,e=>.0002777777777777778*e],[["mph"],"speed",e=>e/.44704,e=>.44704*e]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,s=null,l=t,u=n,c=1,f=1;if(a=r.find((e=>e[0].includes(l))),s=r.find((e=>e[0].includes(u))),!a){const e=o[t.substring(0,2)];let n=i[t.substring(0,1)];"da"===t.substring(0,2)&&(n=["dekao",10,"da"]),e?(c=e[2],l=t.substring(2)):n&&(c=n[1],l=t.substring(n[2].length)),a=r.find((e=>e[0].includes(l)))}if(!s){const e=o[n.substring(0,2)];let t=i[n.substring(0,1)];"da"===n.substring(0,2)&&(t=["dekao",10,"da"]),e?(f=e[2],u=n.substring(2)):t&&(f=t[1],u=n.substring(t[2].length)),s=r.find((e=>e[0].includes(u)))}return a&&s?a[1]!==s[1]?L:(a[3]&&(e=a[3](e)),e*=c,s[2]&&(e=s[2](e)),e/=f):L}function mn(e,t){if((e=G(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return N;if(e<0)return"1"+Ft("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=n.length?Ft("0",t-n.length)+n:N}function vn(e,t){if((e=G(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return N;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=n.length?Ft("0",t-n.length)+n:N}function yn(e,t){if((e=G(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return N;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=n.length?Ft("0",t-n.length)+n:N}function wn(e,t){return t=void 0===t?0:t,oe(e=G(e),t=G(t))?M:e===t?1:0}function En(e,t){return t=void 0===t?0:t,oe(e=G(e),t=G(t))?M:_e().erf(e)}function bn(e){return isNaN(e)?M:_e().erfc(e)}function xn(e,t){return oe(t=t||0,e=G(e))?e:e>=t?1:0}function Mn(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return N;const n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return N;if(n)return"1"+Ft("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=o.length?Ft("0",t-o.length)+o:N}function Tn(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return N;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t}function An(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return N;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return N;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const r=n.toString(8);return void 0===t?r:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=r.length?Ft("0",t-r.length)+r:N}function Nn(e){const t=qn(e),n=Sn(e);return oe(t,n)?M:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function Ln(){throw new Error("IMLOG is not implemented")}function Cn(){throw new Error("IMTANH is not implemented")}function In(){throw new Error("IMCOTH is not implemented")}function Sn(e){if(void 0===e||!0===e||!1===e)return M;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?N:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?N:-Number(e.substring(n+1,e.length-1)):N:o?isNaN(e.substring(0,e.length-1))?N:e.substring(0,e.length-1):isNaN(e)?N:0}function Dn(e){const t=qn(e),n=Sn(e);return oe(t,n)?M:0===t&&0===n?x:0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function On(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",0!==n?hn(t,-n,r):e}function Rn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function jn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function kn(e){return oe(qn(e),Sn(e))?M:Un(Rn(e),Gn(e))}function Un(e,t){const n=qn(e),r=Sn(e),o=qn(t),i=Sn(t);if(oe(n,r,o,i))return M;const a=e.substring(e.length-1),s=t.substring(t.length-1);let l="i";if(("j"===a||"j"===s)&&(l="j"),0===o&&0===i)return N;const u=o*o+i*i;return hn((n*o+r*i)/u,(r*o-n*i)/u,l)}function Pn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);r="i"===r||"j"===r?r:"i";const o=Math.exp(t);return hn(o*Math.cos(n),o*Math.sin(n),r)}function Hn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),r)}function Fn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),r)}function Vn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),r)}function Bn(e,t){if(oe(t=G(t),qn(e),Sn(e)))return M;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const r=Math.pow(Nn(e),t),o=Dn(e);return hn(r*Math.cos(t*o),r*Math.sin(t*o),n)}function Yn(){let e=arguments[0];if(!arguments.length)return M;for(let t=1;t<arguments.length;t++){const n=qn(e),r=Sn(e),o=qn(arguments[t]),i=Sn(arguments[t]);if(oe(n,r,o,i))return M;e=hn(n*o-r*i,n*i+r*o)}return e}function qn(e){if(void 0===e||!0===e||!1===e)return M;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?N:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?N:Number(e.substring(0,n)):N:o?isNaN(e.substring(0,e.length-1))?N:0:isNaN(e)?N:e}function _n(e){return!0===e||!1===e||oe(qn(e),Sn(e))?M:Un("1",Rn(e))}function Xn(e){return oe(qn(e),Sn(e))?M:Un("1",jn(e))}function Gn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function Wn(e){const t=qn(e),n=Sn(e);if(oe(t,n))return M;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",hn(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,r)}function zn(e){if(oe(qn(e),Sn(e)))return M;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const n=Math.sqrt(Nn(e)),r=Dn(e);return hn(n*Math.cos(r/2),n*Math.sin(r/2),t)}function $n(e){return!0===e||!1===e?M:oe(qn(e),Sn(e))?N:Un("1",Gn(e))}function Kn(e){return!0===e||!1===e?M:oe(qn(e),Sn(e))?N:Un("1",Wn(e))}function Zn(e,t){const n=qn(e),r=Sn(e),o=qn(t),i=Sn(t);if(oe(n,r,o,i))return M;const a=e.substring(e.length-1),s=t.substring(t.length-1);let l="i";return("j"===a||"j"===s)&&(l="j"),hn(n-o,r-i,l)}function Qn(){if(!arguments.length)return M;const e=B(arguments);let t=e[0];for(let n=1;n<e.length;n++){const r=qn(t),o=Sn(t),i=qn(e[n]),a=Sn(e[n]);if(oe(r,o,i,a))return M;t=hn(r+i,o+a)}return t}function Jn(e){return!0===e||!1===e||oe(qn(e),Sn(e))?M:Un(Gn(e),Rn(e))}function er(e,t){if(!/^[0-7]{1,10}$/.test(e))return N;const n=!(10!==e.length||"7"!==e.substring(0,1)),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return N;if(n)return"1"+Ft("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=o.length?Ft("0",t-o.length)+o:N}function tr(e){if(!/^[0-7]{1,10}$/.test(e))return N;const t=parseInt(e,8);return t>=536870912?t-1073741824:t}function nr(e,t){if(!/^[0-7]{1,10}$/.test(e))return N;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const r=n.toString(16);return void 0===t?r:isNaN(t)?M:t<0?N:(t=Math.floor(t))>=r.length?Ft("0",t-r.length)+r:N}En.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},bn.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const rr=[">",">=","<","<=","=","<>"],or="operator",ir="literal",ar=[or,ir],sr=or,lr=ir;function ur(e,t){if(-1===ar.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function cr(e){const t=[];let n;for(let r=0;r<e.length;r++){const o=e[r];switch(o.type){case sr:n=o.value;break;case lr:t.push(o.value)}}return function(e,t){return("<>"===t||typeof e[0]==typeof e[1])&&dr[t](e)}(t,n)}const fr=function(e,t){const n=t.split("");let r=0;for(let o=0;o<n.length;o++)if("~"===n[o]){if("?"===n[o+1]){if("?"!==e[r])return!1;r++,o++}else if("*"===n[o+1]){if("*"!==e[r])return!1;r++,o++}else if("~"===n[o+1]){if("~"!==e[r])return!1;r++,o++}}else if("?"===n[o]){if(r>=e.length)return!1;r++}else{if("*"===n[o]){if(o===n.length-1)return!0;let i=fr(e.slice(r),t.slice(o+1));for(;r<e.length&&!i;)r++,i=fr(e.slice(r),t.slice(o+1));return i}if(e[r]!==n[o])return!1;r++}return r===e.length},dr={">":function(e){return e[0]>e[1]},">=":function(e){return e[0]>=e[1]},"<":function(e){return e[0]<e[1]},"<=":function(e){return e[0]<=e[1]},"=":function(e){return"string"!=typeof e[0]?e[0]===e[1]:fr(e[0],e[1])},"<>":function(e){return 1===e.length?null!==e[0]:"string"==typeof e[0]&&"string"==typeof e[1]?!fr(e[0],e[1]):e[0]!==e[1]}};function pr(e){return function(e){let t="";const n=[];for(let r=0;r<e.length;r++){const o=e[r];0===r&&rr.indexOf(o)>=0?n.push(ur(o,sr)):t+=o}var r;return t.length>0&&n.push(ur(("string"!=typeof(r=t)||/^\d+(\.\d+)?$/.test(r)&&(r=-1===r.indexOf(".")?parseInt(r,10):parseFloat(r)),r),lr)),n.length>0&&n[0].type!==sr&&n.unshift(ur("=",sr)),n}(function(e){const t=e.length,n=[];let r=0,o="",i="";for(;r<t;){const t=e.charAt(r);switch(t){case">":case"<":case"=":i+=t,o.length>0&&(n.push(o),o="");break;default:i.length>0&&(n.push(i),i=""),o+=t}r++}return o.length>0&&n.push(o),i.length>0&&n.push(i),n}(e))}const hr=function(e){const t=[];let n;for(let r=0;r<e.length;r++){const o=e[r];switch(o.type){case sr:n=o.value;break;case lr:t.push(o.value)}}return function(e,t){let n=!1;switch(t){case">":n=e[0]>e[1];break;case">=":n=e[0]>=e[1];break;case"<":n=e[0]<e[1];break;case"<=":n=e[0]<=e[1];break;case"=":n=e[0]==e[1];break;case"<>":n=e[0]!=e[1]}return n}(t,n)},gr={};function mr(){throw new Error("INFO is not implemented")}function vr(e){return/^[01]{1,10}$/.test(e)}function yr(e){return 1!==arguments.length?L:null===e}function wr(t){return 1!==arguments.length?L:Array.isArray(t)?t.map((e=>wr(e))):t!==L&&(Object.values(e).includes(t)||"number"==typeof t&&(isNaN(t)||!isFinite(t)))}function Er(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Er(e))):wr(e)||e===L}function br(e){return 1!==arguments.length?L:Array.isArray(e)?M:e instanceof Error?e:"boolean"==typeof e||"number"!=typeof(e=k(e))?M:!(1&Math.floor(Math.abs(e)))}function xr(){throw new Error("ISDATE is not implemented")}function Mr(){throw new Error("ISEMAIL is not implemented")}function Tr(){if(1!==arguments.length)return L;if(!this.k[0])return L;try{var e=(""+this.instance.getValue(this.k[0])).substr(0,1);return"="===e}catch(e){return L}}function Ar(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Ar(e))):"boolean"==typeof e}function Nr(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Nr(e))):e===L}function Lr(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Lr(e))):"string"!=typeof e}function Cr(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Cr(e))):"number"==typeof e&&!isNaN(e)&&isFinite(e)}function Ir(e){return 1!==arguments.length?L:Array.isArray(e)?M:e instanceof Error?e:"string"==typeof(e=k(e))?M:!!(1&Math.floor(Math.abs(e)))}function Sr(){throw new Error("ISREF is not implemented")}function Dr(e){return 1!==arguments.length?L:Array.isArray(e)?e.map((e=>Dr(e))):"string"==typeof e}function Or(e){return Array.isArray(e)?Or(e[0]):Cr(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:Er(e)?e:0}function Rr(){return L}function jr(){throw new Error("SHEET is not implemented")}function kr(){throw new Error("SHEETS is not implemented")}function Ur(e){return Array.isArray(e)?64:Cr(e)?1:Dr(e)?2:Ar(e)?4:Er(e)?16:void 0}function Pr(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const r=arguments[t];for(let t=0;t<e.length&&(n=e[t]===r,!n);++t);n||e.push(r)}return e}gr.TYPE=e=>{switch(e){case b:return 1;case x:return 2;case M:return 3;case T:return 4;case A:return 5;case N:return 6;case L:return 7;case I:return 8}return L};const Hr=B;function Fr(){return Array.prototype.slice.call(arguments,0)}function Vr(e,t){if(!arguments.length)return C;try{const n=t.split(".");let r=e;for(let e=0;e<n.length;++e){const t=n[e];if("]"===t[t.length-1]){const e=t.indexOf("["),n=t.substring(e+1,t.length-1);r=r[t.substring(0,e)][n]}else r=r[t]}return r}catch(e){}}function Br(e,t){return e.join(t)}function Yr(){const e=B(arguments);return e.filter((e=>"number"==typeof e))}function qr(){throw new Error("GETJSON is not implemented")}function _r(){throw new Error("NUMERAL is not implemented")}function Xr(){const e=B(arguments),t=e.filter(re);if(0===t.length)return N;const n=z(t);return n instanceof Error?n:_e().sum(_e()(n).subtract(_e().mean(n)).abs()[0])/n.length}function Gr(){if(0===arguments.length)return L;const e=B(arguments),t=e.filter(re);if(0===t.length)return x;const n=ne.apply(void 0,t);if(n)return n;const r=q(t),o=r.length;let i,a=0,s=0;for(let e=0;e<o;e++)a+=r[e],s+=1;return 0===s?x:(i=a/s,isNaN(i)&&(i=N),i)}function Wr(){const e=B(arguments),t=e.filter(re);if(0===t.length)return x;const n=ne.apply(void 0,t);if(n)return n;const r=t,o=r.length;let i,a=0,s=0;for(let e=0;e<o;e++){const t=r[e];"number"==typeof t&&(a+=t),!0===t&&a++,null!==t&&s++}return i=a/s,isNaN(i)&&(i=N),i}function zr(e,t,n){if(arguments.length<2||arguments.length>3)return L;if(Array.isArray(e)||(e=[e]),Array.isArray(e[0])||(e[0]=[e[0]]),void 0!==n&&(Array.isArray(n)||(n=[n]),Array.isArray(n[0])||(n[0]=[n[0]]),e.length!==n.length||e[0].length!==n[0].length))return M;const r=B(n=n||e),o=r.filter(re);n=o,e=B(e);let i=0,a=0;const s=pr(t+"");for(let t=0;t<e.length;t++)"number"==typeof n[t]&&cr([ur(e[t],lr)].concat(s))&&(a+=n[t],i++);return i?a/i:x}function $r(){if(arguments.length<3||arguments.length%2==0)return L;Array.isArray(arguments[0])||(arguments[0]=[arguments[0]]),Array.isArray(arguments[0][0])||(arguments[0][0]=[arguments[0][0]]);const e=arguments[0].length,t=arguments[0][0].length,n=Y(arguments),r=(n.length-1)/2,o=B(n.shift());let i=0,a=0;for(let r=0;r<n.length;r+=2){if(Array.isArray(n[r])||(n[r]=[n[r]]),Array.isArray(n[r][0])||(n[r][0]=[n[r][0]]),e!==n[r].length||t!==n[r][0].length)return M;n[r]=B(n[r])}for(let e=0;e<o.length;e++){if("number"!=typeof o[e])continue;let t=!1;for(let o=0;o<r;o++){const r=n[2*o][e];let i=!1;const a=pr(n[2*o+1]+"");if(i=cr([ur(r,lr)].concat(a)),!i){t=!1;break}t=!0}t&&(a+=o[e],i++)}if(0===i)return x;const s=a/i;return isNaN(s)?0:s}const Kr={DIST:function(e,t,n,r,o,i){return arguments.length<4?M:(o=void 0===o?0:o,i=void 0===i?1:i,oe(e=G(e),t=G(t),n=G(n),o=G(o),i=G(i))?M:(e=(e-o)/(i-o),r?_e().beta.cdf(e,t,n):_e().beta.pdf(e,t,n)))},INV:(e,t,n,r,o)=>(r=void 0===r?0:r,o=void 0===o?1:o,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o))?M:_e().beta.inv(e,t,n)*(o-r)+r)},Zr={DIST:(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n),r=G(r))?M:r?_e().binomial.cdf(e,t,n):_e().binomial.pdf(e,t,n)};Zr.DIST.RANGE=(e,t,n,r)=>{if(r=void 0===r?n:r,oe(e=G(e),t=G(t),n=G(n),r=G(r)))return M;let o=0;for(let i=n;i<=r;i++)o+=Ui(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return o},Zr.INV=(e,t,n)=>{if(oe(e=G(e),t=G(t),n=G(n)))return M;let r=0;for(;r<=e;){if(_e().binomial.cdf(r,e,t)>=n)return r;r++}};const Qr={DIST:(e,t,n)=>oe(e=G(e),t=G(t))?M:n?_e().chisquare.cdf(e,t):_e().chisquare.pdf(e,t)};Qr.DIST.RT=(e,t)=>!e|!t?L:e<1||t>Math.pow(10,10)?N:"number"!=typeof e||"number"!=typeof t?M:1-_e().chisquare.cdf(e,t),Qr.INV=(e,t)=>oe(e=G(e),t=G(t))?M:_e().chisquare.inv(e,t),Qr.INV.RT=(e,t)=>!e|!t?L:e<0||e>1||t<1||t>Math.pow(10,10)?N:"number"!=typeof e||"number"!=typeof t?M:_e().chisquare.inv(1-e,t),Qr.TEST=function(e,t){if(2!==arguments.length)return L;if(!(e instanceof Array&&t instanceof Array))return M;if(e.length!==t.length)return M;if(e[0]&&t[0]&&e[0].length!==t[0].length)return M;const n=e.length;let r,o,i;for(o=0;o<n;o++)e[o]instanceof Array||(r=e[o],e[o]=[],e[o].push(r)),t[o]instanceof Array||(r=t[o],t[o]=[],t[o].push(r));const a=e[0].length,s=1===a?n-1:(n-1)*(a-1);let l=0;const u=Math.PI;for(o=0;o<n;o++)for(i=0;i<a;i++)l+=Math.pow(e[o][i]-t[o][i],2)/t[o][i];function c(e,t){let n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));let r=t;for(;r>=2;)n=n*e/r,r-=2;let o=n,i=t;for(;o>1e-10*n;)i+=2,o=o*e/i,n+=o;return 1-n}return Math.round(1e6*c(l,s))/1e6};const Jr=new RegExp(/^([A-Z0-9_]+(!|\.))?(\$?[A-Z_]+\$?[0-9]*)(:\$?[A-Z]+\$?[0-9]*)?$/);function eo(){if(arguments.length>1)return L;if(0===arguments.length)return Number.isInteger(this.x)?this.x+1:C;if(!Jr.test(this.k[0]))return T;if(this.k[0].includes(":")){const e=this.k[0].split(":"),t=$e(e[0]),n=$e(e[1]),r=[];for(let e=t[0];e<=n[0];e++)r.push(e+1);return[r]}return $e(this.k[0])[0]+1}function to(e){return 1!==arguments.length?L:e instanceof Array?e[0].length:1}const no={};function ro(e,t){return oe(e=z(B(e)),t=z(B(t)))?M:_e().corrcoeff(e,t)}function oo(){if(arguments.length<1)return L;const e=B(arguments);return q(e).length}function io(){if(0===arguments.length)return L;const e=B(arguments);let t,n=0;for(let r=0;r<e.length;r++)t=e[r],null!==t&&n++;return n}function ao(e,t){let n=0;e=B(e);for(let r=0;r<e.length;r++)e[r]===t&&n++;return n}function so(){if(1!==arguments.length)return L;const e=B(arguments);let t,n=0;for(let r=0;r<e.length;r++)t=e[r],null!==t&&""!==t||n++;return n}function lo(e,t){if(2!==arguments.length)return L;e=Array.isArray(e)?B(e):[e],null===t&&(t=0);let n=0;const r=pr(t+"");for(let t=0;t<e.length;t++)cr([ur(e[t],lr)].concat(r))&&n++;return n}function uo(){if(arguments.length<2||arguments.length%2!=0)return L;Array.isArray(arguments[0])||(arguments[0]=[arguments[0]]),Array.isArray(arguments[0][0])||(arguments[0][0]=[arguments[0][0]]);const e=arguments[0].length,t=arguments[0][0].length;for(let n=2;n<arguments.length;n+=2)if(Array.isArray(arguments[n])||(arguments[n]=[arguments[n]]),Array.isArray(arguments[n][0])||(arguments[n][0]=[arguments[n][0]]),e!==arguments[n].length||t!==arguments[n][0].length)return M;const n=Y(arguments),r=new Array(B(n[0]).length);for(let e=0;e<r.length;e++)r[e]=!0;for(let e=0;e<n.length;e+=2){const t=B(n[e]),o=pr(n[e+1]+"");for(let e=0;e<t.length;e++){const n=[ur(t[e],lr)].concat(o);r[e]=r[e]&&cr(n)}}let o=0;for(let e=0;e<r.length;e++)r[e]&&o++;return o}function co(){return Pr.apply(null,B(arguments)).length}no.NORM=(e,t,n)=>oe(e=G(e),t=G(t),n=G(n))?M:_e().normalci(1,e,t,n)[1]-1,no.T=(e,t,n)=>oe(e=G(e),t=G(t),n=G(n))?M:_e().tci(1,e,t,n)[1]-1;const fo={};function po(){const e=z(B(arguments));if(e instanceof Error)return e;const t=_e().mean(e);let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n}fo.P=(e,t)=>{if(oe(e=z(B(e)),t=z(B(t))))return M;const n=_e().mean(e),r=_e().mean(t);let o=0;const i=e.length;for(let a=0;a<i;a++)o+=(e[a]-n)*(t[a]-r);return o/i},fo.S=(e,t)=>oe(e=z(B(e)),t=z(B(t)))?M:_e().covariance(e,t);const ho={DIST:(e,t,n)=>oe(e=G(e),t=G(t))?M:n?_e().exponential.cdf(e,t):_e().exponential.pdf(e,t)},go={};function mo(e){return(e=G(e))instanceof Error?e:Math.log((1+e)/(1-e))/2}function vo(e){if((e=G(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)}function yo(e,t,n){if(oe(e=G(e),t=z(B(t)),n=z(B(n))))return M;const r=_e().mean(n),o=_e().mean(t),i=n.length;let a=0,s=0;for(let e=0;e<i;e++)a+=(n[e]-r)*(t[e]-o),s+=Math.pow(n[e]-r,2);const l=a/s;return o-l*r+l*e}function wo(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;const n=e.length,r=t.length,o=[];for(let i=0;i<=r;i++){o[i]=0;for(let a=0;a<n;a++)0===i?e[a]<=t[0]&&(o[0]+=1):i<r?e[a]>t[i-1]&&e[a]<=t[i]&&(o[i]+=1):i===r&&e[a]>t[r-1]&&(o[r]+=1)}return o}function Eo(e){return(e=G(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?N:_e().gammafn(e)}function bo(e){return(e=G(e))instanceof Error?e:_e().gammaln(e)}function xo(e){return(e=G(e))instanceof Error?e:_e().normal.cdf(e,0,1)-.5}function Mo(){const e=z(B(arguments));return e instanceof Error?e:_e().geomean(e)}function To(e,t,n,r){if((e=z(e))instanceof Error)return e;let o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);if(oe(t=z(t),n=z(n)))return M;void 0===r&&(r=!0);const i=e.length;let a,s,l=0,u=0,c=0,f=0;for(o=0;o<i;o++){const n=t[o],r=Math.log(e[o]);l+=n,u+=r,c+=n*r,f+=n*n}l/=i,u/=i,c/=i,f/=i,r?(a=(c-l*u)/(f-l*l),s=u-a*l):(a=c/f,s=0);const d=[];for(o=0;o<n.length;o++)d.push(Math.exp(s+a*n[o]));return d}function Ao(){const e=z(B(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let r=0;r<t;r++)n+=1/e[r];return t/n}go.DIST=(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n))?M:r?_e().centralF.cdf(e,t,n):_e().centralF.pdf(e,t,n),go.DIST.RT=function(e,t,n){return 3!==arguments.length?L:e<0||t<1||n<1?N:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?M:1-_e().centralF.cdf(e,t,n)},go.INV=(e,t,n)=>oe(e=G(e),t=G(t),n=G(n))?M:e<=0||e>1?N:_e().centralF.inv(e,t,n),go.INV.RT=function(e,t,n){return 3!==arguments.length?L:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?N:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?M:_e().centralF.inv(1-e,t,n)},go.TEST=(e,t)=>{if(!e||!t)return L;if(!(e instanceof Array&&t instanceof Array))return L;if(e.length<2||t.length<2)return x;const n=(e,t)=>{let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},r=Ja(e)/e.length,o=Ja(t)/t.length;return n(e,r)/(e.length-1)/(n(t,o)/(t.length-1))},Eo.DIST=function(e,t,n,r){return 4!==arguments.length?L:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?M:r?_e().gamma.cdf(e,t,n,!0):_e().gamma.pdf(e,t,n,!1)},Eo.INV=function(e,t,n){return 3!==arguments.length?L:e<0||e>1||t<=0||n<=0?N:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?M:_e().gamma.inv(e,t,n)},bo.PRECISE=function(e){return 1!==arguments.length?L:e<=0?N:"number"!=typeof e?M:_e().gammaln(e)};const No={};function Lo(e,t){return oe(e=z(e),t=z(t))?M:e.length!==t.length?L:yo(0,e,t)}function Co(){const e=z(B(arguments));if(e instanceof Error)return e;const t=_e().mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return r/=Math.pow(_e().stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))}function Io(e,t){if(2!==arguments.length)return L;if(e=Array.isArray(e)?e.reduce(((e,t)=>e.concat(t)),[]):[e],""===t)return M;if(oe(t=G(t)))return t;if(t<=0||e.length<t)return N;for(var n=0;n<e.length;n++)if(e[n]instanceof Error)return e[n];return"number"!=typeof(e=(e=e.filter((e=>"number"==typeof e))).sort(((e,t)=>t-e)))[t-1]?N:e[t-1]}function So(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;const n=_e().mean(e),r=_e().mean(t),o=t.length;let i=0,a=0;for(let s=0;s<o;s++)i+=(t[s]-r)*(e[s]-n),a+=Math.pow(t[s]-r,2);const s=i/a;return[s,n-s*r]}function Do(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const n=So(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n}No.DIST=(e,t,n,r,o)=>{if(oe(e=G(e),t=G(t),n=G(n),r=G(r)))return M;function i(e,t,n,r){return Ui(n,e)*Ui(r-n,t-e)/Ui(r,t)}return o?function(e,t,n,r){let o=0;for(let a=0;a<=e;a++)o+=i(a,t,n,r);return o}(e,t,n,r):i(e,t,n,r)};const Oo={};function Ro(){if(0===arguments.length)return L;const e=B(arguments),t=ne.apply(void 0,e);if(t)return t;const n=q(e);return 0===n.length?0:Math.max.apply(Math,n)}function jo(){const e=B(arguments),t=ne.apply(void 0,e);if(t)return t;let n=ae(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.max.apply(Math,n)}function ko(){throw new Error("MAXIFS is not implemented")}function Uo(){throw new Error("MINIFS is not implemented")}function Po(){const e=B(arguments),t=ne.apply(void 0,e);if(t)return t;const n=ae(e);let r=_e().median(n);return isNaN(r)&&(r=N),r}function Ho(){if(0===arguments.length)return L;const e=B(arguments),t=ne.apply(void 0,e);if(t)return t;const n=q(e);return 0===n.length?0:Math.min.apply(Math,n)}function Fo(){const e=B(arguments),t=ne.apply(void 0,e);if(t)return t;let n=ae(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.min.apply(Math,n)}Oo.DIST=(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n))?M:r?_e().lognormal.cdf(e,t,n):_e().lognormal.pdf(e,t,n),Oo.INV=(e,t,n)=>oe(e=G(e),t=G(t),n=G(n))?M:_e().lognormal.inv(e,t,n);const Vo={MULT:function(){const e=z(B(arguments));if(e instanceof Error)return e;const t=e.length,n={};let r,o=[],i=0;for(let a=0;a<t;a++)r=e[a],n[r]=n[r]?n[r]+1:1,n[r]>i&&(i=n[r],o=[]),n[r]===i&&(o[o.length]=r);return o},SNGL:function(){const e=z(B(arguments));return e instanceof Error?e:Vo.MULT(e).sort(((e,t)=>e-t))[0]}},Bo={DIST:(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n))?M:r?_e().negbin.cdf(e,t,n):_e().negbin.pdf(e,t,n)},Yo={};function qo(e,t){if(oe(t=z(B(t)),e=z(B(e))))return M;const n=_e().mean(e),r=_e().mean(t),o=e.length;let i=0,a=0,s=0;for(let l=0;l<o;l++)i+=(e[l]-n)*(t[l]-r),a+=Math.pow(e[l]-n,2),s+=Math.pow(t[l]-r,2);return i/Math.sqrt(a*s)}Yo.DIST=(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n))?M:n<=0?N:r?_e().normal.cdf(e,t,n):_e().normal.pdf(e,t,n),Yo.INV=(e,t,n)=>oe(e=G(e),t=G(t),n=G(n))?M:_e().normal.inv(e,t,n),Yo.S={},Yo.S.DIST=(e,t)=>(e=G(e))instanceof Error?M:t?_e().normal.cdf(e,0,1):_e().normal.pdf(e,0,1),Yo.S.INV=e=>(e=G(e))instanceof Error?M:_e().normal.inv(e,0,1);const _o={EXC:(e,t)=>{if(oe(e=z(B(e)),t=G(t)))return M;const n=(e=e.sort(((e,t)=>e-t))).length;if(t<1/(n+1)||t>1-1/(n+1))return N;const r=t*(n+1)-1,o=Math.floor(r);return _(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},INC:(e,t)=>{if(oe(e=z(B(e)),t=G(t)))return M;const n=t*((e=e.sort(((e,t)=>e-t))).length-1),r=Math.floor(n);return _(n===r?e[n]:e[r]+(n-r)*(e[r+1]-e[r]))}},Xo={};function Go(e,t){return oe(e=G(e),t=G(t))?M:Zi(e)/Zi(e-t)}function Wo(e,t){return oe(e=G(e),t=G(t))?M:Math.pow(e,t)}function zo(e){return(e=G(e))instanceof Error?M:Math.exp(-.5*e*e)/2.5066282746310002}Xo.EXC=(e,t,n)=>{if(n=void 0===n?3:n,oe(e=z(B(e)),t=G(t),n=G(n)))return M;e=e.sort(((e,t)=>e-t));const r=Pr.apply(null,e),o=e.length,i=r.length,a=Math.pow(10,n);let s=0,l=!1,u=0;for(;!l&&u<i;)t===r[u]?(s=(e.indexOf(r[u])+1)/(o+1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(s=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(o+1),l=!0),u++;return Math.floor(s*a)/a},Xo.INC=(e,t,n)=>{if(n=void 0===n?3:n,oe(e=z(B(e)),t=G(t),n=G(n)))return M;e=e.sort(((e,t)=>e-t));const r=Pr.apply(null,e),o=e.length,i=r.length,a=Math.pow(10,n);let s=0,l=!1,u=0;for(;!l&&u<i;)t===r[u]?(s=e.indexOf(r[u])/(o-1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(s=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(o-1),l=!0),u++;return Math.floor(s*a)/a};const $o={};function Ko(e,t,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,oe(e=z(B(e)),t=z(B(t)),n=G(n),r=G(r)))return M;if(n===r)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const o=e.sort(((e,t)=>e-t)),i=o.length;let a=0;for(let s=0;s<i;s++)o[s]>=n&&o[s]<=r&&(a+=t[e.indexOf(o[s])]);return a}$o.DIST=(e,t,n)=>oe(e=G(e),t=G(t))?M:n?_e().poisson.cdf(e,t):_e().poisson.pdf(e,t);const Zo={EXC:(e,t)=>{if(oe(e=z(B(e)),t=G(t)))return M;switch(t){case 1:return _o.EXC(e,.25);case 2:return _o.EXC(e,.5);case 3:return _o.EXC(e,.75);default:return N}},INC:(e,t)=>{if(oe(e=z(B(e)),t=G(t)))return M;switch(t){case 1:return _o.INC(e,.25);case 2:return _o.INC(e,.5);case 3:return _o.INC(e,.75);default:return N}}},Qo={};function Jo(){if(arguments.length>1)return L;if(0===arguments.length)return Number.isInteger(this.y)?this.y+1:C;if(!Jr.test(this.k[0]))return T;if(this.k[0].includes(":")){const e=this.k[0].split(":");let t=parseInt(e[0].replace(/[^\d]/g,""));const n=parseInt(e[1].replace(/[^\d]/g,"")),r=[];for(;t<=n;)r.push([t]),t++;return r}return parseInt(this.k[0].replace(/[^\d]/g,""))}function ei(e){return 1!==arguments.length?L:e instanceof Array?e.length:1}function ti(e,t){return oe(e=z(B(e)),t=z(B(t)))?M:Math.pow(qo(e,t),2)}function ni(){const e=z(B(arguments));if(e instanceof Error)return e;const t=_e().mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(_e().stdev(e,!0),3))}function ri(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;const n=_e().mean(t),r=_e().mean(e),o=t.length;let i=0,a=0;for(let s=0;s<o;s++)i+=(t[s]-n)*(e[s]-r),a+=Math.pow(t[s]-n,2);return i/a}function oi(e,t){if(2!==arguments.length)return L;if(e=Array.isArray(e)?e.reduce(((e,t)=>e.concat(t)),[]):[e],""===t)return M;if(oe(t=G(t)))return t;if(t<=0||e.length<t)return N;for(var n=0;n<e.length;n++)if(e[n]instanceof Error)return e[n];return"number"!=typeof(e=(e=e.filter((e=>"number"==typeof e))).sort(((e,t)=>e-t)))[t-1]?N:e[t-1]}function ii(e,t,n){return oe(e=G(e),t=G(t),n=G(n))?M:(e-t)/n}Qo.AVG=(e,t,n)=>{if(oe(e=G(e),t=z(B(t))))return M;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,o=(t=(t=B(t)).sort(r)).length;let i=0;for(let n=0;n<o;n++)t[n]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},Qo.EQ=(e,t,n)=>{if(oe(e=G(e),t=z(B(t))))return M;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(r)).indexOf(e)+1},ni.P=function(){const e=z(B(arguments));if(e instanceof Error)return e;const t=_e().mean(e),n=e.length;let r=0,o=0;for(let i=0;i<n;i++)o+=Math.pow(e[i]-t,3),r+=Math.pow(e[i]-t,2);return o/=n,r/=n,o/Math.pow(r,1.5)};const ai={};function si(){const e=gi.apply(this,arguments),t=Math.sqrt(e);return t}function li(){const e=mi.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=N),t}function ui(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;const n=_e().mean(t),r=_e().mean(e),o=t.length;let i=0,a=0,s=0;for(let l=0;l<o;l++)i+=Math.pow(e[l]-r,2),a+=(t[l]-n)*(e[l]-r),s+=Math.pow(t[l]-n,2);return Math.sqrt((i-a*a/s)/(o-2))}function ci(e){return 1!==arguments.length?L:Array.isArray(e)?_e().transpose(e):e}ai.P=function(){const e=hi.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=N),t},ai.S=function(){const e=hi.S.apply(this,arguments),t=Math.sqrt(e);return t};const fi={};function di(e,t,n){if(oe(e=z(B(e)),t=z(B(t)),n=z(B(n))))return M;const r=So(e,t),o=r[0],i=r[1],a=[];return n.forEach((e=>{a.push(o*e+i)})),a}function pi(e,t){if(oe(e=z(B(e)),t=G(t)))return M;const n=Ji(e.length*t,2)/2;return _e().mean((o=(o=n)||1,(r=se(e.sort(((e,t)=>e-t)),n))&&"function"==typeof r.slice?r.slice(0,r.length-o):r));var r,o}fi.DIST=(e,t,n)=>1!==n&&2!==n?N:1===n?fi.DIST.RT(e,t):fi.DIST["2T"](e,t),fi.DIST["2T"]=function(e,t){return 2!==arguments.length?L:e<0||t<1?N:"number"!=typeof e||"number"!=typeof t?M:2*(1-_e().studentt.cdf(e,t))},fi.DIST.RT=function(e,t){return 2!==arguments.length?L:e<0||t<1?N:"number"!=typeof e||"number"!=typeof t?M:1-_e().studentt.cdf(e,t)},fi.INV=(e,t)=>oe(e=G(e),t=G(t))?M:_e().studentt.inv(e,t),fi.INV["2T"]=(e,t)=>(e=G(e),t=G(t),e<=0||e>1||t<1?N:oe(e,t)?M:Math.abs(_e().studentt.inv(e/2,t))),fi.TEST=(e,t)=>{if(oe(e=z(B(e)),t=z(B(t))))return M;const n=_e().mean(e),r=_e().mean(t);let o,i=0,a=0;for(o=0;o<e.length;o++)i+=Math.pow(e[o]-n,2);for(o=0;o<t.length;o++)a+=Math.pow(t[o]-r,2);i/=e.length-1,a/=t.length-1;const s=Math.abs(n-r)/Math.sqrt(i/e.length+a/t.length);return fi.DIST["2T"](s,e.length+t.length-2)};const hi={};function gi(){const e=B(arguments),t=e.length;let n=0,r=0;const o=Wr(e);for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return n/(r-1)}function mi(){const e=B(arguments),t=e.length;let n=0,r=0;const o=Wr(e);let i;for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return i=n/r,isNaN(i)&&(i=N),i}hi.P=function(){const e=q(B(arguments)),t=e.length;let n=0;const r=Gr(e);let o;for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return o=n/t,isNaN(o)&&(o=N),o},hi.S=function(){const e=q(B(arguments)),t=e.length;let n=0;const r=Gr(e);for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)};const vi={DIST:(e,t,n,r)=>oe(e=G(e),t=G(t),n=G(n))?M:r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},yi={};function wi(e){if(1!==arguments.length)return L;if(Array.isArray(e))return e.map((e=>wi(e)));if(e instanceof Error)return e;if(""===e)return M;if(e=G(e),isNaN(e))return M;const t=Math.abs(e);return t}function Ei(e){if((e=G(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=N),t}function bi(e){if((e=G(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=N),t}function xi(e){return(e=G(e))instanceof Error?e:Math.atan(1/e)}function Mi(e){if((e=G(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=N),t}function Ti(e,t){if(2!==arguments.length)return L;const n=ne(e=G(e),t=G(t));return n||e+t}yi.TEST=(e,t,n)=>{if(oe(e=z(B(e)),t=G(t)))return M;n=n||ai.S(e);const r=e.length;return 1-Yo.S.DIST((Gr(e)-t)/(n/Math.sqrt(r)),!0)};const Ai={0:{nestedFunctions:!0},1:{hiddenRows:!0,nestedFunctions:!0},2:{errors:!0,nestedFunctions:!0},3:{hiddenRows:!0,errors:!0,nestedFunctions:!0},4:{},5:{hiddenRows:!0},6:{errors:!0},7:{hiddenRows:!0,errors:!0}};function Ni(e,t){if(arguments.length<3)return L;if(oe(e=G(e),t=G(t)))return M;const n=Y(arguments),r=n.slice(2);if(!Ai[t])return M;if(Ai[t].hiddenRows&&this.instance.rows)for(let e=0;e<r.length;e++){const t=j(this.k[e+2]);if(t.end){const n=$e(t.start)[1],o=$e(t.end)[1];for(let t=n;t<=o;t++)this.instance.rows[t]&&!1===this.instance.rows[t].visible&&r[e][t-n].fill(void 0)}}for(let e=0;e<r.length;e++)Array.isArray(r[e])?r[e]=B(r[e]):r[e]=[r[e]];if(Ai[t].nestedFunctions){const e=/".*?"/g;for(let t=0;t<r.length;t++){let n=Qe(this.k[t+2]);n=B(n),n.forEach(((n,o)=>{let i=this.instance.getValue(n);"string"==typeof i&&(i=i.replace(e,""),(i.includes("AGGREGATE")||i.includes("SUBTOTAL"))&&(r[t][o]=void 0))}))}}if(Ai[t].errors)for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++)r[e][t]instanceof Error&&(r[e][t]=void 0);for(let e=0;e<r.length;e++)r[e]=r[e].filter((e=>void 0!==e));switch(e){case 1:return Gr(...r);case 2:return oo(...r);case 3:return io(...r);case 4:return Ro(...r);case 5:return Ho(...r);case 6:return xa(...r);case 7:return ai.S(...r);case 8:return ai.P(...r);case 9:return Ja(...r);case 10:return hi.S(...r);case 11:return hi.P(...r);case 12:return Po(...r);case 13:return Vo.SNGL(...r);case 14:return Io(...r);case 15:return oi(...r);case 16:return _o.INC(...r);case 17:return Zo.INC(...r);case 18:return _o.EXC(...r);case 19:return Zo.EXC(...r);default:return M}}function Li(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return M;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t}function Ci(e){if((e=G(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=N),t}function Ii(e){return(e=G(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))}function Si(e){return(e=G(e))instanceof Error?e:Math.atan(e)}function Di(e,t){return ne(e=G(e),t=G(t))||Math.atan2(e,t)}function Oi(e){if((e=G(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=N),t}function Ri(e,t,n){const r=ne(e=G(e),t=G(t),n=G(n));if(r)return r;if(0===t)return N;const o=e.toString(t);return new Array(Math.max(n+1-o.length,0)).join("0")+o}function ji(e,t,n){const r=ne(e=G(e),t=G(t),n=G(n));if(r)return r;if(0===t)return 0;t=Math.abs(t);const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ia(Math.ceil(e/t)*t,o):0===n?-Ia(Math.floor(Math.abs(e)/t)*t,o):-Ia(Math.ceil(Math.abs(e)/t)*t,o)}function ki(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));if(n)return n;if(0===t)return 0;if(e>0&&t>0&&e<t)return t;const r=-Math.floor(Math.log(Math.abs(t))/Math.log(10));return Ia(Math.ceil(e/t)*t,r)}function Ui(e,t){return ne(e=G(e),t=G(t))||(e<t?N:Zi(e)/(Zi(t)*Zi(e-t)))}function Pi(e,t){return ne(e=G(e),t=G(t))||(e<t?N:0===e&&0===t?1:Ui(e+t-1,e-1))}function Hi(e){return(e=G(e))instanceof Error?e:Math.cos(e)}function Fi(e){return(e=G(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2}function Vi(e){return(e=G(e))instanceof Error?e:0===e?x:1/Math.tan(e)}function Bi(e){if((e=G(e))instanceof Error)return e;if(0===e)return x;const t=Math.exp(2*e);return(t+1)/(t-1)}function Yi(e){return(e=G(e))instanceof Error?e:0===e?x:1/Math.sin(e)}function qi(e){return(e=G(e))instanceof Error?e:0===e?x:2/(Math.exp(e)-Math.exp(-e))}function _i(e,t){if(arguments.length<1)return M;const n=ne(e=G(e),t=G(t));return n||(0===t?N:parseInt(e,t))}function Xi(e){return(e=G(e))instanceof Error?e:180*e/Math.PI}function Gi(e,t){if(2!==arguments.length)return L;const n=ne(e=G(e),t=G(t));return n||(0===t?x:e/t)}function Wi(e){return(e=G(e))instanceof Error?e:ji(e,-2,-1)}function zi(e,t){return 2!==arguments.length?L:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)}function $i(e){return arguments.length<1?L:arguments.length>1?C:(e=G(e))instanceof Error?e:e=Math.exp(e)}ki.MATH=ji,ki.PRECISE=ji;const Ki=[];function Zi(e){if((e=G(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(Ki[t]>0||(Ki[t]=Zi(t-1)*t),Ki[t])}function Qi(e){if((e=G(e))instanceof Error)return e;const t=Math.floor(e);return t<=0?1:t*Qi(t-2)}function Ji(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));if(n)return n;if(0===e&&0===t)return 0;if(0===t)return x;if(e>=0&&t<0)return N;t=Math.abs(t);const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ia(Math.floor(e/t)*t,r):-Ia(Math.ceil(Math.abs(e)/t),r)}function ea(){const e=z(B(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let r=n<0?-n:n;for(let n=1;n<t;n++){const t=e[n];let o=t<0?-t:t;for(;r&&o;)r>o?r%=o:o%=r;r+=o}return r}function ta(e){return 1!==arguments.length?L:""===e?M:(e=G(e))instanceof Error?e:Math.floor(e)}Ji.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const r=ne(e=G(e),t=G(t),n=G(n));if(r)return r;if(0===t)return 0;t=t?Math.abs(t):1;const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ia(Math.floor(e/t)*t,o):0===n||void 0===n?-Ia(Math.ceil(Math.abs(e)/t)*t,o):-Ia(Math.floor(Math.abs(e)/t)*t,o)},Ji.PRECISE=Ji.MATH;const na={CEILING:ji};function ra(){const e=z(B(arguments));if(e instanceof Error)return e;for(var t,n,r,o,i=1;void 0!==(r=e.pop());){if(0===r)return 0;for(;r>1;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);o=t<=n?t:r}else o=2;for(r/=o,i*=o,t=e.length;t;e[--t]%o==0&&1==(e[t]/=o)&&e.splice(t,1));}}return i}function oa(e){return(e=G(e))instanceof Error?e:0===e?N:Math.log(e)}function ia(){return Math.log(10)}function aa(){return Math.log(2)}function sa(){return Math.LOG10E}function la(){return Math.LOG2E}function ua(e,t){return ne(e=G(e),t=G(t))||(0===e||0===t?N:Math.log(e)/Math.log(t))}function ca(e){return(e=G(e))instanceof Error?e:0===e?N:Math.log(e)/Math.log(10)}function fa(){throw new Error("MDETERM is not implemented")}function da(){throw new Error("MINVERSE is not implemented")}function pa(){throw new Error("MMULT is not implemented")}function ha(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));return n||(0===t?x:e-t*ta(e/t))}function ga(e,t){if(2!==arguments.length)return L;if("boolean"==typeof e||"boolean"==typeof t)return M;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));return n||(e*t==0?0:e*t<0?N:Math.round(e/t)*t)}function ma(){const e=z(B(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let r=0;r<e.length;r++)t+=e[r],n*=Zi(e[r]);return Zi(t)/n}function va(){throw new Error("MUNIT is not implemented")}function ya(e){if((e=G(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t}function wa(){return Math.PI}function Ea(){return Math.E}function ba(e,t){const n=ne(e=G(e),t=G(t));if(n)return n;if(0===e&&0===t)return N;const r=Math.pow(e,t);return isNaN(r)?N:r}function xa(){const e=B(arguments),t=e.filter((e=>null!=e));if(0===t.length)return 0;const n=z(t);if(n instanceof Error)return n;let r=1;for(let e=0;e<n.length;e++)r*=n[e];return r}function Ma(e,t){return ne(e=G(e),t=G(t))||parseInt(e/t,10)}function Ta(e){return(e=G(e))instanceof Error?e:e*Math.PI/180}function Aa(){return 0!==arguments.length?L:Math.random()}function Na(){throw new Error("RANDARRAY is not implemented")}function La(e,t){if(2!==arguments.length)return L;if("boolean"==typeof e||""===e||"boolean"==typeof t||""===t)return M;if((e=G(e))>(t=G(t)))return N;const n=ne(e,t);return n||(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e)}function Ca(e){if((e=G(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",o=3;for(;o--;)r=(n[+t.pop()+10*o]||"")+r;return new Array(+t.join("")+1).join("M")+r}function Ia(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));if(n)return n;const r=Math.sign(e);e=Math.abs(e);var o=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return o*r}function Sa(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));if(n)return n;const r=e>0?1:-1;return r*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}function Da(e,t){if(2!==arguments.length)return L;if(""===e||""===t)return M;const n=ne(e=G(e),t=G(t));if(n)return n;const r=e>0?1:-1;return r*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}function Oa(e){return(e=G(e))instanceof Error?e:1/Math.cos(e)}function Ra(e){return(e=G(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))}function ja(e,t,n,r){if(oe(e=G(e),t=G(t),n=G(n),r=z(r)))return M;let o=r[0]*Math.pow(e,t);for(let i=1;i<r.length;i++)o+=r[i]*Math.pow(e,t+i*n);return o}function ka(){throw new Error("SEQUENCE is not implemented")}function Ua(e){return(e=G(e))instanceof Error?e:e<0?-1:0===e?0:1}function Pa(e){return(e=G(e))instanceof Error?e:Math.sin(e)}function Ha(e){return(e=G(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2}function Fa(e){return(e=G(e))instanceof Error?e:e<0?N:Math.sqrt(e)}function Va(e){return(e=G(e))instanceof Error?e:Math.sqrt(e*Math.PI)}function Ba(){return 1/Math.sqrt(2)}function Ya(){return Math.sqrt(2)}const qa={1:Gr,2:oo,3:io,4:Ro,5:Ho,6:xa,7:ai.S,8:ai.P,9:Ja,10:hi.S,11:hi.P,101:Gr,102:oo,103:io,104:Ro,105:Ho,106:xa,107:ai.S,108:ai.P,109:Ja,110:hi.S,111:hi.P};function _a(e){if(arguments.length<2)return L;if(!this.instance)return L;if((e=G(e))instanceof Error)return e;e=Math.trunc(e);const t=qa[e];if(!t)return M;for(let e=1;e<this.k.length;e++)if(!this.k[e])return L;if(this.instance.results)for(let e=1;e<arguments.length;e++){const t=j(this.k[e]);if(t.end){const n=$e(t.start),r=$e(t.end),o=this.instance.results.filter((e=>e>=n[1]&&e<=r[1]));for(let t=n[1];t<=r[1];t++)o.includes(t)||(arguments[e][t-n[1]]=void 0)}else{const n=$e(t.start);this.instance.results.includes(n[1])||(arguments[e]=void 0)}}if(e>100&&this.instance.rows)for(let e=1;e<arguments.length;e++){const t=j(this.k[e]);if(t.end){const n=$e(t.start),r=$e(t.end);for(let t=n[1];t<=r[1];t++)this.instance.rows[t]&&!1===this.instance.rows[t].visible&&(arguments[e][t-n[1]]=void 0)}else{const n=$e(t.start);this.instance.rows[n[1]]&&!1===this.instance.rows[n[1]].visible&&(arguments[e]=void 0)}}let n=Array.from(arguments);n.splice(0,1),n=n.filter((e=>!!e));for(let e=0;e<n.length;e++)Array.isArray(n[e])&&(n[e]=n[e].filter((e=>e)));return t(...n)}function Xa(e,t){if(2!==arguments.length)return L;const n=ne(e=G(e),t=G(t));return n||e-t}function Ga(e,t){if(2!==arguments.length)return L;const n=ne(e=G(e),t=G(t));return n||e*t}function Wa(e,t){if(2!==arguments.length)return L;if(e instanceof Error)return e;if(t instanceof Error)return t;ie(e,t)?(e=W(e),t=W(t)):(e=G(e),t=G(t));const n=ne(e,t);return n||e>t}function za(e,t){if(2!==arguments.length)return L;ie(e,t)?(e=W(e),t=W(t)):(e=G(e),t=G(t));const n=ne(e,t);return n||e>=t}function $a(e,t){if(2!==arguments.length)return L;ie(e,t)?(e=W(e),t=W(t)):(e=G(e),t=G(t));const n=ne(e,t);return n||e<t}function Ka(e,t){if(2!==arguments.length)return L;ie(e,t)?(e=W(e),t=W(t)):(e=G(e),t=G(t));const n=ne(e,t);return n||e<=t}function Za(e,t){return 2!==arguments.length?L:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)}function Qa(e,t){return 2!==arguments.length?L:ba(e,t)}function Ja(){if(arguments.length<1)return L;let e=0;return le(Y(arguments),(t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if(Array.isArray(t)){const n=Ja.apply(null,t);n instanceof Error?e=n:e+=n}})),e}function es(e,t,n){if(arguments.length<2||arguments.length>3)return L;if(n){const t=Array.isArray(e);if(t!==Array.isArray(n))return M;if(t&&(e.length!==n.length||e[0].length!==n[0].length))return M}if(Array.isArray(e)||(e=[e]),e=B(e),n?(Array.isArray(n)||(n=[n]),n=B(n)):n=e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let r=0;const o=pr(t+"");for(let t=0;t<e.length;t++){const i=e[t],a=n[t];r+=cr([ur(i,lr)].concat(o))?a:0}return r}function ts(){if(arguments.length<3||arguments.length>3&&arguments.length%2==0)return L;Array.isArray(arguments[0])||(arguments[0]=[arguments[0]]),Array.isArray(arguments[0][0])||(arguments[0][0]=[arguments[0][0]]);const e=arguments[0].length,t=arguments[0][0].length,n=Y(arguments),r=z(B(n.shift()));if(r instanceof Error)return r;const o=n,i=o.length/2;for(let n=0;n<i;n++){if(Array.isArray(o[2*n])||(o[2*n]=[o[2*n]]),Array.isArray(o[2*n][0])||(o[2*n][0]=[o[2*n][0]]),e!==o[2*n].length||t!==o[2*n][0].length)return M;o[2*n]=B(o[2*n])}let a=0;for(let e=0;e<r.length;e++){let t=!1;for(let n=0;n<i;n++){const r=o[2*n][e];let i=!1;const a=pr(o[2*n+1]+"");if(i=cr([ur(r,lr)].concat(a)),!i){t=!1;break}t=!0}t&&(a+=r[e])}return a}function ns(){if(!arguments||0===arguments.length)return L;let e=Array.isArray(arguments[0])?arguments[0].length:1,t=1;arguments[0][0]&&Array.isArray(arguments[0][0])&&(t=arguments[0][0].length);for(let n=1;n<arguments.length;n++){if((Array.isArray(arguments[n])?arguments[n].length:1)!==e)return M;let r=1;if(arguments[n][0]&&Array.isArray(arguments[n][0])&&(r=arguments[n][0].length),r!==t)return M}if(1===e&&1===t)for(let e=0;e<arguments.length;e++)arguments[e]=[[arguments[e]]];let n=1;for(let e=0;e<arguments.length;e++){const t=arguments[e];for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++){if(t[e][n]instanceof Error)return t[e][n];"number"!=typeof t[e][n]&&(t[e][n]=M)}n=ut["*"](n,arguments[e])}const r=B(n),o=r.reduce((function(e,t){return t instanceof Error?e:e+t}),0);return o}function rs(){const e=z(B(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let r=0;r<n;r++)t+=Cr(e[r])?e[r]*e[r]:0;return t}function os(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;let n=0;for(let r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n}function is(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;let n=0;e=z(B(e)),t=z(B(t));for(let r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n}function as(e,t){if(oe(e=z(B(e)),t=z(B(t))))return M;let n=0;e=B(e),t=B(t);for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n}function ss(e){return(e=G(e))instanceof Error?e:Math.tan(e)}function ls(e){if((e=G(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)}function us(e,t){const n=ne(e=G(e),t=G(t));return n||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}const cs=Kr.DIST,fs=Kr.INV,ds=Zr.DIST,ps=ki.MATH,hs=ki.PRECISE,gs=Qr.DIST,ms=Qr.DIST.RT,vs=Qr.INV,ys=Qr.INV.RT,ws=Qr.TEST,Es=fo.P,bs=fo.P,xs=fo.S,Ms=Zr.INV,Ts=bn.PRECISE,As=En.PRECISE,Ns=ho.DIST,Ls=go.DIST,Cs=go.DIST.RT,Is=go.INV,Ss=go.INV.RT,Ds=Ji.MATH,Os=Ji.PRECISE,Rs=go.TEST,js=Eo.DIST,ks=Eo.INV,Us=bo.PRECISE,Ps=No.DIST,Hs=Oo.INV,Fs=Oo.DIST,Vs=Oo.INV,Bs=Vo.MULT,Ys=Vo.SNGL,qs=Bo.DIST,_s=Ie.INTL,Xs=Yo.DIST,Gs=Yo.INV,Ws=Yo.S.DIST,zs=Yo.S.INV,$s=_o.EXC,Ks=_o.INC,Zs=Xo.EXC,Qs=Xo.INC,Js=$o.DIST,el=Zo.EXC,tl=Zo.INC,nl=Qo.AVG,rl=Qo.EQ,ol=ni.P,il=ai.P,al=ai.S,sl=fi.DIST,ll=fi.DIST.RT,ul=fi.INV,cl=fi.TEST,fl=hi.P,dl=hi.S,pl=vi.DIST,hl=Pe.INTL,gl=yi.TEST;function ml(e){const t=[];return le(e,(e=>{e&&t.push(e)})),t}function vl(e,t){let n=null;return le(e,((e,r)=>{if(e[0]===t)return n=r,!1})),null==n?M:n}function yl(e,t){const n={};for(let t=1;t<e[0].length;++t)n[t]=!0;let r=t[0].length;for(let e=1;e<t.length;++e)t[e].length>r&&(r=t[e].length);for(let o=1;o<e.length;++o)for(let i=1;i<e[o].length;++i){let a=!1,s=!1;for(let n=0;n<t.length;++n){const l=t[n];if(l.length<r)continue;const u=l[0];if(e[o][0]===u){s=!0;for(let t=1;t<l.length;++t)if(!a)if(void 0===l[t]||"*"===l[t])a=!0;else{const n=pr(l[t]+""),r=[ur(e[o][i],lr)].concat(n);a=hr(r)}}}s&&(n[i]=n[i]&&a)}const o=[];for(let t=0;t<e[0].length;++t)n[t]&&o.push(t-1);return o}function wl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=0;return le(r,(e=>{i+=o[e]})),0===r.length?x:i/r.length}function El(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);const i=[];return le(r,(e=>{i.push(o[e])})),oo(i)}function bl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);const i=[];return le(r,(e=>{i.push(o[e])})),io(i)}function xl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];return o=se("string"==typeof t?e[vl(e,t)]:e[t]),0===r.length?M:r.length>1?N:o[r[0]]}function Ml(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=o[r[0]];return le(r,(e=>{i<o[e]&&(i=o[e])})),i}function Tl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=o[r[0]];return le(r,(e=>{i>o[e]&&(i=o[e])})),i}function Al(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=[];le(r,(e=>{i.push(o[e])})),i=ml(i);let a=1;return le(i,(e=>{a*=e})),a}function Nl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=[];return le(r,(e=>{i.push(o[e])})),i=ml(i),ai.S(i)}function Ll(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);let i=[];return le(r,(e=>{i.push(o[e])})),i=ml(i),ai.P(i)}function Cl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);const i=[];return le(r,(e=>{i.push(o[e])})),Ja(i)}function Il(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);const i=[];return le(r,(e=>{i.push(o[e])})),hi.S(i)}function Sl(e,t,n){if(isNaN(t)&&"string"!=typeof t)return M;const r=yl(e,n);let o=[];if("string"==typeof t){const n=vl(e,t);o=se(e[n])}else o=se(e[t]);const i=[];return le(r,(e=>{i.push(o[e])})),hi.P(i)}function Dl(e){return e&&e.getTime&&!isNaN(e.getTime())}function Ol(e){return e instanceof Date?e:new Date(e)}function Rl(e,t,n,r,o,i,a){return e=Ol(e),t=Ol(t),n=Ol(n),Dl(e)&&Dl(t)&&Dl(n)?r<=0||o<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(a)||n<=e?N:(o=o||0)*r*Ve(e,n,a=a||0):M}function jl(){throw new Error("ACCRINTM is not implemented")}function kl(){throw new Error("AMORDEGRC is not implemented")}function Ul(){throw new Error("AMORLINC is not implemented")}function Pl(){throw new Error("COUPDAYBS is not implemented")}function Hl(){throw new Error("COUPDAYS is not implemented")}function Fl(){throw new Error("COUPDAYSNC is not implemented")}function Vl(){throw new Error("COUPNCD is not implemented")}function Bl(){throw new Error("COUPNUM is not implemented")}function Yl(){throw new Error("COUPPCD is not implemented")}function ql(e,t,n,r,o,i){if(oe(e=G(e),t=G(t),n=G(n)))return M;if(e<=0||t<=0||n<=0)return N;if(r<1||o<1||r>o)return N;if(0!==i&&1!==i)return N;const a=hu(e,t,n,0,i);let s=0;1===r&&(0===i&&(s=-n),r++);for(let t=r;t<=o;t++)s+=1===i?Ql(e,t-2,a,n,1)-a:Ql(e,t-1,a,n,0);return s*=e,s}function _l(e,t,n,r,o,i){if(oe(e=G(e),t=G(t),n=G(n)))return M;if(e<=0||t<=0||n<=0)return N;if(r<1||o<1||r>o)return N;if(0!==i&&1!==i)return N;const a=hu(e,t,n,0,i);let s=0;1===r&&(s=0===i?a+n*e:a,r++);for(let t=r;t<=o;t++)s+=i>0?a-(Ql(e,t-2,a,n,1)-a)*e:a-Ql(e,t-1,a,n,0)*e;return s}function Xl(e,t,n,r,o){if(o=void 0===o?12:o,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o)))return M;if(e<0||t<0||n<0||r<0)return N;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return N;if(r>n)return N;if(t>=e)return 0;const i=(1-Math.pow(t/e,1/n)).toFixed(3),a=e*i*o/12;let s=a,l=0;const u=r===n?n-1:r;for(let t=2;t<=u;t++)l=(e-s)*i,s+=l;return 1===r?a:r===n?(e-s)*i:l}function Gl(e,t,n,r,o){if(o=void 0===o?2:o,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o)))return M;if(e<0||t<0||n<0||r<0||o<=0)return N;if(r>n)return N;if(t>=e)return 0;let i=0,a=0;for(let s=1;s<=r;s++)a=Math.min(o/n*(e-i),e-t-i),i+=a;return a}function Wl(){throw new Error("DISC is not implemented")}function zl(e,t){if(oe(e=G(e),t=G(t)))return M;if(t<0)return N;if(t>=0&&t<1)return x;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r,n}function $l(e,t){if(oe(e=G(e),t=G(t)))return M;if(t<0)return N;if(t>=0&&t<1)return x;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n}function Kl(){throw new Error("DURATION is not implemented")}function Zl(e,t){return oe(e=G(e),t=G(t))?M:e<=0||t<1?N:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)}function Ql(e,t,n,r,o){if(r=r||0,o=o||0,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o)))return M;let i;if(0===e)i=r+n*t;else{const a=Math.pow(1+e,t);i=1===o?r*a+n*(1+e)*(a-1)/e:r*a+n*(a-1)/e}return-i}function Jl(e,t){if(oe(e=G(e),t=z(B(t))))return M;const n=t.length;let r=e;for(let e=0;e<n;e++)r*=1+t[e];return r}function eu(){throw new Error("INTRATE is not implemented")}function tu(e,t,n,r,o,i){if(o=o||0,i=i||0,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o),i=G(i)))return M;const a=hu(e,n,r,o,i);let s;return s=1===t?1===i?0:-r:1===i?Ql(e,t-2,a,r,1)-a:Ql(e,t-1,a,r,0),s*e}function nu(e,t){if(t=t||0,oe(e=z(B(e)),t=G(t)))return M;const n=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,(t[n]-t[0])/365);return o},r=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const i=(t[n]-t[0])/365;o-=i*e[n]/Math.pow(r,i+1)}return o},o=[];let i=!1,a=!1;for(let t=0;t<e.length;t++)o[t]=0===t?0:o[t-1]+365,e[t]>0&&(i=!0),e[t]<0&&(a=!0);if(!i||!a)return N;let s,l,u,c=t=void 0===t?.1:t,f=!0;do{u=n(e,o,c),s=c-u/r(e,o,c),l=Math.abs(s-c),c=s,f=l>1e-10&&Math.abs(u)>1e-10}while(f);return c}function ru(e,t,n,r){return oe(e=G(e),t=G(t),n=G(n),r=G(r))?M:r*e*(t/n-1)}function ou(){throw new Error("MDURATION is not implemented")}function iu(e,t,n){if(oe(e=z(B(e)),t=G(t),n=G(n)))return M;const r=e.length,o=[],i=[];for(let t=0;t<r;t++)e[t]<0?o.push(e[t]):i.push(e[t]);const a=-lu(n,i)*Math.pow(1+n,r-1),s=lu(t,o)*(1+t);return Math.pow(a/s,1/(r-1))-1}function au(e,t){return oe(e=G(e),t=G(t))?M:e<=0||t<1?N:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)}function su(e,t,n,r,o){if(o=void 0===o?0:o,r=void 0===r?0:r,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o)))return M;if(0===e)return-(n+r)/t;{const i=t*(1+e*o)-r*e,a=n*e+t*(1+e*o);return Math.log(i/a)/Math.log(1+e)}}function lu(){const e=z(B(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n}function uu(){throw new Error("ODDFPRICE is not implemented")}function cu(){throw new Error("ODDFYIELD is not implemented")}function fu(){throw new Error("ODDLPRICE is not implemented")}function du(){throw new Error("ODDLYIELD is not implemented")}function pu(e,t,n){return oe(e=G(e),t=G(t),n=G(n))?M:e<=0?N:(Math.log(n)-Math.log(t))/Math.log(1+e)}function hu(e,t,n,r,o){if(r=r||0,o=o||0,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o)))return M;let i;if(0===e)i=(n+r)/t;else{const a=Math.pow(1+e,t);i=1===o?(r*e/(a-1)+n*e/(1-1/a))/(1+e):r*e/(a-1)+n*e/(1-1/a)}return-i}function gu(e,t,n,r,o,i){return o=o||0,i=i||0,oe(e=G(e),n=G(n),r=G(r),o=G(o),i=G(i))?M:hu(e,n,r,o,i)-tu(e,t,n,r,o,i)}function mu(){throw new Error("PRICE is not implemented")}function vu(){throw new Error("PRICEDISC is not implemented")}function yu(){throw new Error("PRICEMAT is not implemented")}function wu(e,t,n,r,o){return r=r||0,o=o||0,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o))?M:0===e?-n*t-r:((1-Math.pow(1+e,t))/e*n*(1+e*o)-r)/Math.pow(1+e,t)}function Eu(e,t,n,r,o,i){if(i=void 0===i?.01:i,r=void 0===r?0:r,o=void 0===o?0:o,oe(e=G(e),t=G(t),n=G(n),r=G(r),o=G(o),i=G(i)))return M;const a=1e-10;let s=i;o=o?1:0;for(let i=0;i<20;i++){if(s<=-1)return N;let i,l,u;if(Math.abs(s)<a?i=n*(1+e*s)+t*(1+s*o)*e+r:(l=Math.pow(1+s,e),i=n*l+t*(1/s+o)*(l-1)+r),Math.abs(i)<a)return s;if(Math.abs(s)<a)u=n*e+t*o*e;else{l=Math.pow(1+s,e);const r=e*Math.pow(1+s,e-1);u=n*r+t*(1/s+o)*r+t*(-1/(s*s))*(l-1)}s-=i/u}return s}function bu(){throw new Error("RECEIVED is not implemented")}function xu(e,t,n){return oe(e=G(e),t=G(t),n=G(n))?M:0===e||0===t?N:Math.pow(n/t,1/e)-1}function Mu(e,t,n){return oe(e=G(e),t=G(t),n=G(n))?M:0===n?N:(e-t)/n}function Tu(e,t,n,r){return oe(e=G(e),t=G(t),n=G(n),r=G(r))?M:0===n||r<1||r>n?N:(e-t)*(n-(r=parseInt(r,10))+1)*2/(n*(n+1))}function Au(e,t,n){return oe(e=ee(e),t=ee(t),n=G(n))?M:n<=0||e>t||t-e>31536e6?N:365*n/(360-n*we(e,t,!1))}function Nu(e,t,n){return oe(e=ee(e),t=ee(t),n=G(n))?M:n<=0||e>t||t-e>31536e6?N:100*(1-n*we(e,t,!1)/360)}function Lu(e,t,n){return oe(e=ee(e),t=ee(t),n=G(n))?M:n<=0||e>t||t-e>31536e6?N:360*(100-n)/(n*we(e,t,!1))}function Cu(){throw new Error("VDB is not implemented")}function Iu(e,t,n){if(oe(e=z(B(e)),t=te(B(t)),n=G(n)))return M;const r=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,ye(t[n],t[0])/365);return o},o=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const i=ye(t[n],t[0])/365;o-=i*e[n]/Math.pow(r,i+1)}return o};let i=!1,a=!1;for(let t=0;t<e.length;t++)e[t]>0&&(i=!0),e[t]<0&&(a=!0);if(!i||!a)return N;let s,l,u,c=n=n||.1,f=!0;do{u=r(e,t,c),s=c-u/o(e,t,c),l=Math.abs(s-c),c=s,f=l>1e-10&&Math.abs(u)>1e-10}while(f);return c}function Su(e,t,n){if(oe(e=G(e),t=z(B(t)),n=te(B(n))))return M;let r=0;for(let o=0;o<t.length;o++)r+=t[o]/Math.pow(1+e,ye(n[o],n[0])/365);return r}function Du(){throw new Error("YIELD is not implemented")}function Ou(){throw new Error("YIELDDISC is not implemented")}function Ru(){throw new Error("YIELDMAT is not implemented")}var ju=new RegExp(/^-?\d+(\.\d+)?$/);function ku(){if(0===arguments.length)return L;const e=B(arguments);let t=M;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===M&&(t=!0),e[n]||(t=!1))}return t}function Uu(){if(arguments.length<2)return L;let t=arguments[0];if(Array.isArray(t)){const e=Array.from(arguments).slice(1);return t.map((t=>Uu(t,...e)))}if(Object.values(e).includes(t))return t;if("string"==typeof t){if(t=t.trim(),!ju.test(t))return M;t=parseFloat(t)}return Number.isInteger(t)||(t=Math.trunc(t)),t<1||t>254||arguments.length<t+1?M:arguments[t]}function Pu(){return 0!==arguments.length&&L}function Hu(e,t,n){if(arguments.length<2||arguments.length>3)return L;if(e instanceof Error)return e;if("string"==typeof e)if("true"===e)e=!0;else{if("false"!==e)return M;e=!1}return null==t&&(t=0),3!==arguments.length&&(n=!1),null==n&&(n=0),Array.isArray(e)?e.map((e=>Hu(e,t,n))):e?t:n}function Fu(){if(arguments.length<2||arguments.length%2==1)return L;for(let t=0;t<arguments.length/2;t++){let n=arguments[2*t];if(Object.values(e).includes(n))return n;if("true"===n)n=!0;else if("false"===n)n=!1;else if("string"==typeof n)return M;if(n)return arguments[2*t+1]??0}return L}function Vu(e,t){return 2!==arguments.length?L:null===e?0:Er(e)?t:e}function Bu(e,t){return 2!==arguments.length?L:null===e?0:e===L?t:e}function Yu(e){if(1!==arguments.length)return L;if(e instanceof Error)return e;if("string"==typeof e){const t=e.toUpperCase();return"TRUE"!==t&&("FALSE"===t||M)}return!e}function qu(){if(arguments.length<1)return L;const e=B(arguments);let t=M;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===M&&(t=!1),e[n]&&(t=!0))}return t}function _u(){return!0}function Xu(){const e=B(arguments);let t=M;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===M&&(t=0),e[n]&&t++)}return t===M?t:!!(1&Math.floor(Math.abs(t)))}function Gu(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,r=Math.floor(n/2);let o=!1;const i=n%2!=0,a=n%2==0?null:arguments[arguments.length-1];if(r)for(let n=0;n<r;n++)if(t===arguments[2*n+1]){e=arguments[2*n+2],o=!0;break}o||(e=i?a:L)}else e=M;return e}const Wu=(e,t)=>{const n=typeof e;let r=null,o=0,i=t.length-1;for(;i>=o;){let a=o+Math.trunc((i-o)/2);for(;a<=i&&n!==typeof t[a];)a++;if(a>i)for(a--;a>=o&&n!==typeof t[a];)a--;if(a<o)break;if(e>t[a])r=a,o=a+1;else{if(!(e<t[a]))return a;i=a-1}}return r};function zu(e,t,n=1){if(arguments.length<2||arguments.length>3)return L;if(!(t instanceof Array))return L;if(e instanceof Error)return e;if(n instanceof Error)return T;if(t.length>1&&t[0].length>1)return L;if(t=B(t),"number"!=typeof(n=k(n)))return M;const r=typeof e;if(n>0){const n=Wu(e,t);return null!==n?n+1:L}if(0===n){const n=pr(e+""),r=t.findIndex((e=>cr([ur(e,lr)].concat(n))));return r>=0?r+1:L}let o=null;for(let n=0;n<t.length;n++)if(r===typeof t[n]){if(e>t[n])break;if(!(e<t[n]))return n+1;o=n}if(null!==o){for(;o>=0&&t[o]instanceof Error;)o--;return o>=0?o+1:L}return L}const $u=/^-*\d/,Ku=/^\w/,Zu={1:function(e,t){return"$"+t+"$"+e},2:function(e,t){return t+"$"+e},3:function(e,t){return"$"+t+e},4:function(e,t){return t+e}},Qu={1:function(e,t){return"R"+e+"C"+t},2:function(e,t){return"R"+e+"C["+t+"]"},3:function(e,t){return"R["+e+"]C"+t},4:function(e,t){return"R["+e+"]C["+t+"]"}};function Ju(e,t,n=1,r=!0,o){if(arguments.length<2||arguments.length>5)return L;const i=ne(e,t,n,r,o);if(i)return i;if(e=k(e),t=k(t),"string"==typeof e)if("TRUE"===(e=e.toUpperCase()))e=1;else{if("FALSE"!==e)return M;e=0}if("string"==typeof t)if("TRUE"===(t=t.toUpperCase()))t=1;else{if("FALSE"!==t)return M;t=0}if(e=Math.trunc(e),t=Math.trunc(t),e<1||t<1)return M;if("number"!=typeof(n=k(n)))return M;if((n=Math.trunc(n))<1||n>4)return M;if("boolean"!=typeof(r=X(r)))return M;let a="";if(void 0!==o){const e=typeof o;if(null===o)o="";else{"string"!==e&&(o=o.toString());const t=o.toUpperCase();"TRUE"===t||"FALSE"===t?o="'"+t+"'":o.length>0&&($u.test(o)||!Ku.test(o))&&(o="'"+o+"'")}a=o+"!"}if(r){const r=We(t-1);return a+Zu[n](e,r)}return a+Qu[n](e,t)}function ec(){throw new Error("AREAS is not implemented")}function tc(){throw new Error("FORMULATEXT is not implemented")}function nc(){throw new Error("GETPIVOTDATA is not implemented")}function rc(e,t){if(arguments.length<1||arguments.length>2)return L;1===arguments.length&&(t=e);var n=document.createElement("a");return n.target="_blank",n.href=e,n.innerText=t,n}const oc=/^R(\[\d+]|\d+)C(\[\d+]|\d+)$/;var ic=function(e){return Array.isArray(e)&&(e=e[0]),e=e.replace(new RegExp(/'/g),"").toUpperCase(),window[e]?window[e]:null};function ac(e,t){if(arguments.length<1||arguments.length>2)return L;void 0===t&&(t=!0);const n=ne(e,t=X(t));if(n)return n;if("string"!=typeof e)return T;if(e=e.toUpperCase(),!t){const t=e.split("!",2),n=t[t.length-1],r=oc.exec(n);if(!r)return T;r[1].startsWith("[")&&(r[1]=r[1].slice(1,-1)),r[2].startsWith("[")&&(r[2]=r[2].slice(1,-1));const o=ze(r[2]-1,r[1]-1);t[t.length-1]=o,e=t.join("!")}e=e.replace("!",".");const r=this.instance.getValue(e);if(r){let t,n,r=e.split(".",2);r[1]?(t=r[1],n=ic(r[0])):(t=r[0],n=this.instance),n.formula[t]||(n.formula[t]=[]),n.formula[t].push(ze(this.x,this.y))}return r??T}function sc(e,t,n,r,o){if(arguments.length<3||arguments.length>5)return L;const i=ne(e,t,n,r,o);if(i)return i;if("number"!=typeof t||"number"!=typeof n)return M;const a=j(this.k[0]),s=$e(a.start);if(void 0===r)r=a.end?$e(a.end)[1]-s[1]+1:1;else if("number"!=typeof r)return M;if(void 0===o)o=a.end?$e(a.end)[0]-s[0]+1:1;else if("number"!=typeof o)return M;const l=a.start;let u,c=this.instance.helpers.shiftFormula(l,n,t);if("#REF!"===c)return T;if(!r||!o)return T;if(r-=Math.sign(r),o-=Math.sign(o),!r&&!o)return a.sheet&&(c=a.sheet+"."+c),this.instance.getValue(c);{const e=this.instance.helpers.shiftFormula(c,o,r);if("#REF!"===e)return T;c+=":"+e,u=Qe(c);const t=e=>Array.isArray(e)?e.map((e=>t(e))):(a.sheet&&(e=a.sheet+"."+e),this.instance.getValue(e));u=u.map(t)}return u}function lc(){throw new Error("RTD is not implemented")}function uc(e,t,n,r=!0){if(arguments.length<3||arguments.length>4)return L;if(!t)return L;if("number"!=typeof(n=k(n))||n<1)return M;if(n>t[0].length)return T;if(r instanceof Error)return r;if("boolean"!=typeof(r=X(r)))return M;if(r){const r=Wu(e,B(t.map((e=>e[0]))));return null===r?L:t[r][n-1]}for(let r=0;r<t.length;r++)if(t[r][0]===e)return t[r][n-1];return L}function cc(e,t,n,r){return arguments.length<3||arguments.length>4?L:(Array.isArray(t)&&(t=ue(t)),uc(e,t,n,r))}function fc(e,t,n){if(arguments.length<2||arguments.length>3)return L;if(e instanceof Error)return e;if(Array.isArray(t)||(t=[t]),Array.isArray(t[0])||(t[0]=[t[0]]),t[0].length>t.length?(void 0===n&&(n=t[t.length-1]),t=t[0]):(void 0===n&&(n=t.map((e=>e[e.length-1]))),t=t.map((e=>e[0]))),Array.isArray(n)||(n=[n]),Array.isArray(n[0])||(n[0]=[n[0]]),n.length>1&&n[0].length>1)return L;t=B(t),n=B(n);const r=Wu(e,t);return null===r?L:r>=n.length?T:n[r]}function dc(e,t,n){if(arguments.length<2||arguments.length>3)return L;const r=ne(e,t,n);if(r)return r;Array.isArray(e)||(e=[e]),Array.isArray(e[0])||(e[0]=[e[0]]);const o=1===e.length;if(void 0===n&&(o?(n=t,t=1):n=1),"number"!=typeof(n=k(n)))return M;if(n=Math.trunc(n),"number"!=typeof(t=k(t)))return M;if(t=Math.trunc(t),n<0||t<0)return M;const i=e.length,a=e[0].length;if(t>i||n>a)return T;let s;if(0===n&&0===t)s=e;else if(0===n)s=[e[t-1]];else{if(0!==t)return e[t-1][n-1];s=e.map((e=>[e[n-1]]))}return 1===s.length&&1===s[0].length?s[0][0]:s}function pc(){throw new Error("ENCODEURL is not implemented")}function hc(){throw new Error("IMPORTDATA is not implemented")}function gc(){throw new Error("IMPORTFEED is not implemented")}function mc(){throw new Error("IMPORTHTML is not implemented")}function vc(){throw new Error("IMPORTRANGE is not implemented")}function yc(){throw new Error("IMPORTXML is not implemented")}function wc(){throw new Error("ISURL is not implemented")}function Ec(){throw new Error("CUBEKPIMEMBER is not implemented")}function bc(){throw new Error("CUBEMEMBER is not implemented")}function xc(){throw new Error("CUBEMEMBERPROPERTY is not implemented")}function Mc(){throw new Error("CUBERANKEDMEMBER is not implemented")}function Tc(){throw new Error("CUBESET is not implemented")}function Ac(){throw new Error("CUBESETCOUNT is not implemented")}function Nc(){throw new Error("CUBEVALUE is not implemented")}function Lc(){throw new Error("TO_DATE is not implemented")}function Cc(){throw new Error("TO_DOLLARS is not implemented")}function Ic(){throw new Error("TO_PERCENT is not implemented")}function Sc(){throw new Error("TO_PURE_NUMBER is not implemented")}function Dc(){throw new Error("TO_TEXT is not implemented")}function Oc(){throw new Error("ISBETWEEN is not implemented")}function Rc(){throw new Error("UMINUS is not implemented")}function jc(){throw new Error("UNARY_PERCENT is not implemented")}function kc(){throw new Error("UPLUS is not implemented")}const Uc={...f,...d,...t,...a,...p,...s,...h,...g,...c,...l,...u,...o,...ut,...m,...v,...y,...w,...i};var Pc=[",",";"],Hc=["(",")","{","}","|"].concat(Pc),Fc=["=","!","<",">"],Vc=["-","+","/","*","^","&"],Bc=new RegExp(/^([A-Z0-9_]+(!|\.))?(\$?[A-Z_]+\$?[0-9]*)(:\$?[A-Z]+\$?[0-9]*)?$/),Yc=new RegExp(/^\d+(\.\d+){0,1}$/),qc=function(e){for(var t="",n=[],r=!1,o=0;o<e.length;o++)if(r){if(t+=e[o],r===e[o]){if('"'===e[o]&&'"'===e[o+1]){t+='"',o++;continue}r=!1}}else if('"'===e[o]||"'"===e[o])r=e[o],t&&(n.push(t),t=""),t+=e[o];else if(t.length>0&&'"'===t[0]&&(1===t.length||'"'!==t[t.length-1]))t+=e[o];else if(["+","-"].includes(e[o])&&(0===o||"("===e[o-1]||Pc.includes(e[o-1])||_c(e[o-1])||Xc(e[o-1])))t&&(n.push(t),t=""),n.push("+"===e[o]?"p":"m");else if(Vc.includes(e[o]))t&&(n.push(t),t=""),n.push(e[o]);else if("!"===e[o]&&"="!==e[o+1])t+=e[o];else if(Fc.includes(e[o])){t&&(n.push(t),t="");var i=e[o];Fc.includes(e[o+1])&&(i+=e[++o]),n.push(i)}else Hc.includes(e[o])?(t&&(n.push(t),t=""),n.push(e[o])):t+=e[o];return t&&n.push(t),n},_c=function(e){return Fc.includes(e[0])},Xc=function(e){return Vc.includes(e)},Gc=function(e){return"string"==typeof e&&e.length>=2&&'"'===e[0]&&'"'===e[e.length-1]},Wc=function(e){return{"^":4,"*":3,"/":3,"+":2,"-":2,"&":1}[e]},zc=function(e){var t=this.vars[e],n=typeof t;if("number"===n||"boolean"===n||"object"===n)return t;if(void 0===t)throw new Error("#ERROR");if(Gc(t))return t.slice(1,-1);if(Yc.test(t))return parseFloat(t);var r=Qc.call(this,t);return this.vars[e]=r,"string"==typeof this.vars[e]&&(this.vars[e]='"'+this.vars[e]+'"'),r},$c=function(e){var t=this;return e.map((function(e){if(6===e.type){var n=null;return e.value.includes(":")?(n=Qe.call(t,e.value).map((function(e){return e.map((function(e){return zc.call(t,e)}))})),{key:e.value,value:n,type:1}):{key:e.value,value:zc.call(t,e.value),type:1}}return e}))},Kc=function(e){for(var t=[],n=[];e.length>0;){var r=e[0],o=parseFloat(r);if(r===this.divisor){for(e[1]===this.divisor&&t.push({value:null,type:1});n.length>0&&"("!==n[0].value;)t.push(n.shift());if(0===n.length)return}else if(")"===r){for(;n.length>0&&"("!==n[0].value;)t.push(n.shift());if(0===n.length)return;"("===n[0].value&&n.shift(),n.length>1&&"("===n[0].value&&5===n[1].type&&(n.shift(),t.push(n.shift()))}else if("("===r)n.unshift({value:r,type:0});else if("m"===r||"p"===r)n.unshift({value:r,type:2});else if(Number.isNaN(o))if(Gc(r))t.push({value:r.slice(1,-1),type:1});else if(_c(r)){for(;n.length>0&&4!==n[0].type&&"("!==n[0].value;)t.push(n.shift());n.unshift({value:r,type:4})}else if(Xc(r)){for(;n.length>0&&(3===n[0].type&&(Wc(n[0].value)>Wc(r)||Wc(n[0].value)===Wc(r)&&"^"!==r)||5===n[0].type||2===n[0].type);)t.push(n.shift());n.unshift({value:r,type:3})}else if(Bc.test(r))if("("===e[1]){if(-1==r.indexOf("."))var i=this[r];else i=jSuites.path.call(this,r);i?(n.unshift({value:r,type:5}),t.push({value:",",type:0}),n.unshift({value:"(",type:0}),e.shift()):t.push({value:A,type:1})}else t.push({value:r,type:6});else{if("'"!==r[0])throw new Error("#ERROR");t.push({value:r,type:6})}else t.push({value:o,type:1});e.shift()}if(!(n.findIndex((function(e){return"("===e.value||")"===e.value}))>=0))return t.concat(n)},Zc=function(e){for(var t=[],n=null;e.length>0;)if(1===(n=e.shift()).type)t.push(n);else if(2===n.type)"m"===n.value&&(t[t.length-1].value=this.OP_MINUS(t[t.length-1].value));else if(3===n.type||4===n.type)if("function"==typeof this[n.value]){var r=t.pop(),o=t.pop();t.push({value:this[n.value](o.value,r.value),type:1})}else t.push({value:C,type:1});else if(5===n.type){for(var i=t.length-1;i>=0&&","!==t[i].value;)i--;var a=t.slice(i+1),s=a.map((function(e){return e.value})),l=a.map((function(e){return e.key}));if(t=t.slice(0,i),-1==n.value.indexOf("."))var u=this[n.value];else u=jSuites.path.call(this,n.value);t.push({value:u.call({x:this.x,y:this.y,instance:this.instance,k:l,request:this.request},...s),type:1})}else t.push(n);return t[0].value},Qc=function(e){var t=qc.call(this,e);return t=Kc.call(this,t),t=$c.call(this,t),Zc.call(this,t)};const Jc=Qc;function ef(e){for(var t="",n=!1,r=0;r<e.length;r++)'"'!=e[r]&&"'"!=e[r]||(n?n===e[r]&&(n=!1):n=e[r]),n?t+=e[r]:(" "!==e[r]&&"$"!==e[r]&&(t+=e[r].toUpperCase()),(t.endsWith("TRUE")||t.endsWith("FALSE"))&&(t+="()"));return t}function tf(t){var n=t.slice(1,-1);return Object.values(e).find((function(e){return e.message===n}))||t}function nf(e){return Array.isArray(e)?e.map((function(e){return nf(e)})):e instanceof Error?e.message.startsWith("#")?e.message:"#ERROR":e}let rf=0;const of=function(e,t,n,r,o){of.instance=o,of.x=n,of.y=r;var i=E.label();if(i){if(rf>100)return"#UNLICENSED";rf++,console.log(i)}if(t){var a=Object.keys(t);for(n=0;n<a.length;n++){var s=ef(a[n]);if("string"==typeof t[a[n]])of.vars[s]=ef(t[a[n]]),of.vars[s]=tf(of.vars[s]);else if(Array.isArray(t[a[n]]))for(var l=t[a[n]],u=0;u<l.length;u++)for(var c=0;c<l[u].length;c++){var f=of.getColumnNameFromCoords(c,u);of.vars[s+"!"+f]=l[u][c]}else of.vars[s]=t[a[n]]}}of.request={e,v:JSON.stringify(of.vars)};var d=null;try{d=Jc.call(of,ef(e)),of.adjustPrecision&&(d=function(e){if("number"==typeof e&&!Number.isInteger(e)){var t=e.toString().split(".");if(t[1]&&t[1].length>10){var n=0,r=t[1][t[1].length-2];if(0==r||9==r){for(var o=t[1].length-2;o>0;o--){if(!(n>=0&&t[1][o]==r)){n=0;break}if(++n>6)break}if(n)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e}(d))}catch(e){1==of.debug&&console.error(e),d=e}return of.request={},of.vars={},nf(d)};of.adjustPrecision=!1,of.request=null,of.instance=null,of.x=null,of.y=null,of.debug=!0,of.vars={},of.setFormula=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"!=typeof e[t[n]]&&"object"!=typeof e[t[n]]||(of[t[n]]=e[t[n]])},of.license=function(e){E(e)},function(e){["ASCIITOCHAR","BOOL2INT","BOOL2STRING","CARX","CARY","CHARTOASCII","DECSEX","INT2BOOL","NUM2STRING","POLA","POLR","SEXDEC","STRING","CURRENTDATE","CURRENTDATETIME","CURRENTTIME","DATE2UNIX","DAYNAME","DAYOFYEAR","DAYSINMONTH","DAYSINYEAR","EASTERSUNDAY","HOURS","ISLEAPYEAR","MINUTES","MONTHNAME","MONTHS","NETWORKDAY","SECONDS","UNIX2DATE","WEEKS","WEEKSINYEAR","YEARS","COMPOUND","CONTINUOUS","DURATION_ADD","EFFECTIVE","EURO","EUROCONVERT","FV_ANNUITY","LEVEL_COUPON","PV_ANNUITY","ZERO_COUPON","ERRORTYPE","FILENAME","FORMULA","ISNOTTEXT","ISNUM","ISTIME","NAND","NOR","MULTIPLE.OPERATIONS","CEIL","CUR","DIV","EPS","FIB","G_PRODUCT","INV","KPRODUCT","LOG2","LOGN","RANDBERNOULLI","RANDBINOM","RANDEXP","RANDNEGBINOM","RANDNORM","RANDPOISSON","ROOTN","SUMA","BINO","INVBINO","KURTP","LEGACYFDIST","SUM2XMY","VARIANCE","COMPARE","JIS","REGEXP","REGEXPRE","ROT13","SLEEK","TOGGLE"].forEach(((t,n)=>{e[t]||(e[t]=function(){throw new Error("CUBEMEMBER is not implemented")})}))}(of),of.divisor=",";let af=Object.keys(Uc);for(let e=0;e<af.length;e++)of[af[e]]=Uc[af[e]];const sf=of})(),window.formula=r.default})();