/**
 * JSS forms
 * https://jspreadsheet.com/products/forms
 * @License: this plugin requires a license
 */

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

(function(k,m){"object"===typeof exports&&"undefined"!==typeof module?module.exports=m():"function"===typeof define&&define.amd?define(m):k.forms=m()})(this,function(){var k=null,m=function(f){var d="";701<f?(d+=String.fromCharCode(64+parseInt(f/676)),d+=String.fromCharCode(64+parseInt(f%676/26))):25<f&&(d+=String.fromCharCode(64+parseInt(f/26)));return d+=String.fromCharCode(65+f%26)},q=function(f,d){var a=document.createElement("div");a.className="column f1";var c=document.createElement("div");
c.className="form-group";var g=document.createElement("div");g.innerHTML=d.title||m(f);var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("name","data["+f+"]");b.classList.add("jss_object");c.appendChild(g);c.appendChild(b);a.appendChild(c);if("dropdown"===d.type){b.setAttribute("type","hidden");var e=document.createElement("div");c.appendChild(e);jSuites.dropdown(e,{data:d.source||[],multiple:d.multiple?!0:!1,autocomplete:d.autocomplete?!0:!1,onchange:function(l,h,
r,p){b.value=p}})}else"calendar"===d.type?(b.setAttribute("type","hidden"),e=document.createElement("input"),e.setAttribute("type","text"),c.appendChild(e),jSuites.calendar(e,{time:d.timepicker,format:d.format||"",today:!1,onchange:function(l,h){b.value=h}})):"rating"===d.type?(b.setAttribute("type","hidden"),e=document.createElement("div"),c.appendChild(e),jSuites.rating(e,{onchange:function(l,h){b.value=h}}),b.style.padding="4px"):"progressbar"===d.type?(b.setAttribute("type","hidden"),e=document.createElement("div"),
c.appendChild(e),jSuites.progressbar(e,{onchange:function(l,h){b.value=h}})):"image"===d.type?(b.setAttribute("type","hidden"),e=document.createElement("div"),c.appendChild(e),jSuites.image(e,{input:!0,onchange:function(l,h){b.value=l.src}})):"color"===d.type?(b.setAttribute("type","hidden"),e=document.createElement("input"),e.setAttribute("type","text"),c.appendChild(e),jSuites.color(e,{onchange:function(l,h){b.value=h;e.style.color=h}})):"autonumber"===d.type?(b.setAttribute("type","text"),b.setAttribute("disabled",
"disabled")):"percent"===d.type?(b.setAttribute("min","0"),b.setAttribute("max","100"),"progressbar"===d.type?b.setAttribute("type","range"):b.setAttribute("data-mask","% 00")):"checkbox"===d.type?(b.setAttribute("type","checkbox"),b.style.margin="10px"):"radio"===d.type?(b.setAttribute("type","radio"),b.style.margin="10px"):"number"===d.type?(b.setAttribute("type","number"),d.mask&&b.setAttribute("data-mask",d.mask)):"hidden"===d.type?(b.setAttribute("type","hidden"),a.style.display="none"):(b.setAttribute("type",
"text"),d.mask&&b.setAttribute("data-mask",d.mask));return a},n=function(f,d){if(f.forms)return d&&f.forms.setConfig(d),f.forms.update();var a={options:{},setConfig:function(c){var g={url:window.location.href,logo:null,instructions:jSuites.translate("Please fill the form below"),completeMessage:jSuites.translate("Thank you for your time"),remote:!1,columns:[],onbeforesave:null,onsave:null},b;for(b in g)c&&d.hasOwnProperty(b)?a.options[b]=c[b]:a.options[b]=g[b]},init:function(){var c=document.createElement("div");
c.className="row middle";a.logo=document.createElement("div");a.logo.className="column p10";c.appendChild(a.logo);a.instructions=document.createElement("div");a.instructions.className="column p10 f1";c.appendChild(a.instructions);f.appendChild(c);f.container=document.createElement("div");f.appendChild(f.container);a.submit=document.createElement("input");a.submit.type="button";a.submit.value="Save";a.submit.classList.add("jbutton");a.submit.classList.add("dark");a.submit.onclick=function(){f.container.form.save()};
c=document.createElement("div");c.className="row";var g=document.createElement("div");g.className="column p4";g.appendChild(a.submit);c.appendChild(g);f.appendChild(document.createElement("br"));f.appendChild(c);c=document.createElement("div");f.appendChild(c);if(a.options.url)var b=a.options.url;jSuites.form(f.container,{url:b,onsave:function(e,l,h){if(h.error)a.instructions.innerHTML=h.message;else if(jSuites.animation.fadeOut(e,function(){e.form.reset();a.reset();a.instructions.innerHTML=a.options.completeMessage;
e.style.display=""}),"function"==typeof a.options.onsave)a.options.onsave(e,l,h)},onbeforesave:a.options.onbeforesave});a.update()},reset:function(){a.logo.innerHTML="";a.instructions.innerHTML="";f.container.innerHTML="";a.submit.style.display="none"},load:function(){jSuites.ajax({url:a.options.url,method:"GET",dataType:"json",success:function(c){a.setConfig(c);a.init()},error:function(c,g){console.log(c,g);alert("Ops, something went wrong.")}})},update:function(){a.reset();a.options.logo&&(a.logo.innerHTML=
'<img src="'+a.options.logo+'" style="width:140px;">');a.submit.style.display="";a.instructions.innerHTML=a.options.instructions;for(var c=0,g=0;g<a.options.columns.length;g++){if(!(c%2)){var b=document.createElement("div");b.className="row";f.container.appendChild(b)}b.appendChild(q(g,a.options.columns[g]));"hidden"!==a.options.columns[g].type&&c++}if(c=k&&k.spreadsheet&&k.spreadsheet[0]?k.spreadsheet[0]:null){g=b=document.createElement("div");var e="";8==c.status?c.scope&&-1!=c.scope.indexOf("forms")||
(e="This plugin is not included on the scope of this license"):e="This is only available in the Premium Edition";g.innerText=e;b.setAttribute("class","row center p4 small");f.container.appendChild(b)}return a}};a.setConfig(d);a.options.remote?a.load():a.init();return f.forms=a};n.license=function(f){null===k&&(k=this)};return n});
