(function(k,e){"object"===typeof exports&&"undefined"!==typeof module?module.exports=e():"function"===typeof define&&define.amd?define(e):k.formula=e()})(this,function(){return function(){var k=function(){var g={};g.nil=Error("#NULL!");g.div0=Error("#DIV/0!");g.value=Error("#VALUE!");g.ref=Error("#REF!");g.name=Error("#NAME?");g.num=Error("#NUM!");g.na=Error("#N/A");g.error=Error("#ERROR!");g.data=Error("#GETTING_DATA");return g}(),e=function(){var g={flattenShallow:function(a){return a&&a.reduce?
a.reduce(function(b,d){var f=Array.isArray(b),h=Array.isArray(d);return f&&h?b.concat(d):f?(b.push(d),b):h?[b].concat(d):[b,d]}):a},isFlat:function(a){if(!a)return!1;for(var b=0;b<a.length;++b)if(Array.isArray(a[b]))return!1;return!0},flatten:function(){for(var a=g.argsToArray.apply(null,arguments);!g.isFlat(a);)a=g.flattenShallow(a);return a},argsToArray:function(a){var b=[];g.arrayEach(a,function(d){b.push(d)});return b},numbers:function(){return this.flatten.apply(null,arguments).filter(function(a){return"number"===
typeof a})},cleanFloat:function(a){return Math.round(1E14*a)/1E14},parseBool:function(a){if("boolean"===typeof a||a instanceof Error)return a;if("number"===typeof a)return 0!==a;if("string"===typeof a){var b=a.toUpperCase();if("TRUE"===b)return!0;if("FALSE"===b)return!1}return a instanceof Date&&!isNaN(a)?!0:k.value},parseNumber:function(a){return void 0===a||""===a?k.value:isNaN(a)?k.value:parseFloat(a)},parseNumberArray:function(a){var b;if(!a||0===(b=a.length))return k.value;for(var d;b--;){d=
g.parseNumber(a[b]);if(d===k.value)return d;a[b]=d}return a},parseMatrix:function(a){if(!a||0===a.length)return k.value;for(var b,d=0;d<a.length;d++)if(b=g.parseNumberArray(a[d]),a[d]=b,b instanceof Error)return b;return a}},c=new Date(Date.UTC(1900,0,1));g.parseDate=function(a){if(!isNaN(a)){if(a instanceof Date)return new Date(a);a=parseInt(a,10);return 0>a?k.num:60>=a?new Date(c.getTime()+864E5*(a-1)):new Date(c.getTime()+864E5*(a-2))}return"string"!==typeof a||(a=new Date(a),isNaN(a))?k.value:
a};g.parseDateArray=function(a){for(var b=a.length,d;b--;){d=this.parseDate(a[b]);if(d===k.value)return d;a[b]=d}return a};g.anyIsError=function(){for(var a=arguments.length;a--;)if(arguments[a]instanceof Error)return!0;return!1};g.arrayValuesToNumbers=function(a){for(var b=a.length,d;b--;)d=a[b],"number"!==typeof d&&(!0===d?a[b]=1:!1===d?a[b]=0:"string"===typeof d&&(d=this.parseNumber(d),a[b]=d instanceof Error?0:d));return a};g.rest=function(a,b){return a&&"function"===typeof a.slice?a.slice(b||
1):a};g.initial=function(a,b){return a&&"function"===typeof a.slice?a.slice(0,a.length-(b||1)):a};g.arrayEach=function(a,b){for(var d=-1,f=a.length;++d<f&&!1!==b(a[d],d,a););return a};g.transpose=function(a){return a?a[0].map(function(b,d){return a.map(function(f){return f[d]})}):k.value};return g}(),x={};x.datetime=function(){function g(d){return(d-a)/864E5+(-22038912E5<d?2:1)}var c={},a=new Date(1900,0,1),b=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],
[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];c.DATE=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:new Date(d,f-1,h)};c.DATEVALUE=function(d){if("string"!==typeof d)return k.value;d=Date.parse(d);return isNaN(d)?k.value:-22038912E5>=d?(d-a)/864E5+1:(d-a)/864E5+2};c.DAY=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getDate()};c.DAYS=function(d,f){d=e.parseDate(d);
f=e.parseDate(f);return d instanceof Error?d:f instanceof Error?f:g(d)-g(f)};c.DAYS360=function(d,f,h){};c.EDATE=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);d.setMonth(d.getMonth()+f);return g(d)};c.EOMONTH=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);return g(new Date(d.getFullYear(),d.getMonth()+f+1,0))};c.HOUR=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getHours()};
c.INTERVAL=function(d){if("number"!==typeof d&&"string"!==typeof d)return k.value;d=parseInt(d,10);var f=Math.floor(d/94608E4);d%=94608E4;var h=Math.floor(d/2592E3);d%=2592E3;var l=Math.floor(d/86400);d%=86400;var m=Math.floor(d/3600);d%=3600;var n=Math.floor(d/60);d%=60;return"P"+(0<f?f+"Y":"")+(0<h?h+"M":"")+(0<l?l+"D":"")+"T"+(0<m?m+"H":"")+(0<n?n+"M":"")+(0<d?d+"S":"")};c.ISOWEEKNUM=function(d){d=e.parseDate(d);if(d instanceof Error)return d;d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||
7));var f=new Date(d.getFullYear(),0,1);return Math.ceil(((d-f)/864E5+1)/7)};c.MINUTE=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMinutes()};c.MONTH=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMonth()+1};c.NETWORKDAYS=function(d,f,h){};c.NETWORKDAYS.INTL=function(d,f,h,l){};c.NOW=function(){return new Date};c.SECOND=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getSeconds()};c.TIME=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);
return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:(3600*d+60*f+h)/86400};c.TIMEVALUE=function(d){d=e.parseDate(d);return d instanceof Error?d:(3600*d.getHours()+60*d.getMinutes()+d.getSeconds())/86400};c.TODAY=function(){return new Date};c.WEEKDAY=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;void 0===f&&(f=1);var h=d.getDay();return b[f][h]};c.WEEKNUM=function(d,f){};c.WORKDAY=function(d,f,h){};c.WORKDAY.INTL=function(d,f,h,l){};c.YEAR=function(d){d=e.parseDate(d);return d instanceof
Error?d:d.getFullYear()};c.YEARFRAC=function(d,f,h){};return c}();x.database=function(){function g(a,b){for(var d={},f=1;f<a[0].length;++f)d[f]=!0;var h=b[0].length;for(f=1;f<b.length;++f)b[f].length>h&&(h=b[f].length);for(f=1;f<a.length;++f)for(var l=1;l<a[f].length;++l){for(var m=!1,n=!1,p=0;p<b.length;++p){var q=b[p];if(!(q.length<h)&&a[f][0]===q[0]){n=!0;for(var t=1;t<q.length;++t)m=m||eval(a[f][l]+q[t])}}n&&(d[l]=d[l]&&m)}h=[];for(f=0;f<a[0].length;++f)d[f]&&h.push(f-1);return h}var c={FINDFIELD:function(a,
b){for(var d=null,f=0;f<a.length;f++)if(a[f][0]===b){d=f;break}return null==d?k.value:d},DAVERAGE:function(a,b,d){if(isNaN(b)&&"string"!==typeof b)return k.value;d=g(a,d);"string"===typeof b?(b=c.FINDFIELD(a,b),a=e.rest(a[b])):a=e.rest(a[b]);for(var f=b=0;f<d.length;f++)b+=a[d[f]];return 0===d.length?k.div0:b/d.length},DCOUNT:function(a,b,d){},DCOUNTA:function(a,b,d){},DGET:function(a,b,d){if(isNaN(b)&&"string"!==typeof b)return k.value;d=g(a,d);"string"===typeof b?(b=c.FINDFIELD(a,b),a=e.rest(a[b])):
a=e.rest(a[b]);return 0===d.length?k.value:1<d.length?k.num:a[d[0]]},DMAX:function(a,b,d){if(isNaN(b)&&"string"!==typeof b)return k.value;d=g(a,d);"string"===typeof b?(b=c.FINDFIELD(a,b),a=e.rest(a[b])):a=e.rest(a[b]);b=a[d[0]];for(var f=1;f<d.length;f++)b<a[d[f]]&&(b=a[d[f]]);return b},DMIN:function(a,b,d){if(isNaN(b)&&"string"!==typeof b)return k.value;d=g(a,d);"string"===typeof b?(b=c.FINDFIELD(a,b),a=e.rest(a[b])):a=e.rest(a[b]);b=a[d[0]];for(var f=1;f<d.length;f++)b>a[d[f]]&&(b=a[d[f]]);return b},
DPRODUCT:function(a,b,d){if(isNaN(b)&&"string"!==typeof b)return k.value;d=g(a,d);if("string"===typeof b){b=c.FINDFIELD(a,b);var f=e.rest(a[b])}else f=e.rest(a[b]);a=[];for(b=0;b<d.length;b++)a[b]=f[d[b]];if(d=a)for(a=[],b=0;b<d.length;++b)d[b]&&a.push(d[b]);else a=d;d=1;for(b=0;b<a.length;b++)d*=a[b];return d},DSTDEV:function(a,b,d){},DSTDEVP:function(a,b,d){},DSUM:function(a,b,d){},DVAR:function(a,b,d){},DVARP:function(a,b,d){},MATCH:function(a,b,d){if(!a&&!b)return k.na;2===arguments.length&&(d=
1);if(!(b instanceof Array)||-1!==d&&0!==d&&1!==d)return k.na;for(var f,h,l=0;l<b.length;l++)if(1===d){if(b[l]===a)return l+1;b[l]<a&&(h?b[l]>h&&(f=l+1,h=b[l]):(f=l+1,h=b[l]))}else if(0===d)if("string"===typeof a){if(a=a.replace(/\?/g,"."),b[l].toLowerCase().match(a.toLowerCase()))return l+1}else{if(b[l]===a)return l+1}else if(-1===d){if(b[l]===a)return l+1;b[l]>a&&(h?b[l]<h&&(f=l+1,h=b[l]):(f=l+1,h=b[l]))}return f?f:k.na}};return c}();x.engineering=function(){var g={BESSELI:function(c,a){},BESSELJ:function(c,
a){},BESSELK:function(c,a){},BESSELY:function(c,a){},BIN2DEC:function(c){if(!/^[01]{1,10}$/.test(c))return k.num;var a=parseInt(c,2);c=c.toString();return 10===c.length&&"1"===c.substring(0,1)?parseInt(c.substring(1),2)-512:a},BIN2HEX:function(c,a){if(!/^[01]{1,10}$/.test(c))return k.num;var b=c.toString();if(10===b.length&&"1"===b.substring(0,1))return(0xfffffffe00+parseInt(b.substring(1),2)).toString(16);b=parseInt(c,2).toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;
a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BIN2OCT:function(c,a){if(!/^[01]{1,10}$/.test(c))return k.num;var b=c.toString();if(10===b.length&&"1"===b.substring(0,1))return(1073741312+parseInt(b.substring(1),2)).toString(8);b=parseInt(c,2).toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BITAND:function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:0>
c||0>a||Math.floor(c)!==c||Math.floor(a)!==a||0xffffffffffff<c||0xffffffffffff<a?k.num:c&a},BITLSHIFT:function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:0>c||Math.floor(c)!==c||0xffffffffffff<c||53<Math.abs(a)?k.num:0<=a?c<<a:c>>-a},BITOR:function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:0>c||0>a||Math.floor(c)!==c||Math.floor(a)!==a||0xffffffffffff<c||0xffffffffffff<a?k.num:c|a},BITRSHIFT:function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);
return e.anyIsError(c,a)?k.value:0>c||Math.floor(c)!==c||0xffffffffffff<c||53<Math.abs(a)?k.num:0<=a?c>>a:c<<-a},BITXOR:function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:0>c||0>a||Math.floor(c)!==c||Math.floor(a)!==a||0xffffffffffff<c||0xffffffffffff<a?k.num:c^a},COMPLEX:function(c,a,b){c=e.parseNumber(c);a=e.parseNumber(a);if(e.anyIsError(c,a))return c;b=void 0===b?"i":b;return"i"!==b&&"j"!==b?k.value:0===c&&0===a?0:0===c?1===a?b:a.toString()+b:0===a?c.toString():
c.toString()+(0<a?"+":"")+(1===a?b:a.toString()+b)},CONVERT:function(c,a,b){c=e.parseNumber(c);if(c instanceof Error)return c;for(var d=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,
!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],
"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",
!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree",
"\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],
["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,
745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],
["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],
["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",
!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile",
"M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],
["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,
!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],
["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon",
"tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,
1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,
"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},h={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],
a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},l=null,m=null,n=a,p=b,q=1,t=1,u,r=0;r<d.length;r++){u=null===d[r][2]?[]:d[r][2];if(d[r][1]===n||0<=u.indexOf(n))l=d[r];if(d[r][1]===p||0<=u.indexOf(p))m=d[r]}if(null===l)for(u=f[a.substring(0,2)],r=h[a.substring(0,1)],"da"===a.substring(0,2)&&(r=["dekao",10,"da"]),u?(q=u[2],n=a.substring(2)):r&&(q=r[1],n=a.substring(r[2].length)),a=0;a<d.length;a++)if(u=null===d[a][2]?[]:d[a][2],d[a][1]===n||0<=u.indexOf(n))l=d[a];if(null===m)for(f=
f[b.substring(0,2)],h=h[b.substring(0,1)],"da"===b.substring(0,2)&&(h=["dekao",10,"da"]),f?(t=f[2],p=b.substring(2)):h&&(t=h[1],p=b.substring(h[2].length)),b=0;b<d.length;b++)if(u=null===d[b][2]?[]:d[b][2],d[b][1]===p||0<=u.indexOf(p))m=d[b];return null===l||null===m||l[3]!==m[3]?k.na:c*l[6]*q/(m[6]*t)},DEC2BIN:function(c,a){c=e.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,3}$/.test(c)||-512>c||511<c)return k.num;if(0>c)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);
var b=parseInt(c,10).toString(2);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DEC2HEX:function(c,a){c=e.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,12}$/.test(c)||-549755813888>c||549755813887<c)return k.num;if(0>c)return(1099511627776+c).toString(16);var b=parseInt(c,10).toString(16);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);
return a>=b.length?REPT("0",a-b.length)+b:k.num},DEC2OCT:function(c,a){c=e.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,9}$/.test(c)||-536870912>c||536870911<c)return k.num;if(0>c)return(1073741824+c).toString(8);var b=parseInt(c,10).toString(8);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DELTA:function(c,a){a=void 0===a?0:a;c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,
a)?k.value:c===a?1:0},ERF:function(c,a){}};g.ERF.PRECISE=function(){};g.ERFC=function(c){};g.ERFC.PRECISE=function(){};g.GESTEP=function(c,a){a=a||0;c=e.parseNumber(c);return e.anyIsError(a,c)?c:c>=a?1:0};g.HEX2BIN=function(c,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return k.num;var b=10===c.length&&"f"===c.substring(0,1).toLowerCase()?!0:!1,d=b?parseInt(c,16)-1099511627776:parseInt(c,16);if(-512>d||511<d)return k.num;if(b)return"1"+REPT("0",9-(512+d).toString(2).length)+(512+d).toString(2);b=d.toString(2);
if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};g.HEX2DEC=function(c){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return k.num;c=parseInt(c,16);return 549755813888<=c?c-1099511627776:c};g.HEX2OCT=function(c,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return k.num;var b=parseInt(c,16);if(536870911<b&&0xffe0000000>b)return k.num;if(0xffe0000000<=b)return(b-0xffc0000000).toString(8);b=b.toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;
if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};g.IMABS=function(c){var a=g.IMREAL(c);c=g.IMAGINARY(c);return e.anyIsError(a,c)?k.value:Math.sqrt(Math.pow(a,2)+Math.pow(c,2))};g.IMAGINARY=function(c){if(void 0===c||!0===c||!1===c)return k.value;if(0===c||"0"===c)return 0;if(0<=["i","j"].indexOf(c))return 1;c=c.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var a=c.indexOf("+"),b=c.indexOf("-");0===a&&(a=c.indexOf("+",1));0===b&&
(b=c.indexOf("-",1));var d=c.substring(c.length-1,c.length);d="i"===d||"j"===d;return 0<=a||0<=b?d?0<=a?isNaN(c.substring(0,a))||isNaN(c.substring(a+1,c.length-1))?k.num:Number(c.substring(a+1,c.length-1)):isNaN(c.substring(0,b))||isNaN(c.substring(b+1,c.length-1))?k.num:-Number(c.substring(b+1,c.length-1)):k.num:d?isNaN(c.substring(0,c.length-1))?k.num:c.substring(0,c.length-1):isNaN(c)?k.num:0};g.IMARGUMENT=function(c){var a=g.IMREAL(c);c=g.IMAGINARY(c);return e.anyIsError(a,c)?k.value:0===a&&0===
c?k.div0:0===a&&0<c?Math.PI/2:0===a&&0>c?-Math.PI/2:0===c&&0<a?0:0===c&&0>a?-Math.PI:0<a?Math.atan(c/a):0>a&&0<=c?Math.atan(c/a)+Math.PI:Math.atan(c/a)-Math.PI};g.IMCONJUGATE=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;var d=c.substring(c.length-1);return 0!==b?g.COMPLEX(a,-b,"i"===d||"j"===d?d:"i"):c};g.IMCOS=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.cos(a)*(Math.exp(b)+
Math.exp(-b))/2,-Math.sin(a)*(Math.exp(b)-Math.exp(-b))/2,"i"===c||"j"===c?c:"i")};g.IMCOSH=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.cos(b)*(Math.exp(a)+Math.exp(-a))/2,Math.sin(b)*(Math.exp(a)-Math.exp(-a))/2,"i"===c||"j"===c?c:"i")};g.IMCOT=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,b)?k.value:g.IMDIV(g.IMCOS(c),g.IMSIN(c))};g.IMDIV=function(c,a){var b=g.IMREAL(c),d=g.IMAGINARY(c),
f=g.IMREAL(a),h=g.IMAGINARY(a);if(e.anyIsError(b,d,f,h))return k.value;var l=c.substring(c.length-1),m=a.substring(a.length-1),n="i";"j"===l?n="j":"j"===m&&(n="j");if(0===f&&0===h)return k.num;l=f*f+h*h;return g.COMPLEX((b*f+d*h)/l,(d*f-b*h)/l,n)};g.IMEXP=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);a=Math.exp(a);return g.COMPLEX(a*Math.cos(b),a*Math.sin(b),"i"===c||"j"===c?c:"i")};g.IMLN=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);
if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+b*b)),Math.atan(b/a),"i"===c||"j"===c?c:"i")};g.IMLOG10=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+b*b))/Math.log(10),Math.atan(b/a)/Math.log(10),"i"===c||"j"===c?c:"i")};g.IMLOG2=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*
a+b*b))/Math.log(2),Math.atan(b/a)/Math.log(2),"i"===c||"j"===c?c:"i")};g.IMPOWER=function(c,a){a=e.parseNumber(a);var b=g.IMREAL(c),d=g.IMAGINARY(c);if(e.anyIsError(a,b,d))return k.value;b=c.substring(c.length-1);b="i"===b||"j"===b?b:"i";d=Math.pow(g.IMABS(c),a);var f=g.IMARGUMENT(c);return g.COMPLEX(d*Math.cos(a*f),d*Math.sin(a*f),b)};g.IMPRODUCT=function(){for(var c=arguments[0],a=1;a<arguments.length;a++){var b=g.IMREAL(c);c=g.IMAGINARY(c);var d=g.IMREAL(arguments[a]),f=g.IMAGINARY(arguments[a]);
if(e.anyIsError(b,c,d,f))return k.value;c=g.COMPLEX(b*d-c*f,b*f+c*d)}return c};g.IMREAL=function(c){if(void 0===c||!0===c||!1===c)return k.value;if(0===c||"0"===c||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(c))return 0;var a=c.indexOf("+"),b=c.indexOf("-");0===a&&(a=c.indexOf("+",1));0===b&&(b=c.indexOf("-",1));var d=c.substring(c.length-1,c.length);d="i"===d||"j"===d;return 0<=a||0<=b?d?0<=a?isNaN(c.substring(0,a))||isNaN(c.substring(a+1,c.length-1))?k.num:Number(c.substring(0,
a)):isNaN(c.substring(0,b))||isNaN(c.substring(b+1,c.length-1))?k.num:Number(c.substring(0,b)):k.num:d?isNaN(c.substring(0,c.length-1))?k.num:0:isNaN(c)?k.num:c};g.IMSEC=function(c){if(!0===c||!1===c)return k.value;var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,b)?k.value:g.IMDIV("1",g.IMCOS(c))};g.IMSECH=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,b)?k.value:g.IMDIV("1",g.IMCOSH(c))};g.IMSIN=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;
c=c.substring(c.length-1);return g.COMPLEX(Math.sin(a)*(Math.exp(b)+Math.exp(-b))/2,Math.cos(a)*(Math.exp(b)-Math.exp(-b))/2,"i"===c||"j"===c?c:"i")};g.IMSINH=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;c=c.substring(c.length-1);return g.COMPLEX(Math.cos(b)*(Math.exp(a)-Math.exp(-a))/2,Math.sin(b)*(Math.exp(a)+Math.exp(-a))/2,"i"===c||"j"===c?c:"i")};g.IMSQRT=function(c){var a=g.IMREAL(c),b=g.IMAGINARY(c);if(e.anyIsError(a,b))return k.value;a=c.substring(c.length-
1);a="i"===a||"j"===a?a:"i";b=Math.sqrt(g.IMABS(c));c=g.IMARGUMENT(c);return g.COMPLEX(b*Math.cos(c/2),b*Math.sin(c/2),a)};g.IMCSC=function(c){if(!0===c||!1===c)return k.value;var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,b)?k.num:g.IMDIV("1",g.IMSIN(c))};g.IMCSCH=function(c){if(!0===c||!1===c)return k.value;var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,b)?k.num:g.IMDIV("1",g.IMSINH(c))};g.IMSUB=function(c,a){var b=this.IMREAL(c),d=this.IMAGINARY(c),f=this.IMREAL(a),h=this.IMAGINARY(a);
if(e.anyIsError(b,d,f,h))return k.value;var l=c.substring(c.length-1),m=a.substring(a.length-1),n="i";"j"===l?n="j":"j"===m&&(n="j");return this.COMPLEX(b-f,d-h,n)};g.IMSUM=function(){for(var c=e.flatten(arguments),a=c[0],b=1;b<c.length;b++){var d=this.IMREAL(a);a=this.IMAGINARY(a);var f=this.IMREAL(c[b]),h=this.IMAGINARY(c[b]);if(e.anyIsError(d,a,f,h))return k.value;a=this.COMPLEX(d+f,a+h)}return a};g.IMTAN=function(c){if(!0===c||!1===c)return k.value;var a=g.IMREAL(c),b=g.IMAGINARY(c);return e.anyIsError(a,
b)?k.value:this.IMDIV(this.IMSIN(c),this.IMCOS(c))};g.OCT2BIN=function(c,a){if(!/^[0-7]{1,10}$/.test(c))return k.num;var b=10===c.length&&"7"===c.substring(0,1)?!0:!1,d=b?parseInt(c,8)-1073741824:parseInt(c,8);if(-512>d||511<d)return k.num;if(b)return"1"+REPT("0",9-(512+d).toString(2).length)+(512+d).toString(2);b=d.toString(2);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};g.OCT2DEC=function(c){if(!/^[0-7]{1,10}$/.test(c))return k.num;
c=parseInt(c,8);return 536870912<=c?c-1073741824:c};g.OCT2HEX=function(c,a){if(!/^[0-7]{1,10}$/.test(c))return k.num;var b=parseInt(c,8);if(536870912<=b)return"ff"+(b+3221225472).toString(16);b=b.toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};return g}();x.financial=function(){function g(b){return b&&b.getTime&&!isNaN(b.getTime())}function c(b){return b instanceof Date?b:new Date(b)}var a={ACCRINT:function(b,
d,f,h,l,m,n){b=c(b);d=c(d);f=c(f);return g(b)&&g(d)&&g(f)?0>=h||0>=l||-1===[1,2,4].indexOf(m)||-1===[0,1,2,3,4].indexOf(n)||f<=b?"#NUM!":(l||0)*h*YEARFRAC(b,f,n||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(b,d,f,h,l,m){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(b,d,f))return k.value;if(0>=b||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(b,d,
f,0,m);var n=0;1===h&&0===m&&(n=-f,h++);for(;h<=l;h++)n=1===m?n+(a.FV(b,h-2,d,f,1)-d):n+a.FV(b,h-1,d,f,0);return n*b},CUMPRINC:function(b,d,f,h,l,m){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(b,d,f))return k.value;if(0>=b||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(b,d,f,0,m);var n=0;1===h&&(n=0===m?d+f*b:d,h++);for(;h<=l;h++)n=0<m?n+(d-(a.FV(b,h-2,d,f,1)-d)*b):n+(d-a.FV(b,h-1,d,f,0)*b);return n},DB:function(b,d,f,h,l){l=void 0===l?12:l;b=e.parseNumber(b);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(b,d,f,h,l))return k.value;if(0>b||0>d||0>f||0>h||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(l)||h>f)return k.num;if(d>=b)return 0;d=(1-Math.pow(d/b,1/f)).toFixed(3);for(var m=l=b*d*l/12,n=0,p=h===f?f-1:h,q=2;q<=p;q++)n=(b-m)*d,m+=n;return 1===h?l:h===f?(b-m)*d:n},DDB:function(b,d,f,h,l){l=void 0===l?2:l;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(b,
d,f,h,l))return k.value;if(0>b||0>d||0>f||0>h||0>=l||h>f)return k.num;if(d>=b)return 0;for(var m=0,n=0,p=1;p<=h;p++)n=Math.min(l/f*(b-m),b-d-m),m+=n;return n},DISC:null,DOLLARDE:function(b,d){b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(b,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(b,10);f+=b%1*Math.pow(10,Math.ceil(Math.log(d)/Math.LN10))/d;var h=Math.pow(10,Math.ceil(Math.log(d)/Math.LN2)+1);return f=Math.round(f*h)/h},DOLLARFR:function(b,
d){b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(b,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(b,10);return f+=b%1*Math.pow(10,-Math.ceil(Math.log(d)/Math.LN10))*d},DURATION:null,EFFECT:function(b,d){b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(b,d))return k.value;if(0>=b||1>d)return k.num;d=parseInt(d,10);return Math.pow(1+b/d,d)-1},FV:function(b,d,f,h,l){h=h||0;l=l||0;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=
e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(b,d,f,h,l))return k.value;0===b?b=h+f*d:(d=Math.pow(1+b,d),b=1===l?h*d+f*(1+b)*(d-1)/b:h*d+f*(d-1)/b);return-b},FVSCHEDULE:function(b,d){b=e.parseNumber(b);d=e.parseNumberArray(e.flatten(d));if(e.anyIsError(b,d))return k.value;for(var f=d.length,h=b,l=0;l<f;l++)h*=1+d[l];return h},INTRATE:null,IPMT:function(b,d,f,h,l,m){l=l||0;m=m||0;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);
if(e.anyIsError(b,d,f,h,l,m))return k.value;f=a.PMT(b,f,h,l,m);return(1===d?1===m?0:-h:1===m?a.FV(b,d-2,f,h,1)-f:a.FV(b,d-1,f,h,0))*b},IRR:function(b,d){d=d||0;b=e.parseNumberArray(e.flatten(b));d=e.parseNumber(d);if(e.anyIsError(b,d))return k.value;for(var f=function(t,u,r){r+=1;for(var v=t[0],z=1;z<t.length;z++)v+=t[z]/Math.pow(r,(u[z]-u[0])/365);return v},h=function(t,u,r){r+=1;for(var v=0,z=1;z<t.length;z++){var H=(u[z]-u[0])/365;v-=H*t[z]/Math.pow(r,H+1)}return v},l=[],m=!1,n=!1,p=0;p<b.length;p++)l[p]=
0===p?0:l[p-1]+365,0<b[p]&&(m=!0),0>b[p]&&(n=!0);if(!m||!n)return k.num;m=void 0===d?.1:d;n=!0;do{var q=f(b,l,m);n=m-q/h(b,l,m);p=Math.abs(n-m);m=n;n=1E-10<p&&1E-10<Math.abs(q)}while(n);return m},ISPMT:function(b,d,f,h){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(b,d,f,h)?k.value:h*b*(d/f-1)},MDURATION:null,MIRR:function(b,d,f){b=e.parseNumberArray(e.flatten(b));d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(b,d,f))return k.value;for(var h=
b.length,l=[],m=[],n=0;n<h;n++)0>b[n]?l.push(b[n]):m.push(b[n]);b=-a.NPV(f,m)*Math.pow(1+f,h-1);d=a.NPV(d,l)*(1+d);return Math.pow(b/d,1/(h-1))-1},NOMINAL:function(b,d){b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(b,d))return k.value;if(0>=b||1>d)return k.num;d=parseInt(d,10);return(Math.pow(b+1,1/d)-1)*d},NPER:function(b,d,f,h,l){l=void 0===l?0:l;h=void 0===h?0:h;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(b,d,f,h,l)?
k.value:Math.log((d*(1+b*l)-h*b)/(f*b+d*(1+b*l)))/Math.log(1+b)},NPV:function(){var b=e.parseNumberArray(e.flatten(arguments));if(b instanceof Error)return b;for(var d=b[0],f=0,h=1;h<b.length;h++)f+=b[h]/Math.pow(1+d,h);return f},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(b,d,f){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0>=b?k.num:(Math.log(f)-Math.log(d))/Math.log(1+b)},PMT:function(b,d,f,h,l){h=h||0;l=l||0;b=e.parseNumber(b);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(b,d,f,h,l))return k.value;0===b?b=(f+h)/d:(d=Math.pow(1+b,d),b=1===l?(h*b/(d-1)+f*b/(1-1/d))/(1+b):h*b/(d-1)+f*b/(1-1/d));return-b},PPMT:function(b,d,f,h,l,m){l=l||0;m=m||0;b=e.parseNumber(b);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);return e.anyIsError(b,f,h,l,m)?k.value:a.PMT(b,f,h,l,m)-a.IPMT(b,d,f,h,l,m)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(b,d,f,h,l){h=
h||0;l=l||0;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(b,d,f,h,l)?k.value:0===b?-f*d-h:((1-Math.pow(1+b,d))/b*f*(1+b*l)-h)/Math.pow(1+b,d)},RATE:function(b,d,f,h,l,m){m=void 0===m?.01:m;h=void 0===h?0:h;l=void 0===l?0:l;b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);if(e.anyIsError(b,d,f,h,l,m))return k.value;for(var n=0,p=!1;100>n&&!p;){var q=Math.pow(m+1,b),
t=Math.pow(m+1,b-1);q=m-(h+q*f+d*(q-1)*(m*l+1)/m)/(b*t*f-d*(q-1)*(m*l+1)/Math.pow(m,2)+(b*d*t*(m*l+1)/m+d*(q-1)*l/m));1E-6>Math.abs(q-m)&&(p=!0);n++;m=q}return p?m:Number.NaN+m},RECEIVED:null,RRI:function(b,d,f){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0===b||0===d?k.num:Math.pow(f/d,1/b)-1},SLN:function(b,d,f){b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0===f?k.num:(b-d)/f},SYD:function(b,d,f,h){b=
e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);if(e.anyIsError(b,d,f,h))return k.value;if(0===f||1>h||h>f)return k.num;h=parseInt(h,10);return(b-d)*(f-h+1)*2/(f*(f+1))},TBILLEQ:function(b,d,f){b=e.parseDate(b);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0>=f||b>d||31536E6<d-b?k.num:365*f/(360-f*DAYS360(b,d,!1))},TBILLPRICE:function(b,d,f){b=e.parseDate(b);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0>=f||b>d||31536E6<
d-b?k.num:100*(1-f*DAYS360(b,d,!1)/360)},TBILLYIELD:function(b,d,f){b=e.parseDate(b);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(b,d,f)?k.value:0>=f||b>d||31536E6<d-b?k.num:360*(100-f)/(f*DAYS360(b,d,!1))},VDB:null,XIRR:function(b,d,f){b=e.parseNumberArray(e.flatten(b));d=e.parseDateArray(e.flatten(d));f=e.parseNumber(f);if(e.anyIsError(b,d,f))return k.value;for(var h=function(q,t,u){u+=1;for(var r=q[0],v=1;v<q.length;v++)r+=q[v]/Math.pow(u,DAYS(t[v],t[0])/365);return r},l=function(q,
t,u){u+=1;for(var r=0,v=1;v<q.length;v++){var z=DAYS(t[v],t[0])/365;r-=z*q[v]/Math.pow(u,z+1)}return r},m=!1,n=!1,p=0;p<b.length;p++)0<b[p]&&(m=!0),0>b[p]&&(n=!0);if(!m||!n)return k.num;f=f||.1;m=!0;do p=h(b,d,f),m=f-p/l(b,d,f),n=Math.abs(m-f),f=m,m=1E-10<n&&1E-10<Math.abs(p);while(m);return f},XNPV:function(b,d,f){b=e.parseNumber(b);d=e.parseNumberArray(e.flatten(d));f=e.parseDateArray(e.flatten(f));if(e.anyIsError(b,d,f))return k.value;for(var h=0,l=0;l<d.length;l++)h+=d[l]/Math.pow(1+b,DAYS(f[l],
f[0])/365);return h},YIELD:null,YIELDDISC:null,YIELDMAT:null};return a}();x.information=function(){var g={CELL:null,ERROR:{}};g.ERROR.TYPE=function(c){switch(c){case k.nil:return 1;case k.div0:return 2;case k.value:return 3;case k.ref:return 4;case k.name:return 5;case k.num:return 6;case k.na:return 7;case k.data:return 8}return k.na};g.INFO=null;g.ISBLANK=function(c){return null===c};g.ISBINARY=function(c){return/^[01]{1,10}$/.test(c)};g.ISERR=function(c){return 0<=[k.value,k.ref,k.div0,k.num,k.name,
k.nil].indexOf(c)||"number"===typeof c&&(isNaN(c)||!isFinite(c))};g.ISERROR=function(c){return g.ISERR(c)||c===k.na};g.ISEVEN=function(c){return Math.floor(Math.abs(c))&1?!1:!0};g.ISFORMULA=null;g.ISLOGICAL=function(c){return!0===c||!1===c};g.ISNA=function(c){return c===k.na};g.ISNONTEXT=function(c){return"string"!==typeof c};g.ISNUMBER=function(c){return"number"===typeof c&&!isNaN(c)&&isFinite(c)};g.ISODD=function(c){return Math.floor(Math.abs(c))&1?!0:!1};g.ISREF=null;g.ISTEXT=function(c){return"string"===
typeof c};g.N=function(c){return this.ISNUMBER(c)?c:c instanceof Date?c.getTime():!0===c?1:!1===c?0:this.ISERROR(c)?c:0};g.NA=function(){return k.na};g.SHEET=null;g.SHEETS=null;g.TYPE=function(c){if(this.ISNUMBER(c))return 1;if(this.ISTEXT(c))return 2;if(this.ISLOGICAL(c))return 4;if(this.ISERROR(c))return 16;if(Array.isArray(c))return 64};return g}();x.logical=function(){return{AND:function(){for(var g=e.flatten(arguments),c=!0,a=0;a<g.length;a++)g[a]||(c=!1);return c},CHOOSE:function(){if(2>arguments.length)return k.na;
var g=arguments[0];return 1>g||254<g||arguments.length<g+1?k.value:arguments[g]},FALSE:function(){return!1},IF:function(g,c,a){return g?c:a},IFERROR:function(g,c){return ISERROR(g)?c:g},IFNA:function(g,c){return g===k.na?c:g},NOT:function(g){return!g},OR:function(){for(var g=e.flatten(arguments),c=!1,a=0;a<g.length;a++)g[a]&&(c=!0);return c},TRUE:function(){return!0},XOR:function(){for(var g=e.flatten(arguments),c=0,a=0;a<g.length;a++)g[a]&&c++;return Math.floor(Math.abs(c))&1?!0:!1},SWITCH:function(){if(0<
arguments.length){var g=arguments[0],c=arguments.length-1,a=Math.floor(c/2),b=!1;c=0===c%2?null:arguments[arguments.length-1];if(a)for(var d=0;d<a;d++)if(g===arguments[2*d+1]){var f=arguments[2*d+2];b=!0;break}!b&&c&&(f=c)}return f}}}();x.math=function(){var g={ABS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.abs(e.parseNumber(a))},ACOS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.acos(a)},ACOSH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a+
Math.sqrt(a*a-1))},ACOT:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(1/a)},ACOTH:function(a){a=e.parseNumber(a);return a instanceof Error?a:.5*Math.log((a+1)/(a-1))},AGGREGATE:null,ARABIC:function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return k.value;var b=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(d){b+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[d]});return b},ASIN:function(a){a=e.parseNumber(a);
return a instanceof Error?a:Math.asin(a)},ASINH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))},ATAN:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(a)},ATAN2:function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:Math.atan2(a,b)},ATANH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log((1+a)/(1-a))/2},BASE:function(a,b,d){d=d||0;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,
b,d))return k.value;d=void 0===d?0:d;a=a.toString(b);return Array(Math.max(d+1-a.length,0)).join("0")+a},CEILING:function(a,b,d){b=void 0===b?1:b;d=void 0===d?0:d;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,b,d))return k.value;if(0===b)return 0;b=Math.abs(b);return 0<=a?Math.ceil(a/b)*b:0===d?-1*Math.floor(Math.abs(a)/b)*b:-1*Math.ceil(Math.abs(a)/b)*b}};g.CEILING.MATH=g.CEILING;g.CEILING.PRECISE=g.CEILING;g.COMBIN=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);
return e.anyIsError(a,b)?k.value:g.FACT(a)/(g.FACT(b)*g.FACT(a-b))};g.COMBINA=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:0===a&&0===b?1:g.COMBIN(a+b-1,a-1)};g.COS=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.cos(a)};g.COSH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2};g.COT=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.tan(a)};g.COTH=function(a){a=e.parseNumber(a);if(a instanceof
Error)return a;a=Math.exp(2*a);return(a+1)/(a-1)};g.CSC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.sin(a)};g.CSCH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))};g.DECIMAL=function(a,b){return 1>arguments.length?k.value:parseInt(a,b)};g.DEGREES=function(a){a=e.parseNumber(a);return a instanceof Error?a:180*a/Math.PI};g.EVEN=function(a){a=e.parseNumber(a);return a instanceof Error?a:g.CEILING(a,-2,-1)};g.EXP=Math.exp;var c=[];g.FACT=function(a){a=
e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);if(0===a||1===a)return 1;0<c[a]||(c[a]=g.FACT(a-1)*a);return c[a]};g.FACTDOUBLE=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);return 0>=a?1:a*g.FACTDOUBLE(a-2)};g.FLOOR=function(a,b,d){b=void 0===b?1:b;d=void 0===d?0:d;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,b,d))return k.value;if(0===b)return 0;b=Math.abs(b);return 0<=a?Math.floor(a/b)*b:0===d?-1*Math.ceil(Math.abs(a)/
b)*b:-1*Math.floor(Math.abs(a)/b)*b};g.FLOOR.MATH=g.FLOOR;g.GCD=null;g.INT=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.floor(a)};g.LCM=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b,d,f,h=1;void 0!==(f=a.pop());)for(;1<f;){if(f%2){b=3;for(d=Math.floor(Math.sqrt(f));b<=d&&f%b;b+=2);d=b<=d?b:f}else d=2;f/=d;h*=d;for(b=a.length;b;0===a[--b]%d&&1===(a[b]/=d)&&a.splice(b,1));}return h};g.LN=function(a){a=e.parseNumber(a);return a instanceof
Error?a:Math.log(a)};g.LOG=function(a,b){a=e.parseNumber(a);b=void 0===b?10:e.parseNumber(b);return e.anyIsError(a,b)?k.value:Math.log(a)/Math.log(b)};g.LOG10=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a)/Math.log(10)};g.MDETERM=null;g.MINVERSE=null;g.MMULT=null;g.MOD=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);if(e.anyIsError(a,b))return k.value;if(0===b)return k.div0;var d=Math.abs(a%b);return 0<b?d:-d};g.MROUND=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);
return e.anyIsError(a,b)?k.value:0>a*b?k.num:Math.round(a/b)*b};g.MULTINOMIAL=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=0,d=1,f=0;f<a.length;f++)b+=a[f],d*=g.FACT(a[f]);return g.FACT(b)/d};g.MUNIT=null;g.ODD=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;var b=Math.ceil(Math.abs(a));b=b&1?b:b+1;return 0<a?b:-b};g.PI=function(){return Math.PI};g.POWER=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);if(e.anyIsError(a,b))return k.value;
var d=Math.pow(a,b);return isNaN(d)?k.num:d};g.PRODUCT=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=1,d=0;d<a.length;d++)b*=a[d];return b};g.QUOTIENT=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:parseInt(a/b,10)};g.RADIANS=function(a){a=e.parseNumber(a);return a instanceof Error?a:a*Math.PI/180};g.RAND=function(){return Math.random()};g.RANDBETWEEN=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,
b)?k.value:a+Math.ceil((b-a+1)*Math.random())-1};g.ROMAN=null;g.ROUND=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:Math.round(a*Math.pow(10,b))/Math.pow(10,b)};g.ROUNDDOWN=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)};g.ROUNDUP=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,
b))/Math.pow(10,b)};g.SEC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.cos(a)};g.SECH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))};g.SERIESSUM=function(a,b,d,f){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);f=e.parseNumberArray(f);if(e.anyIsError(a,b,d,f))return k.value;for(var h=f[0]*Math.pow(a,b),l=1;l<f.length;l++)h+=f[l]*Math.pow(a,b+l*d);return h};g.SIGN=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?
-1:0===a?0:1};g.SIN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sin(a)};g.SINH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2};g.SQRT=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?k.num:Math.sqrt(a)};g.SQRTPI=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sqrt(a*Math.PI)};g.SUBTOTAL=null;g.ADD=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?
k.value:a+b};g.MINUS=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:a-b};g.DIVIDE=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:0===b?k.div0:a/b};g.MULTIPLY=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:a*b};g.GTE=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);
b=e.parseNumber(b);return e.anyIsError(a,b)?k.error:a>=b};g.LT=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.error:a<b};g.LTE=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.error:a<=b};g.EQ=function(a,b){return 2!==arguments.length?k.na:a===b};g.NE=function(a,b){return 2!==arguments.length?k.na:a!==b};g.POW=function(a,b){if(2!==arguments.length)return k.na;a=e.parseNumber(a);
b=e.parseNumber(b);return e.anyIsError(a,b)?k.error:g.POWER(a,b)};g.SUM=function(){for(var a=0,b=Object.keys(arguments),d=0;d<b.length;++d){var f=arguments[b[d]];"number"===typeof f?a+=f:"string"===typeof f?(f=parseFloat(f),!isNaN(f)&&(a+=f)):Array.isArray(f)&&(a+=g.SUM.apply(null,f))}return a};g.SUMIF=function(){var a=e.argsToArray(arguments),b=a.pop();a=e.parseNumberArray(e.flatten(a));if(a instanceof Error)return a;for(var d=0,f=0;f<a.length;f++)d+=eval(a[f]+b)?a[f]:0;return d};g.SUMIFS=function(){var a=
e.argsToArray(arguments),b=e.parseNumberArray(e.flatten(a.shift()));if(b instanceof Error)return b;for(var d=b.length,f=a.length,h=0,l=0;l<d;l++){for(var m=b[l],n="",p=0;p<f;p+=2)n=isNaN(a[p][l])?n+('"'+a[p][l]+'"'+a[p+1]):n+(a[p][l]+a[p+1]),p!==f-1&&(n+=" && ");n=n.slice(0,-4);eval(n)&&(h+=m)}return h};g.SUMPRODUCT=null;g.SUMSQ=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=0,d=a.length,f=0;f<d;f++)b+=ISNUMBER(a[f])?a[f]*a[f]:0;return b};g.SUMX2MY2=
function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return k.value;for(var d=0,f=0;f<a.length;f++)d+=a[f]*a[f]-b[f]*b[f];return d};g.SUMX2PY2=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return k.value;var d=0;a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));for(var f=0;f<a.length;f++)d+=a[f]*a[f]+b[f]*b[f];return d};g.SUMXMY2=function(a,b){a=e.parseNumberArray(e.flatten(a));
b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return k.value;var d=0;a=e.flatten(a);b=e.flatten(b);for(var f=0;f<a.length;f++)d+=Math.pow(a[f]-b[f],2);return d};g.TAN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.tan(a)};g.TANH=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a-1)/(a+1)};g.TRUNC=function(a,b){b=void 0===b?0:b;a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,
b))/Math.pow(10,b)};return g}();x.misc=function(){var g={UNIQUE:function(){for(var c=[],a=0;a<arguments.length;++a){for(var b=!1,d=arguments[a],f=0;f<c.length&&!(b=c[f]===d);++f);b||c.push(d)}return c}};g.FLATTEN=e.flatten;g.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};g.REFERENCE=function(c,a){try{for(var b=a.split("."),d=c,f=0;f<b.length;++f){var h=b[f];if("]"===h[h.length-1]){var l=h.indexOf("["),m=h.substring(l+1,h.length-1);d=d[h.substring(0,l)][m]}else d=d[h]}return d}catch(n){}};
g.JOIN=function(c,a){return c.join(a)};g.NUMBERS=function(){return e.flatten(arguments).filter(function(c){return"number"===typeof c})};g.NUMERAL=null;return g}();x.text=function(){var g={ASC:null,BAHTTEXT:null,CHAR:function(c){c=e.parseNumber(c);return c instanceof Error?c:String.fromCharCode(c)},CLEAN:function(c){return(c||"").replace(/[\0-\x1F]/g,"")},CODE:function(c){return(c||"").charCodeAt(0)},CONCATENATE:function(){for(var c=e.flatten(arguments),a;-1<(a=c.indexOf(!0));)c[a]="TRUE";for(;-1<
(a=c.indexOf(!1));)c[a]="FALSE";return c.join("")},DBCS:null,DOLLAR:null,EXACT:function(c,a){return c===a},FIND:function(c,a,b){return a?a.indexOf(c,(void 0===b?0:b)-1)+1:null},FIXED:null,HTML2TEXT:function(c){var a="";c&&(c instanceof Array?c.forEach(function(b){""!==a&&(a+="\n");a+=b.replace(/<(?:.|\n)*?>/gm,"")}):a=c.replace(/<(?:.|\n)*?>/gm,""));return a},LEFT:function(c,a){a=e.parseNumber(void 0===a?1:a);return a instanceof Error||"string"!==typeof c?k.value:c?c.substring(0,a):null},LEN:function(c){return 0===
arguments.length?k.error:"string"===typeof c?c?c.length:0:c.length?c.length:k.value},LOWER:function(c){return"string"!==typeof c?k.value:c?c.toLowerCase():c},MID:function(c,a,b){a=e.parseNumber(a);b=e.parseNumber(b);if(e.anyIsError(a,b)||"string"!==typeof c)return b;--a;return c.substring(a,a+b)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(c){if(void 0===c||0===c.length)return k.value;!0===c&&(c="TRUE");!1===c&&(c="FALSE");if(isNaN(c)&&"number"===typeof c)return k.value;"number"===typeof c&&(c=
""+c);return c.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},REGEXEXTRACT:function(c,a){var b=c.match(new RegExp(a));return b?b[1<b.length?b.length-1:0]:null},REGEXMATCH:function(c,a,b){c=c.match(new RegExp(a));return b?c:!!c},REGEXREPLACE:function(c,a,b){return c.replace(new RegExp(a),b)},REPLACE:function(c,a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)||"string"!==typeof c||"string"!==typeof d?k.value:c.substr(0,a-1)+d+c.substr(a-
1+b)},REPT:function(c,a){a=e.parseNumber(a);return a instanceof Error?a:Array(a+1).join(c)},RIGHT:function(c,a){a=e.parseNumber(void 0===a?1:a);return a instanceof Error?a:c?c.substring(c.length-a):null},SEARCH:function(c,a,b){if("string"!==typeof c||"string"!==typeof a)return k.value;b=void 0===b?0:b;c=a.toLowerCase().indexOf(c.toLowerCase(),b-1)+1;return 0===c?k.value:c},SPLIT:function(c,a){return c.split(a)},SUBSTITUTE:function(c,a,b,d){if(c&&a&&b){if(void 0===d)return c.replace(new RegExp(a,"g"),
b);for(var f=0,h=0;0<c.indexOf(a,f);)if(f=c.indexOf(a,f+1),h++,h===d)return c.substring(0,f)+b+c.substring(f+a.length)}else return c},T:function(c){return"string"===typeof c?c:""},TEXT:null,TRIM:function(c){return"string"!==typeof c?k.value:c.replace(/ +/g," ").trim()}};g.UNICHAR=g.CHAR;g.UNICODE=g.CODE;g.UPPER=function(c){return"string"!==typeof c?k.value:c.toUpperCase()};g.VALUE=null;return g}();x.stats=function(){var g={AVEDEV:null,AVERAGE:function(){for(var c=e.numbers(e.flatten(arguments)),a=
c.length,b=0,d=0,f=0;f<a;f++)b+=c[f],d+=1;return b/d},AVERAGEA:function(){for(var c=e.flatten(arguments),a=c.length,b=0,d=0,f=0;f<a;f++){var h=c[f];"number"===typeof h&&(b+=h);!0===h&&b++;null!==h&&d++}return b/d},AVERAGEIF:function(c,a,b){b=b||c;c=e.flatten(c);b=e.parseNumberArray(e.flatten(b));if(b instanceof Error)return b;for(var d=0,f=0,h=0;h<c.length;h++)eval(c[h]+a)&&(f+=b[h],d++);return f/d},AVERAGEIFS:null,COUNT:function(){return e.numbers(e.flatten(arguments)).length},COUNTA:function(){var c=
e.flatten(arguments);return c.length-g.COUNTBLANK(c)},COUNTIN:function(c,a){for(var b=0,d=0;d<c.length;d++)c[d]===a&&b++;return b},COUNTBLANK:function(){for(var c=e.flatten(arguments),a=0,b,d=0;d<c.length;d++)b=c[d],null!==b&&""!==b||a++;return a},COUNTIF:function(){var c=e.argsToArray(arguments),a=c.pop();c=e.flatten(c);/[<>=!]/.test(a)||(a='=="'+a+'"');for(var b=0,d=0;d<c.length;d++)"string"!==typeof c[d]?eval(c[d]+a)&&b++:eval('"'+c[d]+'"'+a)&&b++;return b},COUNTIFS:function(){for(var c=e.argsToArray(arguments),
a=Array(e.flatten(c[0]).length),b=0;b<a.length;b++)a[b]=!0;for(b=0;b<c.length;b+=2){var d=e.flatten(c[b]),f=c[b+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var h=0;h<d.length;h++)a[h]="string"!==typeof d[h]?a[h]&&eval(d[h]+f):a[h]&&eval('"'+d[h]+'"'+f)}for(b=c=0;b<a.length;b++)a[b]&&c++;return c},COUNTUNIQUE:function(){return UNIQUE.apply(null,e.flatten(arguments)).length},FISHER:function(c){c=e.parseNumber(c);return c instanceof Error?c:Math.log((1+c)/(1-c))/2},FISHERINV:function(c){c=e.parseNumber(c);
if(c instanceof Error)return c;c=Math.exp(2*c);return(c-1)/(c+1)},FREQUENCY:function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(c,a))return k.value;for(var b=c.length,d=a.length,f=[],h=0;h<=d;h++)for(var l=f[h]=0;l<b;l++)0===h?c[l]<=a[0]&&(f[0]+=1):h<d?c[l]>a[h-1]&&c[l]<=a[h]&&(f[h]+=1):h===d&&c[l]>a[d-1]&&(f[d]+=1);return f},LARGE:function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);return e.anyIsError(c,a)?c:c.sort(function(b,d){return d-
b})[a-1]},MAX:function(){var c=e.numbers(e.flatten(arguments));return 0===c.length?0:Math.max.apply(Math,c)},MAXA:function(){var c=e.arrayValuesToNumbers(e.flatten(arguments));return 0===c.length?0:Math.max.apply(Math,c)},MIN:function(){var c=e.numbers(e.flatten(arguments));return 0===c.length?0:Math.min.apply(Math,c)},MINA:function(){var c=e.arrayValuesToNumbers(e.flatten(arguments));return 0===c.length?0:Math.min.apply(Math,c)},MODE:{}};g.MODE.MULT=function(){var c=e.parseNumberArray(e.flatten(arguments));
if(c instanceof Error)return c;for(var a=c.length,b={},d=[],f=0,h,l=0;l<a;l++)h=c[l],b[h]=b[h]?b[h]+1:1,b[h]>f&&(f=b[h],d=[]),b[h]===f&&(d[d.length]=h);return d};g.MODE.SNGL=function(){var c=e.parseNumberArray(e.flatten(arguments));return c instanceof Error?c:g.MODE.MULT(c).sort(function(a,b){return a-b})[0]};g.PERCENTILE={};g.PERCENTILE.EXC=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);if(e.anyIsError(c,a))return k.value;c=c.sort(function(f,h){return f-h});var b=c.length;if(a<
1/(b+1)||a>1-1/(b+1))return k.num;b=a*(b+1)-1;var d=Math.floor(b);return e.cleanFloat(b===d?c[b]:c[d]+(b-d)*(c[d+1]-c[d]))};g.PERCENTILE.INC=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);if(e.anyIsError(c,a))return k.value;c=c.sort(function(f,h){return f-h});var b=a*(c.length-1),d=Math.floor(b);return e.cleanFloat(b===d?c[b]:c[d]+(b-d)*(c[d+1]-c[d]))};g.PERCENTRANK={};g.PERCENTRANK.EXC=function(c,a,b){b=void 0===b?3:b;c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);b=e.parseNumber(b);
if(e.anyIsError(c,a,b))return k.value;c=c.sort(function(p,q){return p-q});var d=UNIQUE.apply(null,c),f=c.length,h=d.length;b=Math.pow(10,b);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=(c.indexOf(d[n])+1)/(f+1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(c.indexOf(d[n])+1+(a-d[n])/(d[n+1]-d[n]))/(f+1),m=!0),n++;return Math.floor(l*b)/b};g.PERCENTRANK.INC=function(c,a,b){b=void 0===b?3:b;c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);b=e.parseNumber(b);if(e.anyIsError(c,a,b))return k.value;c=c.sort(function(p,
q){return p-q});var d=UNIQUE.apply(null,c),f=c.length,h=d.length;b=Math.pow(10,b);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=c.indexOf(d[n])/(f-1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(c.indexOf(d[n])+(a-d[n])/(d[n+1]-d[n]))/(f-1),m=!0),n++;return Math.floor(l*b)/b};g.PERMUT=function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:FACT(c)/FACT(c-a)};g.PERMUTATIONA=function(c,a){c=e.parseNumber(c);a=e.parseNumber(a);return e.anyIsError(c,a)?k.value:Math.pow(c,a)};g.PHI=
function(c){c=e.parseNumber(c);return c instanceof Error?k.value:Math.exp(-.5*c*c)/2.5066282746310002};g.PROB=function(c,a,b,d){if(void 0===b)return 0;d=void 0===d?b:d;c=e.parseNumberArray(e.flatten(c));a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(c,a,b,d))return k.value;if(b===d)return 0<=c.indexOf(b)?a[c.indexOf(b)]:0;for(var f=c.sort(function(n,p){return n-p}),h=f.length,l=0,m=0;m<h;m++)f[m]>=b&&f[m]<=d&&(l+=a[c.indexOf(f[m])]);return l};g.QUARTILE={};
g.QUARTILE.EXC=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);if(e.anyIsError(c,a))return k.value;switch(a){case 1:return g.PERCENTILE.EXC(c,.25);case 2:return g.PERCENTILE.EXC(c,.5);case 3:return g.PERCENTILE.EXC(c,.75);default:return k.num}};g.QUARTILE.INC=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);if(e.anyIsError(c,a))return k.value;switch(a){case 1:return g.PERCENTILE.INC(c,.25);case 2:return g.PERCENTILE.INC(c,.5);case 3:return g.PERCENTILE.INC(c,
.75);default:return k.num}};g.RANK={};g.RANK.AVG=function(c,a,b){c=e.parseNumber(c);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(c,a))return k.value;a=e.flatten(a);a=a.sort(b?function(h,l){return h-l}:function(h,l){return l-h});b=a.length;for(var d=0,f=0;f<b;f++)a[f]===c&&d++;return 1<d?(2*a.indexOf(c)+d+1)/2:a.indexOf(c)+1};g.RANK.EQ=function(c,a,b){c=e.parseNumber(c);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(c,a))return k.value;a=a.sort(b?function(d,f){return d-f}:function(d,f){return f-
d});return a.indexOf(c)+1};g.RSQ=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumberArray(e.flatten(a));return e.anyIsError(c,a)?k.value:Math.pow(g.PEARSON(c,a),2)};g.SMALL=function(c,a){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);return e.anyIsError(c,a)?c:c.sort(function(b,d){return b-d})[a-1]};g.STANDARDIZE=function(c,a,b){c=e.parseNumber(c);a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(c,a,b)?k.value:(c-a)/b};g.STDEV={};g.STDEV.P=function(){var c=g.VAR.P.apply(this,
arguments);return Math.sqrt(c)};g.STDEV.S=function(){var c=g.VAR.S.apply(this,arguments);return Math.sqrt(c)};g.STDEVA=function(){var c=g.VARA.apply(this,arguments);return Math.sqrt(c)};g.STDEVPA=function(){var c=g.VARPA.apply(this,arguments);return Math.sqrt(c)};g.VAR={};g.VAR.P=function(){for(var c=e.numbers(e.flatten(arguments)),a=c.length,b=0,d=g.AVERAGE(c),f=0;f<a;f++)b+=Math.pow(c[f]-d,2);return b/a};g.VAR.S=function(){for(var c=e.numbers(e.flatten(arguments)),a=c.length,b=0,d=g.AVERAGE(c),
f=0;f<a;f++)b+=Math.pow(c[f]-d,2);return b/(a-1)};g.VARA=function(){for(var c=e.flatten(arguments),a=c.length,b=0,d=0,f=g.AVERAGEA(c),h=0;h<a;h++){var l=c[h];b="number"===typeof l?b+Math.pow(l-f,2):!0===l?b+Math.pow(1-f,2):b+Math.pow(0-f,2);null!==l&&d++}return b/(d-1)};g.VARPA=function(){for(var c=e.flatten(arguments),a=c.length,b=0,d=0,f=g.AVERAGEA(c),h=0;h<a;h++){var l=c[h];b="number"===typeof l?b+Math.pow(l-f,2):!0===l?b+Math.pow(1-f,2):b+Math.pow(0-f,2);null!==l&&d++}return b/d};g.WEIBULL={};
g.WEIBULL.DIST=function(c,a,b,d){c=e.parseNumber(c);a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(c,a,b)?k.value:d?1-Math.exp(-Math.pow(c/b,a)):Math.pow(c,a-1)*Math.exp(-Math.pow(c/b,a))*a/Math.pow(b,a)};g.Z={};g.Z.TEST=function(c,a,b){c=e.parseNumberArray(e.flatten(c));a=e.parseNumber(a);if(e.anyIsError(c,a))return k.value;b=b||g.STDEV.S(c);var d=c.length;return 1-g.NORM.S.DIST((g.AVERAGE(c)-a)/(b/Math.sqrt(d)),!0)};return g}();x.utils=function(){return{PROGRESS:function(g,c){return'<div style="width:'+
(g?g:"0")+"%;height:4px;background-color:"+(c?c:"red")+';margin-top:1px;"></div>'},RATING:function(g){for(var c='<div class="jrating">',a=0;5>a;a++)c=a<g?c+'<div class="jrating-selected"></div>':c+"<div></div>";return c+"</div>"}}}();for(var E=0;E<Object.keys(x).length;E++)for(var B=x[Object.keys(x)[E]],y=Object.keys(B),w=0;w<y.length;w++)if(B[y[w]])if("function"==typeof B[y[w]]||"object"==typeof B[y[w]]){if(window[y[w]]=B[y[w]],window[y[w]].toString=function(){return"#ERROR"},"object"==typeof B[y[w]])for(var I=
Object.keys(B[y[w]]),F=0;F<I.length;F++)window[y[w]][I[F]].toString=function(){return"#ERROR"}}else window[y[w]]=function(){return y[w]+"Not implemented"};else window[y[w]]=function(){return y[w]+"Not implemented"};var G=null,C=null,D=null;window.TABLE=function(){return D};window.COLUMN=window.COL=function(){return parseInt(G)+1};window.ROW=function(){return parseInt(C)+1};window.CELL=function(){return A.getColumnNameFromCoords(G,C)};window.VALUE=function(g,c,a){return D.getValueFromCoords(parseInt(g)-
1,parseInt(c)-1,a)};window.THISROWCELL=function(g){return D.getValueFromCoords(parseInt(g)-1,parseInt(C))};var A=function(g,c,a,b,d){D=d;G=a;C=b;b="";d=Object.keys(c);if(d.length)for(a=0;a<d.length;a++)b=-1==d[a].indexOf(".")&&-1==d[a].indexOf("!")?b+("var "+d[a]+" = "+c[d[a]]+";\n"):b+(d[a]+" = "+c[d[a]]+";\n");g=g.replace(/\$/g,"");g=g.replace(/!/g,".");c="";a=0;d=["=","!",">","<"];for(var f=0;f<g.length;f++)'"'==g[f]&&(a=0==a?1:0),1==a?c+=g[f]:(c+=g[f].toUpperCase(),0<f&&"="==g[f]&&-1==d.indexOf(g[f-
1])&&-1==d.indexOf(g[f+1])&&(c+="="));c=c.replace(/\^/g,"**");c=c.replace(/<>/g,"!=");c=c.replace(/&/g,"+");g=c=c.replace(/\$/g,"");if((c=g.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&c.length)for(a=0;a<c.length;a++)d=A.getTokensFromRange(c[a]),g=g.replace(c[a],"["+d.join(",")+"]");return(new Function(b+"; return "+g))()};A.getColumnNameFromCoords=function(g,c){var a=parseInt(g),b="";701<a?(b+=String.fromCharCode(64+parseInt(a/676)),b+=String.fromCharCode(64+parseInt(a%
676/26))):25<a&&(b+=String.fromCharCode(64+parseInt(a/26)));b+=String.fromCharCode(65+a%26);return b+(parseInt(c)+1)};A.getCoordsFromColumnName=function(g){var c=/^[a-zA-Z]+/.exec(g);if(c){for(var a=0,b=0;b<c[0].length;b++)a+=parseInt(c[0].charCodeAt(b)-64)*Math.pow(26,c[0].length-1-b);a--;0>a&&(a=0);g=parseInt(/[0-9]+$/.exec(g))||null;0<g&&g--;return[a,g]}};A.getRangeFromTokens=function(g){g=g.filter(function(d){return"#REF!"!=d});for(var c="",a="",b=0;b<g.length;b++)0<=g[b].indexOf(".")?c=".":0<=
g[b].indexOf("!")&&(c="!"),c&&(a=g[b].split(c),g[b]=a[1],a=a[0]+c);g.sort(function(d,f){var h=Helpers.getCoordsFromColumnName(d),l=Helpers.getCoordsFromColumnName(f);return h[1]>l[1]?1:h[1]<l[1]?-1:h[0]>l[0]?1:h[0]<l[0]?-1:0});return g.length?a+(g[0]+":"+g[g.length-1]):"#REF!"};A.getTokensFromRange=function(g){if(0<g.indexOf(".")){var c=g.split(".");g=c[1];c=c[0]+"."}else 0<g.indexOf("!")?(c=g.split("!"),g=c[1],c=c[0]+"!"):c="";g=g.split(":");var a=A.getCoordsFromColumnName(g[0]),b=A.getCoordsFromColumnName(g[1]);
if(a[0]<=b[0]){g=a[0];var d=b[0]}else g=b[0],d=a[0];if(null===a[1]&&null==b[1])for(var f=null,h=null,l=Object.keys(vars),m=0;m<l.length;m++){var n=A.getCoordsFromColumnName(l[m]);n[0]===a[0]&&(null===f||n[1]<f)&&(f=n[1]);n[0]===b[0]&&(null===h||n[1]>h)&&(h=n[1])}else a[1]<=b[1]?(f=a[1],h=b[1]):(f=b[1],h=a[1]);for(a=[];f<=h;f++){b=[];for(m=g;m<=d;m++)b.push(c+A.getColumnNameFromCoords(m,f));a.push(b)}return a};A.setFormula=function(g){for(var c=Object.keys(g),a=0;a<c.length;a++)"function"==typeof g[c[a]]&&
(window[c[a]]=g[c[a]])};return A}()});
