/**
 * Jspreadsheet XLSX parser 2.0.1
 * https://JSS.com/v8/plugins/parser
 * @License: this plugin requires a license
 */

if (! JSZip && typeof(require) === 'function') {
    var JSZip = require('jszip');
}

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,n,r){if(t==Array.prototype||t==Object.prototype)return t;t[n]=r.value;return t};
$jscomp.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var n=0;n<t.length;++n){var r=t[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(t,n){var r=$jscomp.propertyToPolyfillSymbol[n];if(null==r)return t[n];r=t[r];return void 0!==r?r:t[n]};$jscomp.polyfill=function(t,n,r,u){n&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(t,n,r,u):$jscomp.polyfillUnisolated(t,n,r,u))};
$jscomp.polyfillUnisolated=function(t,n,r,u){r=$jscomp.global;t=t.split(".");for(u=0;u<t.length-1;u++){var v=t[u];if(!(v in r))return;r=r[v]}t=t[t.length-1];u=r[t];n=n(u);n!=u&&null!=n&&$jscomp.defineProperty(r,t,{configurable:!0,writable:!0,value:n})};
$jscomp.polyfillIsolated=function(t,n,r,u){var v=t.split(".");t=1===v.length;u=v[0];u=!t&&u in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var z=0;z<v.length-1;z++){var h=v[z];if(!(h in u))return;u=u[h]}v=v[v.length-1];r=$jscomp.IS_SYMBOL_NATIVE&&"es6"===r?u[v]:null;n=n(r);null!=n&&(t?$jscomp.defineProperty($jscomp.polyfills,v,{configurable:!0,writable:!0,value:n}):n!==r&&(void 0===$jscomp.propertyToPolyfillSymbol[v]&&(r=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[v]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(v):$jscomp.POLYFILL_PREFIX+r+"$"+v),$jscomp.defineProperty(u,$jscomp.propertyToPolyfillSymbol[v],{configurable:!0,writable:!0,value:n})))};$jscomp.polyfill("Array.prototype.includes",function(t){return t?t:function(n,r){var u=this;u instanceof String&&(u=String(u));var v=u.length;r=r||0;for(0>r&&(r=Math.max(r+v,0));r<v;r++){var z=u[r];if(z===n||Object.is(z,n))return!0}return!1}},"es7","es3");if(!JSZip&&"function"===typeof require)var JSZip=require("jszip");
if(!jSuites&&"function"===typeof require)var jSuites=require("jsuites");
(function(t,n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define(n):t.parser=n()})(this,function(){function t(b){b=Y+864E5*b;b>=Z&&(b-=864E5);return new Date(b)}var n=null,r=null,u=null,v=[],z={},h={},D=[],L=[],N=function(){var b=function(d){b.license=d;b.run()};b.k="745048504833";b.apply=function(d,c){var g=jSuites.sha512,f="",a="";128<d.length&&(d=g(d));for(var e=0;128>e;e++){var k=d[e]?d[e].charCodeAt(0):0;f+=String.fromCharCode(54^
k);a+=String.fromCharCode(92^k)}return g(a+g(f+c))};b.run=function(){if("undefined"==typeof b.result){b.result=1;try{if(b.license){var d=window.atob(b.license);d=d.split(",");if(d[1])if(d[1]=window.atob(d[1]),d[0]!=b.apply(b.k,d[1]))b.result=3;else if(d[1]=JSON.parse(d[1]),d[1].date){var c=window.location.hostname||"localhost",g=c.split(".");c=c.split(".");2<c.length&&!jSuites.isNumeric(c[c.length-1])&&g.shift();g=g.join(".");c=c.join(".");-1==d[1].domain.indexOf(g)&&-1==d[1].domain.indexOf(c)?b.result=
4:d[1].scope&&0<=d[1].scope.indexOf("parser")?(b.result=6,b.name=d[1].name):b.result=5}else b.result=4;else b.result=2}}catch(f){}}return b.result};b.label=function(){var d="";b.result&&1!=b.result?2==b.result||3==b.result||4==b.result?d="A valid license is required":5==b.result&&(d="This plugin is not included on the scope of this license"):d="License required";return d};b.status=function(){return b.result};return b}(),B=function(b){return(new DOMParser).parseFromString(b,"text/xml").firstChild},
E=function(b,d,c,g="string"){L.push(c.file(b).async(g));D.push({name:b,type:d})},G=function(b,d){d||(d="type");return D.findIndex(function(c){return c[d]===b})},I=function(b){return D.filter(function(d){return d.type===b})},O=function(b,d){jSuites.loading.show();E("xl/workbook.xml","workbook",b);E("xl/styles.xml","styles",b);b.file("xl/theme/theme1.xml")&&E("xl/theme/theme1.xml","theme",b);b.file("xl/sharedStrings.xml")&&E("xl/sharedStrings.xml","sharedStrings",b);var c=Object.keys(b.files),g=c.filter(function(f){return 0===
f.indexOf("xl/worksheets/sheet")});g=g.sort(function(f,a){f=parseInt(f.slice(19));a=parseInt(a.slice(19));return f-a});g.forEach(function(f){E(f,"worksheet",b)});c.forEach(function(f){f.includes("xl/drawings/drawing")?E(f,"drawing",b):f.includes("xl/drawings/_rels/drawing")?E(f,"drawingRel",b):f.includes("xl/worksheets/_rels/sheet")?E(f,"rel",b):f.includes("xl/media")?E(f,"image",b,"base64"):f.includes("xl/comments")&&E(f,"comment",b)});Promise.all(L).then(function(f){var a=G("workbook"),e=B(f[a]),
k=e.querySelector("sheets");for(a=0;a<k.children.length;a++){var l={data:[],columns:[],cells:{},style:{},textOverflow:!0,stripHTML:!1,defaultColAlign:"left",defaultColWidth:"100px",worksheetName:k.children[a].getAttribute("name")},w=k.children[a].getAttribute("state");w&&"hidden"===w&&(l.worksheetState="hidden");h.worksheets.push(l)}if(e=e.querySelector("definedNames"))for(h.definedNames={},a=0;a<e.children.length;a++)e.children[a].getAttribute("hidden")||e.children[a].getAttribute("localSheetId")||
(h.definedNames[e.children[a].getAttribute("name").toUpperCase()]=e.children[a].firstChild.nodeValue);a=G("styles");a=B(f[a]);if((e=a.querySelector("colors indexedColors"))&&e.children)for(k=0;k<e.children.length;k++)v.push(e.children[k].getAttribute("rgb"));else v="FF000000 FFFFFFFF FFFF0000 FF00FF00 FF0000FF FFFFFF00 FFFF00FF FF00FFFF FF000000 FFFFFFFF FFFF0000 FF00FF00 FF0000FF FFFFFF00 FFFF00FF FF00FFFF FF800000 FF008000 FF000080 FF808000 FF800080 FF008080 FFC0C0C0 FF808080 FF9999FF FF993366 FFFFFFCC FFCCFFFF FF660066 FFFF8080 FF0066CC FFCCCCFF FF000080 FFFF00FF FFFFFF00 FF00FFFF FF800080 FF800000 FF008080 FF0000FF FF00CCFF FFCCFFFF FFCCFFCC FFFFFF99 FF99CCFF FFFF99CC FFCC99FF FFFFCC99 FF3366FF FF33CCCC FF99CC00 FFFFCC00 FFFF9900 FFFF6600 FF666699 FF969696 FF003366 FF339966 FF003300 FF333300 FF993300 FF993366 FF333399 FF333333".split(" ");
u=a;a=G("theme");if(!(0>a)){a=B(f[a]).firstChild.firstChild.children;for(e=0;e<a.length;e++){color=a[e].firstChild.getAttribute("val");if("windowText"===color||"window"===color)color=a[e].firstChild.getAttribute("lastClr");z.color.push(color)}0<=a[0].tagName.indexOf("dk")&&(e=z.color[0],z.color[0]=z.color[1],z.color[1]=e);0<=a[2].tagName.indexOf("dk")&&(e=z.color[2],z.color[2]=z.color[3],z.color[3]=e)}a=G("sharedStrings");if(0>a)r=void 0;else{a=B(f[a]);e=[];for(k=0;k<a.children.length;k++)if(l=a.children[k],
1===l.children.length)e.push(l.firstChild.firstChild.nodeValue);else{w="";for(var m=0;m<l.children.length;m++){var q=l.children[m].querySelector("rPr");if(q){w+='<span style="';var y=l.children[m].querySelector("t");y.getAttribute("xml:space")||(w+="all: initial;");var p=q.querySelector("sz");p&&(w+="font-size: "+p.getAttribute("val")+"pt;");(p=q.querySelector("rFont"))&&(w+="font-family: "+p.getAttribute("val")+";");q.querySelector("b")&&(w+="font-weight: bold;");q.querySelector("i")&&(w+="font-style: italic;");
if(p=q.querySelector("color"))if(q=p.getAttribute("indexed"))w+="color: #"+v[q].substr(2)+";";else if(q=p.getAttribute("theme"))p=p.getAttribute("tint"),w+="color: #"+J(z.color[q],parseFloat(p))+";";else if(q=p.getAttribute("rgb"))w+="color: #"+q.substr(2)+";";w+='">'+y.innerHTML+"</span>"}else w+=l.children[m].querySelector("t").innerHTML}e.push(w)}r=e}aa(f);ba(f);ca(f);da(f);d.license&&(h.license=d.license);d.onload(h);jSuites.loading.hide()})},P={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",
9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:"",65535:"General"},Q={thin:["solid","1px"],medium:["solid","2px"],thick:["solid","3px"],dotted:["dotted","1px"],dashed:["dashed","1px"],double:["double","1px"],
mediumDashed:["dashed","2px"]},ea=function(b,d,c){var g="";var f=parseInt(d.getAttribute("fillId"));if(!isNaN(f)&&(f=u.querySelector("fills").children[f],"solid"===f.firstChild.getAttribute("patternType"))){f=f.firstChild.firstChild;var a=f.getAttribute("indexed");if(v&&v[a])g+="background-color: #"+v[a].substr(2)+";";else if(a=f.getAttribute("theme"))f=f.getAttribute("tint"),g+="background-color: #"+J(z.color[a],parseFloat(f))+";";else if(a=f.getAttribute("rgb"))g+="background-color: #"+a.substr(2)+
";"}f=parseInt(d.getAttribute("fontId"));if(!isNaN(f)){f=u.querySelector("fonts").children[f];var e=f.querySelector("sz");e&&(g+="font-size: "+e.getAttribute("val")+"pt;");f.querySelector("b")&&(g+="font-weight: bold;");f.querySelector("i")&&(g+="font-style: italic;");(e=f.querySelector("name"))&&(g+="font-family: "+e.getAttribute("val")+";");var k=f.querySelector("color");k&&(a=k.getAttribute("indexed"),v&&v[a]?g+="color: #"+v[a].substr(2)+";":(a=k.getAttribute("theme"))?(k=k.getAttribute("tint"),
g+="color: #"+J(z.color[a],parseFloat(k))+";"):(a=k.getAttribute("rgb"))&&a&&(g+="color: #"+a.substr(2)+";"))}if(f=d.querySelector("alignment")){(e=f.getAttribute("horizontal"))&&(g+="text-align: "+e+";");if(e=f.getAttribute("vertical"))"center"===e&&(e="middle"),g+="vertical-align: "+e+";";f.getAttribute("wrapText")&&(g+="white-space: break-spaces;")}f=parseInt(d.getAttribute("borderId"));if(!isNaN(f))for(f=u.querySelector("borders").children[f],e=0;e<f.children.length;e++){var l=f.children[e].tagName;
if("top"===l){if(a=n.helpers.getCoordsFromColumnName(b),0!==a[1]&&(a=n.helpers.getColumnNameFromCoords(a[0],a[1]-1),(a=h.worksheets[c].style[a])&&a.includes("border-bottom-style")))continue}else if("left"===l&&(a=n.helpers.getCoordsFromColumnName(b),0!==a[0]&&(a=n.helpers.getColumnNameFromCoords(a[0]-1,a[1]),(a=h.worksheets[c].style[a])&&a.includes("border-right-style"))))continue;if("diagonal"!==l&&(a=f.children[e].getAttribute("style"))&&((a=Q[a])||(a=["solid","1px"]),g+="border-"+l+"-style: "+
a[0]+";",g+="border-"+l+"-width: "+a[1]+";",k=f.children[e].firstChild))if(a=k.getAttribute("indexed"))(a=v[a%v.length])||(a="00000000"),g+="border-"+l+"-color: #"+a.substr(2)+";";else if(a=k.getAttribute("theme"))k=k.getAttribute("tint"),g+="border-"+l+"-color: #"+J(z.color[a],parseFloat(k))+";";else if(a=k.getAttribute("rgb"))6<a.length&&(a=a.substr(2)),g+="border-"+l+"-color: #"+a+";"}g&&(h.worksheets[c].style[b]||(h.worksheets[c].style[b]=""),h.worksheets[c].style[b]=g);(apply=d.getAttribute("applyProtection"))&&
(g=d.querySelector("protection"))&&"0"==g.getAttribute("locked")&&(h.worksheets[c].cells||(h.worksheets[c].cells={}),h.worksheets[c].cells[b]||(h.worksheets[c].cells[b]={}),h.worksheets[c].cells[b].locked=!1);if(apply=d.getAttribute("applyNumberFormat"))d=parseInt(d.getAttribute("numFmtId")),P[d]?d=P[d]:(d=u.querySelector("numFmts").querySelector('[numFmtId="'+d+'"]'),d=d.getAttribute("formatCode")),d&&(d=d.replace(RegExp("\\\\","g"),""),d=d.replace(RegExp('"',"g"),""),"General"!=d&&(h.worksheets[c].cells||
(h.worksheets[c].cells={}),h.worksheets[c].cells[b]||(h.worksheets[c].cells[b]={}),h.worksheets[c].cells[b].type||(h.worksheets[c].cells[b].type="text"),h.worksheets[c].cells[b].format=d))},R=["_xlfn.","_xll."],M=function(b){for(var d=0;d<R.length;d++)b=b.replace(new RegExp(R[d],"ig"),"");return b},fa={whole:"number",decimal:"number",list:"list",textLength:"textLength",date:"date"},ha={notBetween:"not between",equal:"=",notEqual:"!=",greaterThan:">",lessThan:"<",greaterThanOrEqual:">=",lessThanOrEqual:"<="},
S=function(b,d){if("object"!==typeof b||"object"!==typeof d||null===b||null===d)return b===d;var c=Object.keys(b),g=Object.keys(d);if(c.length!==g.length)return!1;c.sort();g.sort();for(var f=0;f<c.length;f++)if(c[f]!==g[f])return!1;return c.every(function(a){return S(b[a],d[a])})},ia=function(b){var d=[];b.split(" ").forEach(function(c){var g=c.split(":");if(1===g.length)d.push(g[0]);else{c=n.helpers.getCoordsFromColumnName(g[0]);g=n.helpers.getCoordsFromColumnName(g[1]);for(var f=c[1];f<=g[1];f++)for(var a=
c[0];a<=g[0];a++)d.push(n.helpers.getColumnNameFromCoords(a,f))}});return d},T=function(b,d,c){Array.isArray(h.validations)||(h.validations=[]);var g=h.validations.findIndex(function(f){return S(c,f)});0>g&&(g=h.validations.length,h.validations.push(c));h.worksheets[b].cells||(h.worksheets[b].cells={});ia(d).forEach(function(f){h.worksheets[b].cells[f]||(h.worksheets[b].cells[f]={});h.worksheets[b].cells[f].validation=g})},Y=Date.UTC(1900,0,0),Z=Date.UTC(1900,1,29),ba=function(b){for(var d=I("worksheet"),
c=0;c<d.length;c++){var g=B(b[D.indexOf(d[c])]).querySelectorAll('dataValidation[showErrorMessage="1"]');Array.from(g).forEach(function(f){var a={},e=f.getAttribute("type");a.type=fa[e];if(a.type){a.criteria;"list"!==a.type&&(e=f.getAttribute("operator"),a.criteria=ha[e]||"between");e=f.querySelector("formula1");a.value=[];if("list"===a.type)e=e.innerHTML.slice(1,-1),a.value.push(e.split(","));else if("date"===a.type){e=t(e.innerHTML);var k=e.getTimezoneOffset();e.setMinutes(e.getMinutes()+k);e=jSuites.calendar.getDateString(e,
"yyyy-mm-dd");a.value.push(e)}else a.value.push(parseFloat(e.innerHTML));if(e=f.querySelector("formula2"))"date"===a.type?(e=t(e.innerHTML),k=e.getTimezoneOffset(),e.setMinutes(e.getMinutes()+k),e=jSuites.calendar.getDateString(e,"yyyy-mm-dd"),a.value.push(e)):a.value.push(parseFloat(e.innerHTML));e=f.getAttribute("errorStyle");a.action="warning"===e?"warn":"reject";a.text=f.getAttribute("errorTitle");a.text||(a.text=f.getAttribute("error"));a.allowBlank=!!f.getAttribute("allowBlank");T(c,f.getAttribute("sqref"),
a)}})}},ja=["containsBlanks","notContainsBlanks"].concat(["cellIs","containsText","notContainsText","beginsWith","endsWith"]),U={equal:"=",notEqual:"!=",greaterThan:">",lessThan:"<",greaterThanOrEqual:">=",lessThanOrEqual:"<=",between:"between",notBetween:"not between"},V={containsText:"contains",notContains:"not contains",beginsWith:"begins with",endsWith:"ends with"},ka=["left","right","top","bottom"],la=function(b){var d={};b=b.getAttribute("dxfId");var c=u.querySelector("dxfs > dxf:nth-of-type("+
(parseInt(b)+1)+")");(b=c.querySelector("patternFill > bgColor"))&&(d["background-color"]="#"+b.getAttribute("rgb").slice(2));(b=c.querySelector("font color"))&&(d.color="#"+b.getAttribute("rgb").slice(2));var g=c.querySelector("border");g&&ka.forEach(function(f){var a=g.querySelector(f);if(a){a=Q[a.getAttribute("style")];var e="#"+c.querySelector("color").getAttribute("rgb").slice(2);d["border-"+f]=a[1]+" "+a[0]+" "+e}});return d},ca=function(b){for(var d=I("worksheet"),c=0;c<d.length;c++){var g=
B(b[D.indexOf(d[c])]).querySelectorAll("conditionalFormatting");Array.from(g).forEach(function(f){var a=f.querySelector("cfRule");if(a){var e=a.getAttribute("type");if(e&&ja.includes(e)){var k={action:"format",format:la(a)};"containsBlanks"===e?k.type="not exist":"notContainsBlanks"===e?k.type="exist":(e=a.getAttribute("operator"),U[e]?(k.type="number",k.criteria=U[e],a=a.querySelectorAll("formula"),k.value=Array.from(a).map(function(l){return l.innerHTML})):V[e]&&(k.type="text",k.criteria=V[e],a=
a.getAttribute("text"),k.value=[a]));f=f.getAttribute("sqref");T(c,f,k)}}})}},aa=function(b){for(var d=I("worksheet"),c=0;c<d.length;c++){var g=[],f=[],a=B(b[D.indexOf(d[c])]),e=a.querySelector("dimension");if(e){e=e.getAttribute("ref");end=-1!==e.indexOf(":")?e.split(":")[1]:e;var k=n.helpers.getCoordsFromColumnName(end)}else e=a.querySelectorAll("row c[r]"),e=Array.from(e).map(function(F){return n.helpers.getCoordsFromColumnName(F.getAttribute("r"))}),k=[0,0],e.forEach(function(F){F[0]>k[0]&&(k[0]=
F[0]);F[1]>k[1]&&(k[1]=F[1])});k[0]++;k[1]++;h.worksheets[c].minDimensions=k;for(e=0;e<k[1];e++){g[e]=[];for(var l=0;l<k[0];l++)g[e][l]=""}if(10<k[0]||100<k[1])300<k[1]&&(h.worksheets[c].lazyLoading=!0),h.worksheets[c].tableOverflow=!0,h.worksheets[c].tableHeight="800px",10<k[0]&&(h.worksheets[c].tableWidth="1024px");if(e=a.querySelector("cols"))for(h.worksheets[c].columns=[],l=0;l<e.children.length;l++){for(var w=parseInt(e.children[l].getAttribute("min")),m=parseInt(e.children[l].getAttribute("max")),
q=Math.round(7.15*parseInt(e.children[l].getAttribute("width")))+"px",y=parseInt(e.children[l].getAttribute("hidden"));w-1!==h.worksheets[c].columns.length;)h.worksheets[c].columns.push({type:"text"});for(;w<=m&&w<=k[0];w++){var p={width:q};1===y&&(p.type="hidden");h.worksheets[c].columns.push(p)}}if(e=a.querySelector("mergeCells"))for(h.worksheets[c].mergeCells={},l=0;l<e.children.length;l++)m=e.children[l].getAttribute("ref").split(":"),q=n.helpers.getCoordsFromColumnName(m[0]),y=n.helpers.getCoordsFromColumnName(m[1]),
h.worksheets[c].mergeCells[m[0]]=[y[0]-q[0]+1,y[1]-q[1]+1];m=u.querySelector("cellXfs");q=a.querySelector("sheetData");y=[];for(e=0;e<q.children.length;e++){w=q.children[e];l=w.getAttribute("r")-1;p=w.getAttribute("ht");var C=w.getAttribute("hidden");if(p||C)h.worksheets[c].rows||(h.worksheets[c].rows={}),h.worksheets[c].rows[l]||(h.worksheets[c].rows[l]={}),p&&(h.worksheets[c].rows[l].height=Math.ceil(1.333333333*parseFloat(p))),"true"===C&&(h.worksheets[c].rows[l].visible=!1);for(l=0;l<w.children.length;l++){var A=
w.children[l];p=A.getAttribute("r");C=A.getAttribute("t");var x=A.getAttribute("s");0<x&&ea(p,m.children[x],c);x=A.getAttribute("r");p=n.helpers.getCoordsFromColumnName(x);p=[parseInt(p[0]),parseInt(p[1])];if(!y.includes(x))if("s"===C)g[p[1]][p[0]]=r[A.firstChild.innerHTML];else if(C=A.getElementsByTagName("f")[0],A=A.getElementsByTagName("v")[0],C)if(x=null,A=C.getAttribute("ref"),x=C.getAttribute("t"),"array"==x)f[p[1]]||(f[p[1]]=[]),x="="+M(C.firstChild.nodeValue),g[p[1]][p[0]]=x,f[p[1]][p[0]]=
x,p=-1!==A.indexOf(":")?n.helpers.getTokensFromRange(A):[A],y=y.concat(p);else if("shared"==x){if(A){x=A.split(":");x=[n.helpers.getCoordsFromColumnName(x[0]),n.helpers.getCoordsFromColumnName(x[1])];A=[parseInt(x[0][0]),parseInt(x[0][1])];x=[parseInt(x[1][0]),parseInt(x[1][1])];for(var H=A[1];H<=x[1];H++){f[H]||(f[H]=[]);for(var K=A[0];K<=x[0];K++)f[H][K]="="+n.helpers.shiftFormula(M(C.innerHTML),K-A[0],H-A[1])}}f[p[1]]&&f[p[1]][p[0]]&&(g[p[1]][p[0]]=f[p[1]][p[0]])}else"shared"!==x&&(g[p[1]][p[0]]=
"="+M(C.firstChild.nodeValue));else A&&(x=A.innerHTML,Number(x)==x&&(x=Number(x)),g[p[1]][p[0]]=x)}}f=d[c].name;var ma=f.slice(0,13)+"/_rels"+f.slice(13)+".rels";f=D.findIndex(function(F){return F.name===ma});if(-1<f){f=B(b[f]);if(e=a.querySelector("hyperlinks"))for(l=0;l<e.children.length;l++)if(m=e.children[l].getAttribute("r:id"))m=f.querySelector("[Id="+m+"]"),m=m.getAttribute("Target"),q=e.children[l].getAttribute("ref"),h.worksheets[c].cells[q]?(h.worksheets[c].cells[q].type="url",h.worksheets[c].cells[q].options=
{url:m}):h.worksheets[c].cells[q]={type:"url",options:{url:m}};e=a.querySelectorAll("drawing");for(l=0;l<e.length;l++)if(m=e[l].getAttribute("r:id"),m=f.querySelector("[Id="+m+"]"),q=m.getAttribute("Target"),q="xl/"+q.slice(3),m=G(q,"name"),m=B(b[m]),y=m.querySelector("blip"))y=y.getAttribute("r:embed"),q=q.slice(0,12)+"_rels/"+q.slice(12)+".rels",q=G(q,"name"),q=B(b[q]).querySelector('Relationship[Id="'+y+'"]').getAttribute("Target"),q="xl/"+q.slice(3),q=G(q,"name"),h.worksheets[c].media||(h.worksheets[c].media=
[]),p=m.querySelector("off"),y=m.querySelector("ext[cx]"),m=m.querySelector("from"),m=[m.querySelector("col"),m.querySelector("row")],m=[parseInt(m[0].innerHTML),parseInt(m[1].innerHTML)],w=n.helpers.getColumnNameFromCoords(m[0],m[1]),g[m[1]]||(g[m[1]]=[]),p=parseInt(y.getAttribute("cx"))/9525,y=parseInt(y.getAttribute("cy"))/9525,g[m[1]][m[0]]="data:image/png;base64,"+b[q],h.worksheets[c].cells[w]={type:"image",options:{absolute:!0,width:p,height:y}}}h.worksheets[c].data=g;if(g=a.querySelector("sheetProtection"))a=
g.getAttribute("sheet"),"1"==a&&(h.worksheets[c].locked=!0,a=g.getAttribute("sort"),"0"!=a&&(h.worksheets[c].columnSorting=!1),a=g.getAttribute("insertRows"),"0"!=a&&(h.worksheets[c].allowInsertRow=!1),a=g.getAttribute("deleteRows"),"0"!=a&&(h.worksheets[c].allowDeleteRow=!1),a=g.getAttribute("insertColumns"),"0"!=a&&(h.worksheets[c].allowInsertColumn=!1),a=g.getAttribute("deleteColumns"),"0"!=a&&(h.worksheets[c].allowDeleteColumn=!1),a=g.getAttribute("selectUnlockedCells"),"1"==a&&(h.worksheets[c].selectUnLockedCells=
!1),a=g.getAttribute("selectLockedCells"),"1"==a&&(h.worksheets[c].selectLockedCells=!1),h.worksheets[c].columnDrag=!1,h.worksheets[c].rowDrag=!1);for(e=0;e<h.worksheets[c].data.length;e++)for(h.worksheets[c].data[e]||(h.worksheets[c].data[e]=[]),l=0;l<h.worksheets[c].columns.length;l++)if(null===h.worksheets[c].data[e][l]||void 0===h.worksheets[c].data[e][l])h.worksheets[c].data[e][l]="";h.worksheets[c].minDimensions[0]<l&&(h.worksheets[c].minDimensions[0]=l);h.worksheets[c].minDimensions[1]<e&&
(h.worksheets[c].minDimensions[1]=e)}},da=function(b){for(var d=I("rel"),c=0;c<d.length;c++){var g=B(b[D.indexOf(d[c])]).querySelector("[Target*='comments']");if(g){var f=d[c].name.replace("/_rels","");f=f.replace(".rels","");var a=I("worksheet").findIndex(function(m){return m.name===f}),e=g.getAttribute("Target").slice(3);e="xl/"+e;g=D.findIndex(function(m){return m.name===e});g=B(b[g]);var k=g.querySelector("commentList").children,l=Array.from(k).map(function(m){return m.children[0].children[0].querySelector("t").innerHTML}),
w=g.querySelector("authors").children;w=Array.from(w).map(function(m){return m.innerHTML});h.worksheets[a].allowComments=!0;h.worksheets[a].comments={};l.forEach(function(m,q){var y=k[q].getAttribute("ref");q=k[q].getAttribute("authorId");h.worksheets[a].comments[y]=w[q]+":\n"+m})}}},J=function(b,d){if(!d)return b;d=parseFloat(d);b=b.slice("#"===b[0]?1:0).slice(0,6);var c=[parseInt(b.slice(0,2),16),parseInt(b.slice(2,4),16),parseInt(b.slice(4,6),16)];b=c[0]/255;var g=c[1]/255;c=c[2]/255;var f=Math.max(b,
g,c),a=Math.min(b,g,c),e=f-a;if(0===e)b=[0,0,b];else{var k=0;a=f+a;switch(f){case b:k=((g-c)/e+6)%6;break;case g:k=(c-b)/e+2;break;case c:k=(b-g)/e+4}b=[k/6,e/(1<a?2-a:a),a/2]}b[2]=0>d?b[2]*(1+d):1-(1-b[2])*(1-d);g=b[1];d=b[2];c=2*g*(.5>d?d:1-d);d-=c/2;d=[d,d,d];b=6*b[0];if(0!==g)switch(b|0){case 0:case 6:d[0]+=c;d[1]+=c*b;break;case 1:d[0]+=c*(2-b);d[1]+=c;break;case 2:d[1]+=c;d[2]+=c*(b-2);break;case 3:d[1]+=c*(4-b);d[2]+=c;break;case 4:d[2]+=c;d[0]+=c*(b-4);break;case 5:d[2]+=c*(6-b),d[0]+=c}for(b=
0;3!=b;++b)d[b]=Math.round(255*d[b]);b=0;for(g=1;3!=b;++b)g=256*g+(255<d[b]?255:0>d[b]?0:d[b]);return g.toString(16).toUpperCase().slice(1)},W=0,X=function(b){null===n&&(n=this);u=r=null;v=[];z={color:[]};h={worksheets:[]};D=[];L=[];var d=N.label();if(d){W++;if(5<W)return alert(d),!1;console.log(d)}var c=new JSZip;b.url?jSuites.ajax({url:b.url,method:"GET",dataType:"blob",success:function(g){c.loadAsync(g).then(function(f){O(f,b)})}}):b.file&&c.loadAsync(b.file).then(function(g){O(g,b)}).catch(function(g){console.error(g);
jSuites.loading.hide()})};X.license=function(b){N(b)};return X});
